Rule,Profile Applicability,Description,Rationale,Audit,Remediation,Default Value,CIS Controls
,,,,,"Run the following script to unload and disable the cramfs module: 
- IF - the cramfs kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install cramfs /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist cramfs in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r cramfs 2>/dev/null; rmmod cramfs 2>/dev/null to 
remove cramfs from the kernel 
- IF - the cramfs kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the freevxfs module: 
- IF - the freevxfs kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install freevxfs /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist freevxfs in the 
/etc/modprobe.d/ directory 
• 
Run modprobe -r freevxfs 2>/dev/null; rmmod freevxfs 2>/dev/null 
to remove freevxfs from the kernel 
- IF - the freevxfs kernel module is not available on the system, or pre-compiled into 
the kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the hfs module: 
- IF - the hfs kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install hfs /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist hfs in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r hfs 2>/dev/null; rmmod hfs 2>/dev/null to remove 
hfs from the kernel 
- IF - the hfs kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the hfsplus module: 
- IF - the hfsplus kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install hfsplus /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist hfsplus in the 
/etc/modprobe.d/ directory 
• 
Run modprobe -r hfsplus 2>/dev/null; rmmod hfsplus 2>/dev/null to 
remove hfsplus from the kernel 
- IF - the hfsplus kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the jffs2 module: 
- IF - the jffs2 kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install jffs2 /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist jffs2 in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r jffs2 2>/dev/null; rmmod jffs2 2>/dev/null to 
remove jffs2 from the kernel 
- IF - the jffs2 kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the udf module: 
- IF - the squashfs kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install squashfs /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist squashfs in the 
/etc/modprobe.d/ directory 
• 
Run modprobe -r squashfs 2>/dev/null; rmmod squashfs 2>/dev/null 
to remove squashfs from the kernel 
- IF - the squashfs kernel module is not available on the system, or pre-compiled into 
the kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the udf module: 
- IF - the udf kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install udf /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist udf in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r udf 2>/dev/null; rmmod udf 2>/dev/null to remove 
udf from the kernel 
- IF - the udf kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the usb-storage module: 
- IF - the usb-storage kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install usb-storage /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist usb-storage in the 
/etc/modprobe.d/ directory 
• 
Run modprobe -r usb-storage 2>/dev/null; rmmod usb-storage 
2>/dev/null to remove usb-storage from the kernel 
- IF - the usb-storage kernel module is not available on the system, or pre-compiled 
into the kernel, no remediation is necessary",,
,,,,,"- IF - the module is available in the running kernel: 
• 
Unload the filesystem kernel module from the kernel 
• 
Create a file ending in .conf with install filesystem kernel modules /bin/false 
in the /etc/modprobe.d/ directory 
• 
Create a file ending in .conf with deny list filesystem kernel modules in the 
/etc/modprobe.d/ directory 
WARNING: unloading, disabling or denylisting filesystem modules that are in use on the 
system maybe FATAL. It is extremely important to thoroughly review the filesystems 
returned by the audit before following the remediation procedure. 
Example of unloading the gfs2kernel module: 
# modprobe -r gfs2 2>/dev/null 
# rmmod gfs2 2>/dev/null 
Example of fully disabling the gfs2 kernel module: 
# printf '%s\n' ""blacklist gfs2"" ""install gfs2 /bin/false"" >> 
/etc/modprobe.d/gfs2.conf 
Note: 
• 
Disabling a kernel module by modifying the command above for each unused 
filesystem kernel module 
• 
The example gfs2 must be updated with the appropriate module name for the 
command or example script below to run correctly. 
Below is an example Script that can be modified to use on various filesystem 
kernel modules manual remediation process: 
Example Script",,
,,,,"Run the following command and verify the output shows that /tmp is mounted. 
Particular requirements pertaining to mount options are covered in ensuing sections. 
# findmnt -kn /tmp 
Example output: 
/tmp   tmpfs  tmpfs  rw,nosuid,nodev,noexec 
Ensure that systemd will mount the /tmp partition at boot time. 
# systemctl is-enabled tmp.mount 
Example output: 
generated 
Verify output is not masked or disabled. 
Note: By default, systemd will output generated if there is an entry in /etc/fstab for 
/tmp. This just means systemd will use the entry in /etc/fstab instead of its default 
unit file configuration for /tmp.","First ensure that systemd is correctly configured to ensure that /tmp will be mounted at 
boot time. 
# systemctl unmask tmp.mount 
For specific configuration requirements of the /tmp mount for your environment, modify 
/etc/fstab. 
Example of using tmpfs with specific mount options: 
tmpfs 
/tmp 
tmpfs     defaults,rw,nosuid,nodev,noexec,relatime,size=2G  0 
0 
Note: the size=2G is an example of setting a specific size for tmpfs. 
Example of using a volume or disk with specific mount options. The source location of 
the volume or disk will vary depending on your environment: 
<device> /tmp    <fstype>    defaults,nodev,nosuid,noexec   0 0 
References: 
1. https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/ 
2. https://www.freedesktop.org/software/systemd/man/systemd-fstab-generator.html 
3. https://www.kernel.org/doc/Documentation/filesystems/tmpfs.txt 
4. NIST SP 800-53 Rev. 5: CM-7",,
1.1.2.1.2 Ensure nodev option set on /tmp partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /tmp filesystem is not intended to support devices, set this option to ensure 
that users cannot create a block or character special devices in /tmp.","- IF - a separate partition exists for /tmp, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /tmp | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /tmp. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/tmp partition. 
Example: 
<device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /tmp with the configured options: 
# mount -o remount /tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: CM-7",,
1.1.2.1.3 Ensure nosuid option set on /tmp partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /tmp filesystem is only intended for temporary file storage, set this option to 
ensure that users cannot create setuid files in /tmp.","- IF - a separate partition exists for /tmp, verify that the nosuid option is set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /tmp | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /tmp. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/tmp partition. 
Example: 
<device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /tmp with the configured options: 
# mount -o remount /tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.1.2.1.4 Ensure noexec option set on /tmp partition (Automated)," Level 1 - Server 
 Level 1 - Workstation","The noexec mount option specifies that the filesystem cannot contain executable 
binaries.","Since the /tmp filesystem is only intended for temporary file storage, set this option to 
ensure that users cannot run executable binaries from /tmp. 
Impact: 
Setting the noexec option on /tmp may prevent installation and/or updating of some 3rd 
party software.","- IF - a separate partition exists for /tmp, verify that the noexec option is set. 
Run the following command to verify that the noexec mount option is set. 
Example: 
# findmnt -kn /tmp | grep -v noexec 
 
Nothing should be returned","- IF - a separate partition exists for /tmp. 
Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the 
/tmp partition. 
Example: 
<device> /tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /tmp with the configured options: 
# mount -o remount /tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,,"For specific configuration requirements of the /dev/shm mount for your environment, 
modify /etc/fstab. 
Example: 
tmpfs 
/dev/shm 
tmpfs     
defaults,rw,nosuid,nodev,noexec,relatime,size=2G  0 0 
References: 
1. https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/ 
2. https://www.freedesktop.org/software/systemd/man/systemd-fstab-generator.html 
3. NIST SP 800-53 Rev. 5: CM-7 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1499, T1499.001 
TA0005 
M1022",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1499 T1499.001 
TA0005 
M1022"
"1.1.2.2.2 Ensure nodev option set on /dev/shm partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /dev/shm filesystem is not intended to support devices, set this option to 
ensure that users cannot attempt to create special devices in /dev/shm partitions.","- IF - a separate partition exists for /dev/shm, verify that the nodev option is set. 
# findmnt -kn /dev/shm | grep -v 'nodev' 
 
Nothing should be returned","- IF - a separate partition exists for /dev/shm. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/dev/shm partition. See the fstab(5) manual page for more information. 
Example: 
tmpfs /dev/shm    tmpfs     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /dev/shm with the configured options: 
# mount -o remount /dev/shm 
Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is 
used as shared memory space by applications. 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.2.3 Ensure nosuid option set on /dev/shm partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Setting this option on a file system prevents users from introducing privileged programs 
onto the system and allowing non-root users to execute them.","- IF - a separate partition exists for /dev/shm, verify that the nosuid option is set. 
# findmnt -kn /dev/shm | grep -v 'nosuid' 
 
Nothing should be returned","- IF - a separate partition exists for /dev/shm. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/dev/shm partition. See the fstab(5) manual page for more information. 
Example: 
tmpfs /dev/shm    tmpfs     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /dev/shm with the configured options: 
# mount -o remount /dev/shm 
Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is 
used as shared memory space by applications. 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2 
Additional Information: 
Some distributions mount /dev/shm through other means and require /dev/shm to be 
added to /etc/fstab even though it is already being mounted on boot. Others may 
configure /dev/shm in other locations and may override /etc/fstab configuration. 
Consult the documentation appropriate for your distribution.",,
"1.1.2.2.4 Ensure noexec option set on /dev/shm partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The noexec mount option specifies that the filesystem cannot contain executable 
binaries.","Setting this option on a file system prevents users from executing programs from shared 
memory. This deters users from introducing potentially malicious software on the 
system.","- IF - a separate partition exists for /dev/shm, verify that the noexec option is set. 
# findmnt -kn /dev/shm | grep -v 'noexec' 
 
Nothing should be returned","- IF - a separate partition exists for /dev/shm. 
Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the 
/dev/shm partition. 
Example: 
tmpfs /dev/shm    tmpfs     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /dev/shm with the configured options: 
# mount -o remount /dev/shm 
Note: It is recommended to use tmpfs as the device/filesystem type as /dev/shm is 
used as shared memory space by applications. 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,"Run the following command and verify output shows /home is mounted: 
# findmnt -kn /home 
 
/home   /dev/sdb  ext4  rw,nosuid,nodev,noexec,relatime,seclabel","For new installations, during installation create a custom partition setup and specify a 
separate partition for /home. 
For systems that were previously installed, create a new partition and configure 
/etc/fstab as appropriate. 
References: 
1. AJ Lewis, ""LVM HOWTO"", http://tldp.org/HOWTO/LVM-HOWTO/ 
2. NIST SP 800-53 Rev. 5: CM-7 
Additional Information: 
When modifying /home it is advisable to bring the system to emergency mode (so auditd 
is not running), rename the existing directory, mount the new file system, and migrate 
the data over before returning to multi-user mode. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
1.1.2.3.2 Ensure nodev option set on /home partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /home filesystem is not intended to support devices, set this option to ensure 
that users cannot create a block or character special devices in /home.","- IF - a separate partition exists for /home, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /home | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /home. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/home partition. 
Example: 
<device> /home    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /home with the configured options: 
# mount -o remount /home 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.1.2.3.3 Ensure nosuid option set on /home partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /home filesystem is only intended for user file storage, set this option to 
ensure that users cannot create setuid files in /home.","- IF - a separate partition exists for /home, verify that the nosuid option is set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /home | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /home. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/home partition. 
Example: 
<device> /home    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /home with the configured options: 
# mount -o remount /home 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,"Run the following command and verify output shows /var is mounted. 
Example: 
# findmnt -kn /var 
 
/var  /dev/sdb  ext4   rw,nosuid,nodev,noexec,relatime,seclabel","For new installations, during installation create a custom partition setup and specify a 
separate partition for /var. 
For systems that were previously installed, create a new partition and configure 
/etc/fstab as appropriate. 
References: 
1. AJ Lewis, ""LVM HOWTO"", http://tldp.org/HOWTO/LVM-HOWTO/ 
2. NIST SP 800-53 Rev. 5: CM-7 
Additional Information: 
When modifying /var it is advisable to bring the system to emergency mode (so auditd 
is not running), rename the existing directory, mount the new file system, and migrate 
the data over before returning to multi-user mode. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
1.1.2.4.2 Ensure nodev option set on /var partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /var filesystem is not intended to support devices, set this option to ensure 
that users cannot create a block or character special devices in /var.","- IF - a separate partition exists for /var, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /var | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /var. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/var partition. 
Example: 
<device> /var    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /var with the configured options: 
# mount -o remount /var 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.1.2.4.3 Ensure nosuid option set on /var partition (Automated)," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /var filesystem is only intended for variable files such as logs, set this option 
to ensure that users cannot create setuid files in /var.","- IF - a separate partition exists for /var, verify that the nosuid option is set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /var | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /var. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/var partition. 
Example: 
<device> /var    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /var with the configured options: 
# mount -o remount /var 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.5.1 Ensure separate partition exists for /var/tmp 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation","The /var/tmp directory is a world-writable directory used for temporary storage by all 
users and some applications. Temporary files residing in /var/tmp are to be preserved 
between reboots.","The default installation only creates a single / partition. Since the /var/tmp directory is 
world-writable, there is a risk of resource exhaustion. In addition, other operations on 
the system could fill up the disk unrelated to /var/tmp and cause potential disruption to 
daemons as the disk is full. 
Configuring /var/tmp as its own file system allows an administrator to set additional 
mount options such as noexec/nosuid/nodev. These options limit an attacker's ability 
to create exploits on the system. 
Impact: 
Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem 
partitions may prevent successful resizing or may require the installation of additional 
tools solely for the purpose of resizing operations. The use of these additional tools may 
introduce their own security considerations.","Run the following command and verify output shows /var/tmp is mounted. 
Example: 
# findmnt -kn /var/tmp 
 
/var/tmp   /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel","For new installations, during installation create a custom partition setup and specify a 
separate partition for /var/tmp. 
For systems that were previously installed, create a new partition and configure 
/etc/fstab as appropriate.",,
"1.1.2.5.2 Ensure nodev option set on /var/tmp partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /var/tmp filesystem is not intended to support devices, set this option to 
ensure that users cannot create a block or character special devices in /var/tmp.","- IF - a separate partition exists for /var/tmp, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /var/tmp | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /var/tmp. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/var/tmp partition. 
Example: 
<device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/tmp with the configured options: 
# mount -o remount /var/tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.5.3 Ensure nosuid option set on /var/tmp partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /var/tmp filesystem is only intended for temporary file storage, set this option 
to ensure that users cannot create setuid files in /var/tmp.","- IF - a separate partition exists for /var/tmp, verify that the nosuid option is set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /var/tmp | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /var/tmp. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/var/tmp partition. 
Example: 
<device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/tmp with the configured options: 
# mount -o remount /var/tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.5.4 Ensure noexec option set on /var/tmp partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The noexec mount option specifies that the filesystem cannot contain executable 
binaries.","Since the /var/tmp filesystem is only intended for temporary file storage, set this option 
to ensure that users cannot run executable binaries from /var/tmp.","- IF - a separate partition exists for /var/tmp, verify that the noexec option is set. 
Run the following command to verify that the noexec mount option is set. 
Example: 
# findmnt -kn /var/tmp | grep -v noexec 
 
Nothing should be returned","- IF - a separate partition exists for /var/tmp. 
Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the 
/var/tmp partition. 
Example: 
<device> /var/tmp    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/tmp with the configured options: 
# mount -o remount /var/tmp 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.1.2.6.1 Ensure separate partition exists for /var/log (Automated)," Level 2 - Server 
 Level 2 - Workstation",The /var/log directory is used by system services to store log data.,"The default installation only creates a single / partition. Since the /var/log directory 
contains log files which can grow quite large, there is a risk of resource exhaustion. It 
will essentially have the whole disk available to fill up and impact the system as a whole. 
Configuring /var/log as its own file system allows an administrator to set additional 
mount options such as noexec/nosuid/nodev. These options limit an attackers ability 
to create exploits on the system. Other options allow for specific behavior. See man 
mount for exact details regarding filesystem-independent and filesystem-specific 
options. 
As /var/log contains log files, care should be taken to ensure the security and integrity 
of the data and mount point. 
Impact: 
Resizing filesystems is a common activity in cloud-hosted servers. Separate filesystem 
partitions may prevent successful resizing, or may require the installation of additional 
tools solely for the purpose of resizing operations. The use of these additional tools may 
introduce their own security considerations.","Run the following command and verify output shows /var/log is mounted: 
# findmnt -kn /var/log 
 
/var/log /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel","For new installations, during installation create a custom partition setup and specify a 
separate partition for /var/log . 
For systems that were previously installed, create a new partition and configure 
/etc/fstab as appropriate.",,
"1.1.2.6.2 Ensure nodev option set on /var/log partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /var/log filesystem is not intended to support devices, set this option to 
ensure that users cannot create a block or character special devices in /var/log.","- IF - a separate partition exists for /var/log, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /var/log | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /var/log. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/var/log partition. 
Example: 
<device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/log with the configured options: 
# mount -o remount /var/log 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.6.3 Ensure nosuid option set on /var/log partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /var/log filesystem is only intended for log files, set this option to ensure 
that users cannot create setuid files in /var/log.","- IF - a separate partition exists for /var/log, verify that the nosuid option is set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /var/log | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /var/log. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/var/log partition. 
Example: 
<device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/log with the configured options: 
# mount -o remount /var/log 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.6.4 Ensure noexec option set on /var/log partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The noexec mount option specifies that the filesystem cannot contain executable 
binaries.","Since the /var/log filesystem is only intended for log files, set this option to ensure 
that users cannot run executable binaries from /var/log.","- IF - a separate partition exists for /var/log, verify that the noexec option is set. 
Run the following command to verify that the noexec mount option is set. 
Example: 
# findmnt -kn /var/log | grep -v noexec 
 
Nothing should be returned","- IF - a separate partition exists for /var/log. 
Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the 
/var/log partition. 
Example: 
<device> /var/log    <fstype>     defaults,rw,nosuid,nodev,noexec,relatime  0 
0 
Run the following command to remount /var/log with the configured options: 
# mount -o remount /var/log 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,"Run the following command and verify output shows /var/log/audit is mounted: 
# findmnt -kn /var/log/audit 
 
/var/log/audit /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel","For new installations, during installation create a custom partition setup and specify a 
separate partition for /var/log/audit. 
For systems that were previously installed, create a new partition and configure 
/etc/fstab as appropriate. 
References: 
1. AJ Lewis, ""LVM HOWTO"", http://tldp.org/HOWTO/LVM-HOWTO/ 
2. NIST SP 800-53 Rev. 5: CM-7 
Additional Information: 
When modifying /var/log/audit it is advisable to bring the system to emergency 
mode (so auditd is not running), rename the existing directory, mount the new file 
system, and migrate the data over before returning to multi-user mode. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.3 Ensure Adequate Audit Log Storage 
 
Ensure that logging destinations maintain adequate storage to comply with 
the enterprise’s audit log management process. 
● 
● 
● 
v7 
6.4 Ensure adequate storage for logs 
 
Ensure that all systems that store logs have adequate storage space for the 
logs generated. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1499, T1499.001 
TA0005 
M1022",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.3 Ensure Adequate Audit Log Storage 
 
Ensure that logging destinations maintain adequate storage to comply with 
the enterprise s audit log management process. 
 
 
 
v7 
6.4 Ensure adequate storage for logs 
 
Ensure that all systems that store logs have adequate storage space for the 
logs generated. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1499 T1499.001 
TA0005 
M1022"
"1.1.2.7.2 Ensure nodev option set on /var/log/audit partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nodev mount option specifies that the filesystem cannot contain special devices.,"Since the /var/log/audit filesystem is not intended to support devices, set this option 
to ensure that users cannot create a block or character special devices in 
/var/log/audit.","- IF - a separate partition exists for /var/log/audit, verify that the nodev option is set. 
Run the following command to verify that the nodev mount option is set. 
Example: 
# findmnt -kn /var/log/audit | grep -v nodev 
 
Nothing should be returned","- IF - a separate partition exists for /var/log/audit. 
Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the 
/var/log/audit partition. 
Example: 
<device> /var/log/audit    <fstype>     
defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /var/log/audit with the configured options: 
# mount -o remount /var/log/audit 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.7.3 Ensure nosuid option set on /var/log/audit partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The nosuid mount option specifies that the filesystem cannot contain setuid files.,"Since the /var/log/audit filesystem is only intended for variable files such as logs, 
set this option to ensure that users cannot create setuid files in /var/log/audit.","- IF - a separate partition exists for /var/log/audit, verify that the nosuid option is 
set. 
Run the following command to verify that the nosuid mount option is set. 
Example: 
# findmnt -kn /var/log/audit | grep -v nosuid 
 
Nothing should be returned","- IF - a separate partition exists for /var/log/audit. 
Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the 
/var/log/audit partition. 
Example: 
<device> /var/log/audit    <fstype>     
defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /var/log/audit with the configured options: 
# mount -o remount /var/log/audit 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
"1.1.2.7.4 Ensure noexec option set on /var/log/audit partition 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The noexec mount option specifies that the filesystem cannot contain executable 
binaries.","Since the /var/log/audit filesystem is only intended for audit logs, set this option to 
ensure that users cannot run executable binaries from /var/log/audit.","- IF - a separate partition exists for /var/log/audit, verify that the noexec option is 
set. 
Run the following command to verify that the noexec mount option is set. 
Example: 
# findmnt -kn /var/log/audit | grep -v noexec 
 
Nothing should be returned","- IF - a separate partition exists for /var/log/audit. 
Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the 
/var/log/audit partition. 
Example: 
<device> /var/log/audit    <fstype>     
defaults,rw,nosuid,nodev,noexec,relatime  0 0 
Run the following command to remount /var/log/audit with the configured options: 
# mount -o remount /var/log/audit 
References: 
1. See the fstab(5) manual page for more information. 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,,Update your package manager GPG keys in accordance with site policy.,,
,,,,,"Edit /etc/dnf/dnf.conf and set gpgcheck=1: 
Example 
# sed -i 's/^gpgcheck\s*=\s*.*/gpgcheck=1/' /etc/dnf/dnf.conf 
Edit any failing files in /etc/yum.repos.d/* and set all instances starting with 
gpgcheck to 1. 
Example: 
# find /etc/yum.repos.d/ -name ""*.repo"" -exec echo ""Checking:"" {} \; -exec 
sed -i 's/^gpgcheck\s*=\s*.*/gpgcheck=1/' {} \; 
References: 
1. NIST SP 800-53 Rev. 5: SI-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
7.3 Perform Automated Operating System Patch 
Management 
 
Perform operating system updates on enterprise assets through automated 
patch management on a monthly, or more frequent, basis. 
● 
● 
● 
v7 
3.4 Deploy Automated Operating System Patch 
Management Tools 
 
Deploy automated software update tools in order to ensure that the operating 
systems are running the most recent security updates provided by the software 
vendor. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1195, T1195.001 
TA0005",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
7.3 Perform Automated Operating System Patch 
Management 
 
Perform operating system updates on enterprise assets through automated 
patch management on a monthly or more frequent basis. 
 
 
 
v7 
3.4 Deploy Automated Operating System Patch 
Management Tools 
 
Deploy automated software update tools in order to ensure that the operating 
systems are running the most recent security updates provided by the software 
vendor. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1195 T1195.001 
TA0005"
,,,,,"Global configuration 
Edit /etc/dnf/dnf.conf and set repo_gpgcheck=1 in the [main] section. 
Example: 
[main] 
repo_gpgcheck=1 
Per repository configuration 
First check that the particular repository support GPG checking on the repodata. 
Edit any failing files in /etc/yum.repos.d/* and set all instances starting with 
repo_gpgcheck to 1. 
References: 
1. NIST SP 800-53 Rev. 5: SI-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
7.3 Perform Automated Operating System Patch 
Management 
 
Perform operating system updates on enterprise assets through automated 
patch management on a monthly, or more frequent, basis. 
● 
● 
● 
v7 
3.4 Deploy Automated Operating System Patch 
Management Tools 
 
Deploy automated software update tools in order to ensure that the operating 
systems are running the most recent security updates provided by the software 
vendor. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1195, T1195.001 
TA0005",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
7.3 Perform Automated Operating System Patch 
Management 
 
Perform operating system updates on enterprise assets through automated 
patch management on a monthly or more frequent basis. 
 
 
 
v7 
3.4 Deploy Automated Operating System Patch 
Management Tools 
 
Deploy automated software update tools in order to ensure that the operating 
systems are running the most recent security updates provided by the software 
vendor. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1195 T1195.001 
TA0005"
"1.2.1.4 Ensure package manager repositories are configured 
(Manual)"," Level 1 - Server 
 Level 1 - Workstation","Systems need to have the respective package manager repositories configured to 
ensure that the system is able to receive the latest patches and updates.","If a system's package repositories are misconfigured, important patches may not be 
identified or a rogue repository could introduce compromised software.","Run the following command to verify repositories are configured correctly. The output 
may vary depending on which repositories are currently configured on the system. 
Example: 
# dnf repolist 
Last metadata expiration check: 1:00:00 ago on Mon 1 Jan 2021 00:00:00 BST. 
repo id        repo name                        status 
*fedora        Fedora 28 - x86_64               57,327 
*updates       Fedora 28 - x86_64 - Updates     22,133 
For the repositories in use, inspect the configuration file to ensure all settings are 
correctly applied according to site policy. 
Example: 
Depending on the distribution being used the repo file name might differ. 
cat /etc/yum.repos.d/*.repo","Configure your package manager repositories according to site policy. 
References: 
1. NIST SP 800-53 Rev. 5: SI-2 
Additional Information: 
For further information about Fedora repositories see: https://docs.fedoraproject.org/en-
US/quick-docs/repositories/",,
"1.2.2.1 Ensure updates, patches, and additional security software 
are installed (Manual)"," Level 1 - Server 
 Level 1 - Workstation","Periodically patches are released for included software either due to security flaws or to 
include additional functionality.","Newer patches may contain security enhancements that would not be available through 
the latest full update. As a result, it is recommended that the latest software patches be 
used to take advantage of the latest functionality. As with any software installation, 
organizations need to determine if a given update meets their requirements and verify 
the compatibility and supportability of any additional software against the update 
revision that is selected.","Run the following command and verify there are no updates or patches to install: 
# dnf check-update 
Check to make sure no system reboot is required 
dnf needs-restarting -r","Use your package manager to update all packages on the system according to site 
policy. 
The following command will install all available updates: 
# dnf update 
Once the update process is complete, verify if reboot is required to load changes. 
dnf needs-restarting -r 
References: 
1. NIST SP 800-53 Rev. 5: SI-2",,
1.3.1.1 Ensure SELinux is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation",SELinux provides Mandatory Access Control.,"Without a Mandatory Access Control system installed only the default Discretionary 
Access Control system will be available.","Verify SELinux is installed. 
Run the following command: 
# rpm -q libselinux 
 
libselinux-<version>","Run the following command to install SELinux: 
# dnf install libselinux 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"Run the following command to remove the selinux=0 and enforcing=0 parameters: 
grubby --update-kernel ALL --remove-args ""selinux=0 enforcing=0"" 
Run the following command to remove the selinux=0 and enforcing=0 parameters if 
they were created by the deprecated grub2-mkconfig command: 
# grep -Prsq -- 
'\h*([^#\n\r]+\h+)?kernelopts=([^#\n\r]+\h+)?(selinux|enforcing)=0\b' 
/boot/grub2 /boot/efi && grub2-mkconfig -o ""$(grep -Prl -- 
'\h*([^#\n\r]+\h+)?kernelopts=([^#\n\r]+\h+)?(selinux|enforcing)=0\b' 
/boot/grub2 /boot/efi)"" 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2 
Additional Information: 
This recommendation is designed around the grub 2 bootloader, if another bootloader is 
in use in your environment enact equivalent settings. 
grubby is a command line tool for updating and displaying information about the 
configuration files for the grub2 and zipl boot loaders. It is primarily designed to be used 
from scripts which install new kernels and need to find information about the current 
boot environment. 
• 
All bootloaders define the boot entries as individual configuration fragments that 
are stored by default in /boot/loader/entries. The format for the config files is 
specified at https://systemd.io/BOOT_LOADER_SPECIFICATION. The grubby 
tool is used to update and display the configuration defined in the 
BootLoaderSpec fragment files. 
• 
There are a number of ways to specify the kernel used for --info, --remove-
kernel, and --update-kernel. Specifying DEFAULT or ALL selects the de‐fault 
entry and all of the entries, respectively. Also, the title of a boot entry may be 
specified by using TITLE=title as the argument; all entries with that title are used.",,
1.3.1.3 Ensure SELinux policy is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","Configure SELinux to meet or exceed the default targeted policy, which constrains 
daemons and system software only.","Security configuration requirements vary from site to site. Some sites may mandate a 
policy that is stricter than the default policy, which is perfectly acceptable. This item is 
intended to ensure that at least the default recommendations are met.","Run the following commands and ensure output matches either "" targeted "" or "" mls "": 
# grep -E '^\s*SELINUXTYPE=(targeted|mls)\b' /etc/selinux/config 
 
SELINUXTYPE=targeted 
# sestatus | grep Loaded 
 
Loaded policy name:             targeted","Edit the /etc/selinux/config file to set the SELINUXTYPE parameter: 
SELINUXTYPE=targeted 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2 
Additional Information: 
If your organization requires stricter policies, ensure that they are set in the 
/etc/selinux/config file.",,
,,,,"Run the following command to verify SELinux's current mode: 
# getenforce 
 
Enforcing 
-OR- 
Permissive 
Run the following command to verify SELinux's configured mode: 
# grep -Ei '^\s*SELINUX=(enforcing|permissive)' /etc/selinux/config 
 
SELINUX=enforcing 
-OR- 
SELINUX=permissive","Run one of the following commands to set SELinux's running mode: 
To set SELinux mode to Enforcing: 
# setenforce 1 
- OR - 
To set SELinux mode to Permissive: 
# setenforce 0 
Edit the /etc/selinux/config file to set the SELINUX parameter: 
For Enforcing mode: 
SELINUX=enforcing 
- OR - 
For Permissive mode: 
SELINUX=permissive 
References: 
1. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/sect
-security-enhanced_linux-introduction-selinux_modes 
2. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,"Run the following command to verify SELinux's current mode: 
# getenforce 
 
Enforcing 
Run the following command to verify SELinux's configured mode: 
# grep -i SELINUX=enforcing /etc/selinux/config 
 
SELINUX=enforcing","Run the following command to set SELinux's running mode: 
# setenforce 1 
Edit the /etc/selinux/config file to set the SELINUX parameter: 
For Enforcing mode: 
SELINUX=enforcing 
References: 
1. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/7/html/selinux_users_and_administrators_guide/sect
-security-enhanced_linux-introduction-selinux_modes 
2. CCI-002165: The information system enforces organization-defined discretionary 
access control policies over defined subjects and objects. 
3. NIST SP 800-53 Revision 4 :: AC-3 (4) 
4. CCI-002696: The information system verifies correct operation of organization-
defined security functions. 
5. NIST SP 800-53 Revision 4 :: SI-6 a 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"Investigate any unconfined processes found during the audit action. If necessary create 
a customize SELinux policy to allow necessary actions for the service. 
Warning: Knowledge about creating and configuring SELinux policies is needed. A 
Basic example on how to create a policy is included below. 
1. Identify the unconfined service: determine the name and process of the service 
2. Identify the functionality: determine if the functionality is required for operations 
3. Create or add to the custom allow list in the SELinux policy configuration 
Example SELinux policy configuration: service_allowlist_policy.te 
# Example SELinux policy configuration for allowing access to specific 
actions and resources for a service 
 
module my_service 1.0; 
 
require { 
    type my_service_t; 
    type system_resource_t; 
    class file { read write execute }; 
    class dir { read write add_name }; 
    class tcp_socket name_connect; 
} 
 
allow my_service_t system_resource_t:file { read write execute }; # Allow 
my_service_t to read, write, and execute files with the system_resource_t 
context 
 
allow my_service_t system_resource_t:dir { read write add_name }; # Allow 
my_service_t to read and write to directories with the system_resource_t 
context 
 
allow my_service_t system_resource_t:tcp_socket name_connect; # Allow 
my_service_t to establish TCP connections 
4. Compile the policy 
# checkmodule -M -, -o service_allowlist_policy.mod 
service_allowlist_policy.te 
5. Create the package 
# semodule_package -o service_allowlist_policy.pp -m 
service_allowlist_policy.mod 
6. Load the policy 
# semodule -i service_allowlist_policy.pp 
7. Apply the policy to the service 
# chcon -t se service_allowlist_policy /path/to/service_binary",,
"1.3.1.7 Ensure the MCS Translation Service (mcstrans) is not 
installed (Automated)"," Level 1 - Server 
 Level 1 - Workstation","The mcstransd daemon provides category label information to client processes 
requesting information. The label translations are defined in 
/etc/selinux/targeted/setrans.conf","Since this service is not used very often, remove it to reduce the amount of potentially 
vulnerable code running on the system.","Run the following command and verify mcstrans is not installed. 
# rpm -q mcstrans 
 
package mcstrans is not installed","Run the following command to uninstall mcstrans: 
# dnf remove mcstrans 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.3.1.8 Ensure SETroubleshoot is not installed (Automated), Level 1 - Server,"The SETroubleshoot service notifies desktop users of SELinux denials through a user-
friendly interface. The service provides important information around configuration 
errors, unauthorized intrusions, and other potential errors.","The SETroubleshoot service is an unnecessary daemon to have running on a server, 
especially if X Windows is disabled.","Verify setroubleshoot is not installed. 
Run the following command: 
# rpm -q setroubleshoot 
 
package setroubleshoot is not installed","Run the following command to uninstall setroubleshoot: 
# dnf remove setroubleshoot 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
,,,,,"Create an encrypted password with grub2-setpassword: 
# grub2-setpassword 
 
Enter password: <password> 
Confirm password: <password> 
References: 
1. NIST SP 800-53 Rev. 5: AC-3 
Additional Information: 
This recommendation is designed around the grub2 bootloader, if LILO or another 
bootloader is in use in your environment enact equivalent settings. 
grub2-setpassword outputs the user.cfg file which contains the hashed GRUB 
bootloader password. This utility only supports configurations where there is a single 
root user. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1542, T1542.000 
TA0003 
M1046",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1542 T1542.000 
TA0003 
M1046"
,,,,,"Run the following to update the mode, ownership, and group ownership of the grub 
configuration files: 
- IF - the system uses UEFI (Files located in /boot/efi/EFI/*) 
Edit /etc/fstab and add the fmask=0077, uid=0, and gid=0 options: 
Example: 
<device> /boot/efi vfat defaults,umask=0027,fmask=0077,uid=0,gid=0 0 0 
Note: This may require a re-boot to enable the change 
- OR - 
- IF - the system uses BIOS (Files located in /boot/grub2/*) 
Run the following commands to set ownership and permissions on your grub 
configuration file(s): 
# [ -f /boot/grub2/grub.cfg ] && chown root:root /boot/grub2/grub.cfg 
# [ -f /boot/grub2/grub.cfg ] && chmod u-x,go-rwx /boot/grub2/grub.cfg 
 
# [ -f /boot/grub2/grubenv ] && chown root:root /boot/grub2/grubenv 
# [ -f /boot/grub2/grubenv ] && chmod u-x,go-rwx /boot/grub2/grubenv 
 
# [ -f /boot/grub2/user.cfg ] && chown root:root /boot/grub2/user.cfg 
# [ -f /boot/grub2/user.cfg ] && chmod u-x,go-rwx /boot/grub2/user.cfg 
References: 
1. NIST SP 800-53 Rev. 5: AC-3 
Additional Information: 
This recommendation is designed around the grub bootloader, if LILO or another 
bootloader is in use in your environment enact equivalent settings. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
kernel.randomize_va_space = 2 
Example: 
# printf "" 
kernel.randomize_va_space = 2 
"" >> /etc/sysctl.d/60-kernel_sysctl.conf 
Run the following command to set the active kernel parameter: 
# sysctl -w kernel.randomize_va_space=2 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","kernel.randomize_va_space = 2 
References: 
1. CCI-000366: The organization implements the security configuration settings 
2. NIST SP 800-53 Rev. 5: CM-6 
3. NIST SP 800-53A :: CM-6.1 (iv)","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
10.5 Enable Anti-Exploitation Features 
 
Enable anti-exploitation features on enterprise assets and software where 
possible such as Microsoft Data Execution Prevention DEP Windows 
Defender Exploit Guard WDEG or Apple System Integrity Protection SIP and 
Gatekeeper . 
 
 
 
v7 
8.3 Enable Operating System Anti-Exploitation Features 
Deploy Anti-Exploit Technologies 
 
Enable anti-exploitation features such as Data Execution Prevention DEP or 
Address Space Layout Randomization ASLR that are available in an operating 
system or deploy appropriate toolkits that can be configured to apply protection to a 
broader set of applications and executables. 
 
 
 "
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
kernel.yama.ptrace_scope = 1 
Example: 
# printf "" 
kernel.yama.ptrace_scope = 1 
"" >> /etc/sysctl.d/60-kernel_sysctl.conf 
Run the following command to set the active kernel parameter: 
# sysctl -w kernel.yama.ptrace_scope=1 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten 
References: 
1. https://www.kernel.org/doc/Documentation/security/Yama.txt 
2. https://github.com/raj3shp/termspy 
Additional Information: 
Ptrace is very rarely used by regular applications and is mostly used by debuggers such 
as gdb and strace. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 "
,,,,,"Create or edit the file /etc/systemd/coredump.conf, or a file in the 
/etc/systemd/coredump.conf.d directory ending in .conf. 
Edit or add the following line in the [Coredump] section: 
ProcessSizeMax=0 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/coredump.conf.d/ ] && mkdir 
/etc/systemd/coredump.conf.d/ 
   if grep -Psq -- '^\h*\[Coredump\]' /etc/systemd/coredump.conf.d/60-
coredump.conf; then 
      printf '%s\n' ""ProcessSizeMax=0"" >> /etc/systemd/coredump.conf.d/60-
coredump.conf 
   else 
      printf '%s\n' ""[Coredump]"" ""ProcessSizeMax=0"" >> 
/etc/systemd/coredump.conf.d/60-coredump.conf 
   fi 
}","ProcessSizeMax=2G 
References: 
1. https://www.freedesktop.org/software/systemd/man/coredump.conf.html 
2. NIST SP 800-53 Rev. 5: CM-6b 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1005, T1005.000 
TA0007 
M1057",
,,,,,"Create or edit the file /etc/systemd/coredump.conf, or a file in the 
/etc/systemd/coredump.conf.d directory ending in .conf. 
Edit or add the following line in the [Coredump] section: 
Storage=none 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/coredump.conf.d/ ] && mkdir 
/etc/systemd/coredump.conf.d/ 
   if grep -Psq -- '^\h*\[Coredump\]' /etc/systemd/coredump.conf.d/60-
coredump.conf; then 
      printf '%s\n' ""Storage=none"" >> /etc/systemd/coredump.conf.d/60-
coredump.conf 
   else 
      printf '%s\n' ""[Coredump]"" ""Storage=none"" >> 
/etc/systemd/coredump.conf.d/60-coredump.conf 
   fi 
} 
References: 
1. https://www.freedesktop.org/software/systemd/man/coredump.conf.html 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1005, T1005.000 
TA0007 
M1057",,
,,,,,"Run the following command to change the system-wide crypto policy 
# update-crypto-policies --set <CRYPTO POLICY> 
Example: 
# update-crypto-policies --set DEFAULT 
Run the following to make the updated system-wide crypto policy active 
# update-crypto-policies","DEFAULT 
References: 
1. CRYPTO-POLICIES(7) 
2. https://access.redhat.com/articles/3642912#what-polices-are-provided-1 
3. fips-mode-setup(8) 
4. NIST SP 800-53 Rev. 5: SC-8",
"1.6.2 Ensure system wide crypto policy is not set in sshd 
configuration (Automated)"," Level 1 - Server 
 Level 1 - Workstation",System-wide Crypto policy can be over-ridden or opted out of for openSSH,"Over-riding or opting out of the system-wide crypto policy could allow for the use of less 
secure Ciphers, MACs, KexAlgorithms and GSSAPIKexAlgorithm 
Note: If changes to the system-wide crypto policy are required to meet local site policy 
for the openSSH server, these changes should be done with a sub-policy assigned to 
the system-wide crypto policy. For additional information see the CRYPTO-
POLICIES(7) man page","Run the following command: 
# grep -Pi '^\h*CRYPTO_POLICY\h*=' /etc/sysconfig/sshd 
No output should be returned","Run the following commands: 
# sed -ri ""s/^\s*(CRYPTO_POLICY\s*=.*)$/# \1/"" /etc/sysconfig/sshd 
 
# systemctl reload sshd 
References: 
1. NIST SP 800-53 Rev. 5: SC-8, IA-5, AC-17",,
,,,,,"Note: 
• 
The commands below are written for the included DEFAULT system-wide crypto 
policy. If another policy is in use and follows local site policy, replace DEFAULT 
with the name of your system-wide crypto policy. 
• 
Multiple subpolicies may be assigned to a policy as a colon separated list. e.g. 
DEFAULT:NO-SHA1:NO-SSHCBC 
• 
Subpolicies: 
o Not included in the update-crypto-policies --set command will not 
be applied to the system wide crypto policy. 
o  
must exist before they can be applied to the system wide crypto policy. 
o  
.pmod file filenames must be in all upper case, upper case, e.g. NO-
SHA1.pmod, or they will not be read by the update-crypto-policies --
set command. 
Create or edit a file in /etc/crypto-policies/policies/modules/ ending in .pmod 
and add or modify the following lines: 
hash = -SHA1 
sign = -*-SHA1 
sha1_in_certs = 0 
Example: 
# printf '%s\n' ""# This is a subpolicy dropping the SHA1 hash and signature 
support"" ""hash = -SHA1"" ""sign = -*-SHA1"" ""sha1_in_certs = 0"" >> /etc/crypto-
policies/policies/modules/NO-SHA1.pmod 
Run the following command to update the system-wide cryptographic policy 
# update-crypto-policies --set 
<CRYPTO_POLICY>:<CRYPTO_SUBPOLICY1>:<CRYPTO_SUBPOLICY2>:<CRYPTO_SUBPOLICY3> 
Example: 
update-crypto-policies --set DEFAULT:NO-SHA1 
Run the following command to reboot the system to make your cryptographic settings 
effective for already running services and applications: 
# reboot",,
,,,,,"Note: 
• 
The commands below are written for the included DEFAULT system-wide crypto 
policy. If another policy is in use and follows local site policy, replace DEFAULT 
with the name of your system-wide crypto policy. 
• 
Multiple subpolicies may be assigned to a policy as a colon separated list. e.g. 
DEFAULT:NO-SHA1:NO-SSHCBC 
• 
Subpolicies: 
o Not included in the update-crypto-policies --set command will not 
be applied to the system wide crypto policy. 
o must exist before they can be applied to the system wide crypto policy. 
o .pmod file filenames must be in all upper case, upper case, e.g. NO-
WEAKMAC.pmod, or they will not be read by the update-crypto-policies 
--set command. 
Create or edit a file in /etc/crypto-policies/policies/modules/ ending in .pmod 
and add or modify one of the following lines: 
mac = -*-64* # Disables weak macs 
Example: 
# printf '%s\n' ""# This is a subpolicy to disable weak macs"" ""mac = -*-64"" >> 
/etc/crypto-policies/policies/modules/NO-WEAKMAC.pmod 
Run the following command to update the system-wide cryptographic policy 
# update-crypto-policies --set 
<CRYPTO_POLICY>:<CRYPTO_SUBPOLICY1>:<CRYPTO_SUBPOLICY2>:<CRYPTO_SUBPOLICY3> 
Example: 
update-crypto-policies --set DEFAULT:NO-SHA1:NO-WEAKMAC 
Run the following command to reboot the system to make your cryptographic settings 
effective for already running services and applications: 
# reboot 
References: 
1. https://nvd.nist.gov/vuln/detail/CVE-2008-5161 
2. crypto-policies(7) 
3. update-crypto-policies(8) 
4. Red Hat Enterprise 8 security hardening 
5. https://www.redhat.com/en/blog/how-customize-crypto-policies-rhel-82 
6. https://csrc.nist.gov/glossary/term/message_authentication_code_algorithm 
7. NIST SP 800-53 Rev. 5: SC-8",,
,,,,,"Note: 
• 
The commands below are written for the included DEFAULT system-wide crypto 
policy. If another policy is in use and follows local site policy, replace DEFAULT 
with the name of your system-wide crypto policy. 
• 
CBC can be turned off globally by using the argument cipher opposed to 
cipher@SSH 
• 
Multiple subpolicies may be assigned to a policy as a colon separated list. e.g. 
DEFAULT:NO-SHA1:NO-SSHCBC 
• 
Subpolicies: 
o Not included in the update-crypto-policies --set command will not 
be applied to the system wide crypto policy. 
o must exist before they can be applied to the system wide crypto policy. 
o .pmod file filenames must be in all upper case, upper case, e.g. NO-
SSHCBC.pmod, or they will not be read by the update-crypto-policies 
--set command. 
Create or edit a file in /etc/crypto-policies/policies/modules/ 
ending in .pmod and add or modify one of the the following lines: 
cipher@SSH = -*-CBC # Disables the CBC cipher for SSH 
Example: 
# printf '%s\n' ""# This is a subpolicy to disable all CBC mode ciphers"" ""# 
for the SSH protocol (libssh and OpenSSH)"" ""cipher@SSH = -*-CBC"" >> 
/etc/crypto-policies/policies/modules/NO-SSHCBC.pmod 
Run the following command to update the system-wide cryptographic policy 
# update-crypto-policies --set 
<CRYPTO_POLICY>:<CRYPTO_SUBPOLICY1>:<CRYPTO_SUBPOLICY2>:<CRYPTO_SUBPOLICY3> 
Example: 
update-crypto-policies --set DEFAULT:NO-SHA1:NO-WEAKMAC:NO-SSHCBC 
Run the following command to reboot the system to make your cryptographic settings 
effective for already running services and applications: 
# reboot",,
,,,,,"Note: 
• 
The commands below are written for the included DEFAULT system-wide crypto 
policy. If another policy is in use and follows local site policy, replace DEFAULT 
with the name of your system-wide crypto policy. 
• 
chacha20-poly1305 can be turned off globally by using the argument cipher 
opposed to cipher@SSH 
• 
Multiple subpolicies may be assigned to a policy as a colon separated list. e.g. 
DEFAULT:NO-SHA1:NO-SSHCBC 
• 
Subpolicies: 
o Not included in the update-crypto-policies --set command will not 
be applied to the system wide crypto policy. 
o must exist before they can be applied to the system wide crypto policy. 
o .pmod file filenames must be in all upper case, upper case, e.g. NO-
SSHCHACHA20.pmod, or they will not be read by the update-crypto-
policies --set command. 
- IF - CVE-2023-48795 has been addressed, and it meets local site policy, this 
recommendation may be skipped. 
Create or edit a file in /etc/crypto-policies/policies/modules/ ending in .pmod 
and add or modify one of the the following lines: 
cipher@SSH = -CHACHA20-POLY1305 # Disables the chacha20-poly1305 cipher for 
SSH 
Example: 
# printf '%s\n' ""# This is a subpolicy to disable the chacha20-poly1305 
ciphers"" ""# for the SSH protocol (libssh and OpenSSH)"" ""cipher@SSH = -
CHACHA20-POLY1305"" >> /etc/crypto-policies/policies/modules/NO-
SSHCHACHA20.pmod 
Run the following command to update the system-wide cryptographic policy 
# update-crypto-policies --set 
<CRYPTO_POLICY>:<CRYPTO_SUBPOLICY1>:<CRYPTO_SUBPOLICY2>:<CRYPTO_SUBPOLICY3> 
Example: 
# update-crypto-policies --set DEFAULT:NO-SHA1:NO-WEAKMAC:NO-SSHCBC:NO-
SSHCHACHA20 
Run the following command to reboot the system to make your cryptographic settings 
effective for already running services and applications: 
# reboot",,
,,,,,"Note: 
• 
The commands below are written for the included DEFAULT system-wide crypto 
policy. If another policy is in use and follows local site policy, replace DEFAULT 
with the name of your system-wide crypto policy. 
• 
EtM can be turned off globally by using the argument etm opposed to etm@SSH 
• 
Multiple subpolicies may be assigned to a policy as a colon separated list. e.g. 
DEFAULT:NO-SHA1:NO-SSHCBC 
• 
Subpolicies: 
o Not included in the update-crypto-policies --set command will not 
be applied to the system wide crypto policy. 
o must exist before they can be applied to the system wide crypto policy. 
o .pmod file filenames must be in all upper case, upper case, e.g. NO-
SSHCHACHA20.pmod, or they will not be read by the update-crypto-
policies --set command. 
- IF - CVE-2023-48795 has been addressed, and it meets local site policy, this 
recommendation may be skipped. 
Create or edit a file in /etc/crypto-policies/policies/modules/ ending in .pmod 
and add or modify the following line: 
etm@SSH = DISABLE_ETM # This disables EtM for openSSH and libssh 
Example: 
# printf '%s\n' ""# This is a subpolicy to disable Encrypt then MAC"" ""# for 
the SSH protocol (libssh and OpenSSH)"" ""etm@SSH = DISABLE_ETM"" >> 
/etc/crypto-policies/policies/modules/NO-SSHETM.pmod 
Run the following command to update the system-wide cryptographic policy 
# update-crypto-policies --set 
<CRYPTO_POLICY>:<CRYPTO_SUBPOLICY1>:<CRYPTO_SUBPOLICY2>:<CRYPTO_SUBPOLICY3> 
Example: 
# update-crypto-policies --set DEFAULT:NO-SHA1:NO-WEAKMAC:NO-SSHCBC:NO-
SSHCHACHA20:NO-SSHETM 
Run the following command to reboot the system to make your cryptographic settings 
effective for already running services and applications: 
# reboot",,
,,,,,"Edit the file found in /etc/motd.d/* with the appropriate contents according to your 
site policy, remove any instances of \m , \r , \s , \v or references to the OS platform 
- OR - 
- IF - the motd is not used, this file can be removed. 
Run the following command to remove the motd file: 
# rm /etc/motd 
Run the following script and review and/or update all returned files' contents to: 
• 
Remove all system information (\v, \r; \m, \s) 
• 
Remove any refence to the operating system 
• 
Ensure contents follow local site policy 
#!/usr/bin/env bash 
 
{ 
   a_files=() 
   for l_file in /etc/motd{,.d/*}; do 
      if grep -Psqi -- ""(\\\v|\\\r|\\\m|\\\s|\b$(grep ^ID= /etc/os-release | 
cut -d= -f2 | sed -e 's/""//g')\b)"" ""$l_file""; then 
         echo -e ""\n - File: \""$l_file\"" includes system information. Edit 
this file to remove these entries"" 
      else 
      a_files+=(""$l_file"") 
      fi 
   done 
   if [ ""${#a_files[@]}"" -gt 0 ]; then 
      echo -e ""\n-  ** Please review the following files and verify their 
contents follow local site policy **\n"" 
      printf '%s\n' ""${a_files[@]}"" 
   fi 
} 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-1, CM-3 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1082, T1082.000, T1592, 
T1592.004 
TA0007",,
,,,,,"Edit the /etc/issue file with the appropriate contents according to your site policy, 
remove any instances of \m , \r , \s , \v or references to the OS platform 
Example: 
# echo ""Authorized users only. All activity may be monitored and reported."" > 
/etc/issue 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-1, CM-3 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1082, T1082.000, T1592, 
T1592.004 
TA0007",,
,,,,,"Edit the /etc/issue.net file with the appropriate contents according to your site policy, 
remove any instances of \m , \r , \s , \v or references to the OS platform 
Example: 
# echo ""Authorized users only. All activity may be monitored and reported."" > 
/etc/issue.net 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-1, CM-3 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1018, T1018.000, T1082, 
T1082.000, T1592, 
T1592.004 
TA0007",,
1.7.4 Ensure access to /etc/motd is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The contents of the /etc/motd file are displayed to users after login and function as a 
message of the day for authenticated users.","- IF - the /etc/motd file does not have the correct access configured, it could be 
modified by unauthorized users with incorrect or misleading information.","Run the following command and verify that if /etc/motd exists, Access is 644 or more 
restrictive, Uid and Gid are both 0/root: 
# [ -e /etc/motd ] && stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ 
%G)' /etc/motd 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root) 
  -- OR -- 
Nothing is returned","Run the following commands to set mode, owner, and group on /etc/motd: 
# chown root:root $(readlink -e /etc/motd) 
# chmod u-x,go-wx $(readlink -e /etc/motd) 
- OR - 
Run the following command to remove the /etc/motd file: 
# rm /etc/motd 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",,
1.7.5 Ensure access to /etc/issue is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The contents of the /etc/issue file are displayed to users prior to login for local 
terminals.","- IF - the /etc/issue file does not have the correct access configured, it could be 
modified by unauthorized users with incorrect or misleading information.","Run the following command and verify Access is 644 or more restrictive and Uid and 
Gid are both 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ %G)' /etc/issue 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: { 0/ root)","Run the following commands to set mode, owner, and group on /etc/issue: 
# chown root:root $(readlink -e /etc/issue) 
# chmod u-x,go-wx $(readlink -e /etc/issue)","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
1.7.6 Ensure access to /etc/issue.net is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The contents of the /etc/issue.net file are displayed to users prior to login for remote 
connections from configured services.","- IF - the /etc/issue.net file does not have the correct access configured, it could be 
modified by unauthorized users with incorrect or misleading information.","Run the following command and verify Access is 644 or more restrictive and Uid and 
Gid are both 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ %G)' /etc/issue.net 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root)   Gid: ( 0/ root)","Run the following commands to set mode, owner, and group on /etc/issue.net: 
# chown root:root $(readlink -e /etc/issue.net) 
# chmod u-x,go-wx $(readlink -e /etc/issue.net)","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
1.8.1 Ensure GNOME Display Manager is removed (Automated), Level 2 - Server,"The GNOME Display Manager (GDM) is a program that manages graphical display 
servers and handles graphical user logins.","If a Graphical User Interface (GUI) is not required, it should be removed to reduce the 
attack surface of the system. 
Impact: 
Removing the GNOME Display manager will remove the Graphical User Interface (GUI) 
from the system.","Run the following command and verify the output: 
# rpm -q gdm 
 
package gdm is not installed","Run the following command to remove the gdm package 
# dnf remove gdm 
References: 
1. https://wiki.gnome.org/Projects/GDM",,
,,,,,Run the following script to verify that the banner message is enabled and set:,,
,,,,,"Run the following script to enable the disable-user-list option: 
Note: the l_gdm_profile variable in the script can be changed if a different profile 
name is desired in accordance with local site policy. 
#!/usr/bin/env bash 
 
{ 
   l_gdmprofile=""gdm"" 
   if [ ! -f ""/etc/dconf/profile/$l_gdmprofile"" ]; then 
      echo ""Creating profile \""$l_gdmprofile\"""" 
      echo -e ""user-db:user\nsystem-db:$l_gdmprofile\nfile-
db:/usr/share/$l_gdmprofile/greeter-dconf-defaults"" > 
/etc/dconf/profile/$l_gdmprofile 
   fi 
   if [ ! -d ""/etc/dconf/db/$l_gdmprofile.d/"" ]; then 
      echo ""Creating dconf database directory 
\""/etc/dconf/db/$l_gdmprofile.d/\"""" 
      mkdir /etc/dconf/db/$l_gdmprofile.d/ 
   fi 
   if ! grep -Piq '^\h*disable-user-list\h*=\h*true\b' 
/etc/dconf/db/$l_gdmprofile.d/*; then 
      echo ""creating gdm keyfile for machine-wide settings"" 
      if ! grep -Piq -- '^\h*\[org\/gnome\/login-screen\]' 
/etc/dconf/db/$l_gdmprofile.d/*; then 
         echo -e ""\n[org/gnome/login-screen]\n# Do not show the user 
list\ndisable-user-list=true"" >> /etc/dconf/db/$l_gdmprofile.d/00-login-
screen 
      else 
         sed -ri '/^\s*\[org\/gnome\/login-screen\]/ a\# Do not show the user 
list\ndisable-user-list=true' $(grep -Pil -- '^\h*\[org\/gnome\/login-
screen\]' /etc/dconf/db/$l_gdmprofile.d/*) 
      fi 
   fi 
   dconf update 
} 
Note: When the user profile is created or changed, the user will need to log out and log 
in again before the changes will be applied. 
- OR - 
Run the following command to remove the GNOME package: 
# dnf remove gdm","false 
References: 
1. https://help.gnome.org/admin/system-admin-guide/stable/login-userlist-
disable.html.en",
,,,,,"Create or edit a file in the /etc/dconf/profile/ and verify it includes the following: 
user-db:user 
system-db:{NAME_OF_DCONF_DATABASE} 
Note: local is the name of a dconf database used in the examples. 
Example: 
# echo -e '\nuser-db:user\nsystem-db:local' >> /etc/dconf/profile/user 
Create the directory /etc/dconf/db/{NAME_OF_DCONF_DATABASE}.d/ if it doesn't 
already exist: 
Example: 
# mkdir /etc/dconf/db/local.d 
Create the key file /etc/dconf/db/{NAME_OF_DCONF_DATABASE}.d/{FILE_NAME} to 
provide information for the {NAME_OF_DCONF_DATABASE} database: 
Example script: 
#!/usr/bin/env bash 
 
{ 
   l_key_file=""/etc/dconf/db/local.d/00-screensaver"" 
   l_idmv=""900"" # Set max value for idle-delay in seconds (between 1 and 900) 
   l_ldmv=""5"" # Set max value for lock-delay in seconds (between 0 and 5) 
   { 
      echo '# Specify the dconf path' 
      echo '[org/gnome/desktop/session]' 
      echo '' 
      echo '# Number of seconds of inactivity before the screen goes blank' 
      echo '# Set to 0 seconds if you want to deactivate the screensaver.' 
      echo ""idle-delay=uint32 $l_idmv"" 
      echo '' 
      echo '# Specify the dconf path' 
      echo '[org/gnome/desktop/screensaver]' 
      echo '' 
      echo '# Number of seconds after the screen is blank before locking the 
screen' 
      echo ""lock-delay=uint32 $l_ldmv"" 
   } > ""$l_key_file"" 
} 
Note: You must include the uint32 along with the integer key values as shown. 
Run the following command to update the system databases: 
# dconf update 
Note: Users must log out and back in again before the system-wide settings take effect. 
References: 
1. https://help.gnome.org/admin/system-admin-guide/stable/desktop-
lockscreen.html.en",,
,,,,,Run the following script to ensure screen locks cannot be overridden:,,
,,,,,Run the following script to disable automatic mounting of media for all GNOME users:,,
,,,,,"Run the following script to lock disable automatic mounting of media for all GNOME 
users:",,
,,,,,Run the following script to set autorun-never to true for GDM users:,,
,,,,,"Run the following script to ensure that autorun-never=true cannot be overridden: 
#!/usr/bin/env bash 
 
{ 
   # Check if GNOME Desktop Manager is installed.  If package isn't installed, 
recommendation is Not Applicable\n 
   # determine system's package manager 
   l_pkgoutput="""" 
   if command -v dpkg-query > /dev/null 2>&1; then 
      l_pq=""dpkg-query -W"" 
   elif command -v rpm > /dev/null 2>&1; then 
      l_pq=""rpm -q"" 
   fi 
   # Check if GDM is installed 
   l_pcl=""gdm gdm3"" # Space separated list of packages to check 
   for l_pn in $l_pcl; do 
      $l_pq ""$l_pn"" > /dev/null 2>&1 && l_pkgoutput=""y"" && echo -e ""\n - Package: 
\""$l_pn\"" exists on the system\n - remediating configuration if needed"" 
   done 
   # Check configuration (If applicable) 
   if [ -n ""$l_pkgoutput"" ]; then 
      # Look for autorun to determine profile in use, needed for remaining tests 
      l_kfd=""/etc/dconf/db/$(grep -Psril '^\h*autorun-never\b' /etc/dconf/db/*/ | awk 
-F'/' '{split($(NF-1),a,""."");print a[1]}').d"" #set directory of key file to be locked 
      if [ -d ""$l_kfd"" ]; then # If key file directory doesn't exist, options can't be 
locked 
         if grep -Priq '^\h*\/org/gnome\/desktop\/media-handling\/autorun-never\b' 
""$l_kfd""; then 
            echo "" - \""autorun-never\"" is locked in \""$(grep -Pril 
'^\h*\/org/gnome\/desktop\/media-handling\/autorun-never\b' ""$l_kfd"")\"""" 
         else 
            echo "" - creating entry to lock \""autorun-never\"""" 
            [ ! -d ""$l_kfd""/locks ] && echo ""creating directory $l_kfd/locks"" && mkdir 
""$l_kfd""/locks 
            { 
               echo -e '\n# Lock desktop media-handling autorun-never setting' 
               echo '/org/gnome/desktop/media-handling/autorun-never' 
            } >> ""$l_kfd""/locks/00-media-autorun         
         fi 
      else 
         echo -e "" - \""autorun-never\"" is not set so it can not be locked\n - Please 
follow Recommendation \""Ensure GDM autorun-never is enabled\"" and follow this 
Recommendation again"" 
      fi 
      # update dconf database 
      dconf update 
   else 
      echo -e "" - GNOME Desktop Manager package is not installed on the system\n  - 
Recommendation is not applicable"" 
   fi 
}",,
1.8.10 Ensure XDMCP is not enabled (Automated)," Level 1 - Server 
 Level 1 - Workstation","X Display Manager Control Protocol (XDMCP) is designed to provide authenticated 
access to display management services for remote displays","XDMCP is inherently insecure. 
• 
XDMCP is not a ciphered protocol. This may allow an attacker to capture 
keystrokes entered by a user 
• 
XDMCP is vulnerable to man-in-the-middle attacks. This may allow an attacker to 
steal the credentials of legitimate users by impersonating the XDMCP server.","Run the following command and verify the output: 
# grep -Eis '^\s*Enable\s*=\s*true' /etc/gdm/custom.conf 
 
Nothing should be returned","Edit the file /etc/gdm/custom.conf and remove the line: 
Enable=true","false (This is denoted by no Enabled= entry in the file /etc/gdm/custom.conf in the 
[xdmcp] section",
,,,,"As a preference autofs should not be installed unless other packages depend on it. 
Run the following command to verify autofs is not installed: 
# rpm -q autofs 
 
package autofs is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify autofs.service is not enabled: 
# systemctl is-enabled autofs.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the autofs.service is not active: 
# systemctl is-active autofs.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop autofs.service and remove autofs package: 
# systemctl stop autofs.service 
# dnf remove autofs 
- OR - 
- IF - the autofs package is required as a dependency: 
Run the following commands to stop and mask autofs.service: 
# systemctl stop autofs.service 
# systemctl mask autofs.service 
References: 
1. NIST SP 800-53 Rev. 5: SI-3, MP-7",,
,,,,"Run the following command to verify the avahi package is not installed: 
# rpm -q avahi 
 
package avahi is not installed 
- OR - 
- IF - the avahi package is required as a dependency: 
Run the following command to verify avahi-daemon.socket and avahi-
daemon.service are not enabled: 
# systemctl is-enabled avahi-daemon.socket avahi-daemon.service 2>/dev/null | 
grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify avahi-daemon.socket and avahi-
daemon.service are not active: 
# systemctl is-active avahi-daemon.socket avahi-daemon.service 2>/dev/null | 
grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop avahi-daemon.socket and avahi-
daemon.service, and remove the avahi package: 
# systemctl stop avahi-daemon.socket avahi-daemon.service 
# dnf remove avahi 
- OR - 
- IF - the avahi package is required as a dependency: 
Run the following commands to stop and mask the avahi-daemon.socket and avahi-
daemon.service: 
# systemctl stop avahi-daemon.socket avahi-daemon.service 
# systemctl mask avahi-daemon.socket avahi-daemon.service 
References: 
1. NIST SP 800-53 Rev. 5: SI-4",,
,,,,"Run the following command to verify dhcp-server is not installed: 
# rpm -q dhcp-server 
 
package dhcp-server is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify dhcpd.service and dhcpd6.service are not 
enabled: 
# systemctl is-enabled dhcpd.service dhcpd6.service 2>/dev/null | grep 
'enabled' 
 
Nothing should be returned 
Run the following command to verify dhcpd.service and dhcpd6.service are not 
active: 
# systemctl is-active dhcpd.service dhcpd6.service 2>/dev/null | grep 
'^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop dhcpd.service and dhcpd6.service and 
remove dhcp-server package: 
# systemctl stop dhcpd.service dhcpd6.service 
# dnf remove dhcp-server 
- OR - 
- IF - the dhcp-server package is required as a dependency: 
Run the following commands to stop and mask dhcpd.service and dhcpd6.service: 
# systemctl stop dhcpd.service dhcpd6.service 
# systemctl mask dhcpd.service dhcpd6.service 
References: 
1. dhcpd(8) 
2. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run one of the following commands to verify bind is not installed: 
# rpm -q bind 
 
package bind is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify named.service is not enabled: 
# systemctl is-enabled named.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the named.service is not active: 
# systemctl is-active named.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop named.service and remove bind package: 
# systemctl stop named.service 
# dnf remove bind 
- OR - 
- IF - the bind package is required as a dependency: 
Run the following commands to stop and mask named.service: 
# systemctl stop named.service 
# systemctl mask named.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run one of the following commands to verify dnsmasq is not installed: 
# rpm -q dnsmasq 
 
package dnsmasq is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify dnsmasq.service is not enabled: 
# systemctl is-enabled dnsmasq.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the dnsmasq.service is not active: 
# systemctl is-active dnsmasq.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop dnsmasq.service and remove dnsmasq package: 
# systemctl stop dnsmasq.service 
# dnf remove dnsmasq 
- OR - 
- IF - the dnsmasq package is required as a dependency: 
Run the following commands to stop and mask the dnsmasq.service: 
# systemctl stop dnsmasq.service 
# systemctl mask dnsmasq.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify samba package is not installed: 
# rpm -q samba 
 
package samba is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify smb.service is not enabled: 
# systemctl is-enabled smb.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the smb.service is not active: 
# systemctl is-active smb.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following command to stop smb.service and remove samba package: 
# systemctl stop smb.service 
# dnf remove samba 
- OR - 
- IF - the samba package is required as a dependency: 
Run the following commands to stop and mask the smb.service: 
# systemctl stop smb.service 
# systemctl mask smb.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-7",,
,,,,"Run the following command to verify vsftpd is not installed: 
# rpm -q vsftpd 
 
package vsftpd is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify vsftpd service is not enabled: 
# systemctl is-enabled vsftpd.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the vsftpd service is not active: 
# systemctl is-active vsftpd.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: 
• 
Other ftp server packages may exist. They should also be audited, if not required 
and authorized by local site policy 
• 
If the package is required for a dependency: 
o Ensure the dependent package is approved by local site policy 
o Ensure stopping and masking the service and/or socket meets local site 
policy","Run the following commands to stop vsftpd.service and remove vsftpd package: 
# systemctl stop vsftpd.service 
# dnf remove vsftpd 
- OR - 
- IF - the vsftpd package is required as a dependency: 
Run the following commands to stop and mask the vsftpd.service: 
# systemctl stop vsftpd.service 
# systemctl mask vsftpd.service 
Note: Other ftp server packages may exist. If not required and authorized by local site 
policy, they should also be removed. If the package is required for a dependency, the 
service should be stopped and masked. 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify dovecot and cyrus-imapd are not installed: 
# rpm -q dovecot cyrus-imapd 
 
package dovecot is not installed 
package cyrus-imapd is not installed 
- OR - 
- IF - a package is installed and is required for dependencies: 
Run the following commands to verify dovecot.socket, dovecot.service, and 
cyrus-imapd.service are not enabled: 
# systemctl is-enabled dovecot.socket dovecot.service cyrus-imapd.service 
2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify dovecot.socket, dovecot.service, and cyrus-
imapd.service are not active: 
# systemctl is-active dovecot.socket dovecot.service cyrus-imapd.service 
2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop dovecot.socket, dovecot.service, and cyrus-
imapd.service, and remove dovecot and cyrus-imapd packages: 
# systemctl stop dovecot.socket dovecot.service cyrus-imapd.service 
# dnf remove dovecot cyrus-imapd 
- OR - 
- IF - a package is installed and is required for dependencies: 
Run the following commands to stop and mask dovecot.socket, dovecot.service, 
and cyrus-imapd.service: 
# systemctl stop dovecot.socket dovecot.service cyrus-imapd.service 
# systemctl mask dovecot.socket dovecot.service cyrus-imapd.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify nfs-utils is not installed: 
# rpm -q nfs-utils 
 
package nfs-utils is not installed 
- OR - If package is required for dependencies: 
Run the following command to verify that the nfs-server.service is not enabled: 
# systemctl is-enabled nfs-server.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the nfs-server.service is not active: 
# systemctl is-active nfs-server.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following command to stop nfs-server.service and remove nfs-utils 
package: 
# systemctl stop nfs-server.service 
# dnf remove nfs-utils 
- OR - 
- IF - the nfs-utils package is required as a dependency: 
Run the following commands to stop and mask the nfs-server.service: 
# systemctl stop nfs-server.service 
# systemctl mask nfs-server.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-7 
Additional Information: 
Many of the libvirt packages used by Enterprise Linux virtualization are dependent on 
the nfs-utils package. If the nfs-utils package is required as a dependency, the nfs-
server service should be disabled and masked to reduce the attack surface of the 
system.",,
,,,,"Run the following command to verify ypserv is not installed: 
# rpm -q ypserv 
 
package ypserv is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify ypserv.service is not enabled: 
# systemctl is-enabled ypserv.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify ypserv.service is not active: 
# systemctl is-active ypserv.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop ypserv.service and remove ypserv package: 
# systemctl stop ypserv.service 
# dnf remove ypserv 
- OR - 
- IF - the ypserv package is required as a dependency: 
Run the following commands to stop and mask ypserv.service: 
# systemctl stop ypserv.service 
# systemctl mask ypserv.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify cups is not installed: 
# rpm -q cups 
 
package cups is not installed 
- OR - 
- IF - the cups package is required as a dependency: 
Run the following command to verify the cups.socket and cups.service are not 
enabled: 
# systemctl is-enabled cups.socket cups.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the cups.socket and cups.service are not 
active: 
# systemctl is-active cups.socket cups.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop cups.socket and cups.service, and remove the 
cups package: 
# systemctl stop cups.socket cups.service 
# dnf remove cups 
- OR - 
- IF - the cups package is required as a dependency: 
Run the following commands to stop and mask the cups.socket and cups.service: 
# systemctl stop cups.socket cups.service 
# systemctl mask cups.socket cups.service 
References: 
1. http://www.cups.org 
2. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify rpcbind package is not installed: 
# rpm -q rpcbind 
 
package rpcbind is not installed 
- OR - 
- IF - the rpcbind package is required as a dependency: 
Run the following command to verify rpcbind.socket and rpcbind.service are not 
enabled: 
# systemctl is-enabled rpcbind.socket rpcbind.service 2>/dev/null | grep 
'enabled' 
 
Nothing should be returned 
Run the following command to verify rpcbind.socket and rpcbind.service are not 
active: 
# systemctl is-active rpcbind.socket rpcbind.service 2>/dev/null | grep 
'^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop rpcbind.socket and rpcbind.service, and 
remove the rpcbind package: 
# systemctl stop rpcbind.socket rpcbind.service 
# dnf remove rpcbind 
- OR - 
- IF - the rpcbind package is required as a dependency: 
Run the following commands to stop and mask the rpcbind.socket and 
rpcbind.service: 
# systemctl stop rpcbind.socket rpcbind.service 
# systemctl mask rpcbind.socket rpcbind.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-7",,
,,,,"Run the following command to verify the rsync-daemon package is not installed: 
# rpm -q rsync-daemon 
 
package rsync-daemon is not installed 
- OR - 
- IF - the rsync-daemon package is required as a dependency: 
Run the following command to verify rsyncd.socket and rsyncd.service are not 
enabled: 
# systemctl is-enabled rsyncd.socket rsyncd.service 2>/dev/null | grep 
'enabled' 
 
Nothing should be returned 
Run the following command to verify rsyncd.socket and rsyncd.service are not 
active: 
# systemctl is-active rsyncd.socket rsyncd.service 2>/dev/null | grep 
'^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop rsyncd.socket and rsyncd.service, and 
remove the rsync-daemon package: 
# systemctl stop rsyncd.socket rsyncd.service 
# dnf remove rsync-daemon 
- OR - 
- IF - the rsync-daemon package is required as a dependency: 
Run the following commands to stop and mask the rsyncd.socket and 
rsyncd.service: 
# systemctl stop rsyncd.socket rsyncd.service 
# systemctl mask rsyncd.socket rsyncd.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-7",,
,,,,"Run the following command to verify net-snmp package is not installed: 
# rpm -q net-snmp 
 
package net-snmp is not installed 
- OR - If the package is required for dependencies: 
Run the following command to verify the snmpd.service is not enabled: 
# systemctl is-enabled snmpd.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the snmpd.service is not active: 
# systemctl is-active snmpd.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop snmpd.service and remove net-snmp package: 
# systemctl stop snmpd.service 
# dnf remove net-snmp 
- OR - If the package is required for dependencies: 
Run the following commands to stop and mask the snmpd.service: 
# systemctl stop snmpd.service 
# systemctl mask snmpd.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify the telnet-server package is not installed: 
rpm -q telnet-server 
 
package telnet-server is not installed 
- OR - 
- IF - a package is installed and is required for dependencies: 
Run the following command to verify telnet.socket is not enabled: 
# systemctl is-enabled telnet.socket 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify telnet.socket is not active: 
# systemctl is-active telnet.socket 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop telnet.socket and remove the telnet-server 
package: 
# systemctl stop telnet.socket 
# dnf remove telnet-server 
- OR - 
- IF - a package is installed and is required for dependencies: 
Run the following commands to stop and mask telnet.socket: 
# systemctl stop telnet.socket 
# systemctl mask telnet.socket 
References: 
1. NIST SP 800-53 Rev. 5: CM-7, CM-11",,
,,,,"Run the following command to verify tftp-server is not installed: 
# rpm -q tftp-server 
 
package tftp-server is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify tftp.socket and tftp.service are not enabled: 
# systemctl is-enabled tftp.socket tftp.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the tftp.socket and tftp.service are not 
active: 
# systemctl is-active tftp.socket tftp.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop tftp.socket and tftp.service, and remove the 
tftp-server package: 
# systemctl stop tftp.socket tftp.service 
# dnf remove tftp-server 
- OR - 
- IF - the tftp-server package is required as a dependency: 
Run the following commands to stop and mask tftp.socket and tftp.service: 
# systemctl stop tftp.socket tftp.service 
# systemctl mask tftp.socket tftp.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify squid package is not installed: 
# rpm -q squid 
 
package squid is not installed 
- OR - 
- IF - the package is required for dependencies: 
Run the following command to verify squid.service is not enabled: 
# systemctl is-enabled squid.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify the squid.service is not active: 
# systemctl is-active squid.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop squid.service and remove the squid package: 
# systemctl stop squid.service 
# dnf remove squid 
- OR - If the squid package is required as a dependency: 
Run the following commands to stop and mask the squid.service: 
# systemctl stop squid.service 
# systemctl mask squid.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-6, CM-7 
Additional Information: 
Several HTTP proxy servers exist. These and other services should be checked.",,
,,,,,"Run the following commands to stop httpd.socket, httpd.service, and 
nginx.service, and remove httpd and nginx packages: 
# systemctl stop httpd.socket httpd.service nginx.service 
# dnf remove httpd nginx 
- OR - 
- IF - a package is installed and is required for dependencies: 
Run the following commands to stop and mask httpd.socket, httpd.service, and 
nginx.service: 
# systemctl stop httpd.socket httpd.service nginx.service 
# systemctl mask httpd.socket httpd.service nginx.service 
Note: Other web server packages may exist. If not required and authorized by local site 
policy, they should also be removed. If the package is required for a dependency, the 
service and socket should be stopped and masked. 
References: 
1. NIST SP 800-53 Rev. 5: CM-7 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1203, T1203.000, T1210, 
T1210.000, T1543, 
T1543.002 
TA0008 
M1042",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1203 T1203.000 T1210 
T1210.000 T1543 
T1543.002 
TA0008 
M1042"
,,,,"Run the following command to verify the xinetd package is not installed: 
# rpm -q xinetd 
 
package xinetd is not installed 
- OR - 
- IF - the xinetd package is required as a dependency: 
Run the following command to verify xinetd.service is not enabled: 
# systemctl is-enabled xinetd.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify xinetd.service is not active: 
# systemctl is-active xinetd.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop xinetd.service, and remove the xinetd 
package: 
# systemctl stop xinetd.service 
# dnf remove xinetd 
- OR - 
- IF - the xinetd package is required as a dependency: 
Run the following commands to stop and mask the xinetd.service: 
# systemctl stop xinetd.service 
# systemctl mask xinetd.service 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,,"- IF - a Graphical Desktop Manager or X-Windows server is not required and approved 
by local site policy: 
Run the following command to remove the X Windows Server packages: 
# dnf remove xorg-x11-server-common 
References: 
1. NIST SP 800-53 Rev. 5: CM-11 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1203, T1203.000, T1210, 
T1210.000, T1543, 
T1543.002 
TA0008 
M1042",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1203 T1203.000 T1210 
T1210.000 T1543 
T1543.002 
TA0008 
M1042"
,,,,"Run the following script to verify that the MTA is not listening on any non-loopback 
address ( 127.0.0.1 or ::1): 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" 
   a_port_list=(""25"" ""465"" ""587"") 
   if [ ""$(postconf -n inet_interfaces)"" != ""inet_interfaces = all"" ]; then 
      for l_port_number in ""${a_port_list[@]}""; do 
         if ss -plntu | grep -P -- ':'""$l_port_number""'\b' | grep -Pvq -- 
'\h+(127\.0\.0\.1|\[?::1\]?):'""$l_port_number""'\b'; then 
               l_output2=""$l_output2\n - Port \""$l_port_number\"" is listening 
on a non-loopback network interface"" 
         else 
               l_output=""$l_output\n - Port \""$l_port_number\"" is not 
listening on a non-loopback network interface"" 
         fi 
      done 
   else 
      l_output2=""$l_output2\n - Postfix is bound to all interfaces"" 
   fi 
   unset a_port_list 
   if [ -z ""$l_output2"" ]; then 
      echo -e ""\n- Audit Result:\n  ** PASS **\n$l_output\n"" 
   else 
      echo -e ""\n- Audit Result:\n  ** FAIL **\n - Reason(s) for audit 
failure:\n$l_output2\n"" 
      [ -n ""$l_output"" ] && echo -e ""\n- Correctly set:\n$l_output\n"" 
   fi 
}","Edit /etc/postfix/main.cf and add the following line to the RECEIVING MAIL 
section. If the line already exists, change it to look like the line below: 
inet_interfaces = loopback-only 
Run the following command to restart postfix: 
# systemctl restart postfix 
Note: 
• 
This remediation is designed around the postfix mail server. 
• 
Depending on your environment you may have an alternative MTA installed such 
as sendmail. If this is the case consult the documentation for your installed MTA 
to configure the recommended state. 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command: 
# ss -plntu 
Review the output to ensure: 
• 
All services listed are required on the system and approved by local site policy. 
• 
Both the port and interface the service is listening on are approved by local site 
policy. 
• 
If a listed service is not required: 
o Remove the package containing the service 
o - IF - the service's package is required for a dependency, stop and mask 
the service and/or socket","Run the following commands to stop the service and remove the package containing 
the service: 
# systemctl stop <service_name>.socket <service_name>.service 
# dnf remove <package_name> 
- OR - If required packages have a dependency: 
Run the following commands to stop and mask the service and socket: 
# systemctl stop <service_name>.socket <service_name>.service 
# systemctl mask <service_name>.socket <service_name>.service 
Note: replace <service_name> with the appropriate service name. 
References: 
1. NIST SP 800-53 Rev. 5: CM-7 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 "
2.2.1 Ensure ftp client is not installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","FTP (File Transfer Protocol) is a traditional and widely used standard tool for 
transferring files between a server and clients over a network, especially where no 
authentication is necessary (permits anonymous users to connect to a server).","FTP does not protect the confidentiality of data or authentication credentials. It is 
recommended SFTP be used if file transfer is required. Unless there is a need to run 
the system as a FTP server (for example, to allow anonymous downloads), it is 
recommended that the package be removed to reduce the potential attack surface.","Run the following command to verify ftp is not installed: 
# rpm -q ftp 
 
package ftp is not installed","Run the following command to remove ftp: 
# dnf remove ftp 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
2.2.2 Ensure ldap client is not installed (Automated)," Level 2 - Server 
 Level 2 - Workstation","The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for 
NIS/YP. It is a service that provides a method for looking up information from a central 
database.","If the system will not need to act as an LDAP client, it is recommended that the software 
be removed to reduce the potential attack surface. 
Impact: 
Removing the LDAP client will prevent or inhibit using LDAP for authentication in your 
environment.","Run the following command to verify that the openldap-clients package is not 
installed: 
# rpm -q openldap-clients 
 
package openldap-clients is not installed","Run the following command to remove the openldap-clients package: 
# dnf remove openldap-clients 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
2.2.3 Ensure nis client is not installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","The Network Information Service (NIS), formerly known as Yellow Pages, is a client-
server directory service protocol used to distribute system configuration files. The NIS 
client ( ypbind ) was used to bind a machine to an NIS server and receive the 
distributed configuration files.","The NIS service is inherently an insecure system that has been vulnerable to DOS 
attacks, buffer overflows and has poor authentication for querying NIS maps. NIS 
generally has been replaced by such protocols as Lightweight Directory Access 
Protocol (LDAP). It is recommended that the service be removed. 
Impact: 
Many insecure service clients are used as troubleshooting tools and in testing 
environments. Uninstalling them can inhibit capability to test and troubleshoot. If they 
are required it is advisable to remove the clients after use to prevent accidental or 
intentional misuse.","Run the following command to verify that the ypbind package is not installed: 
# rpm -q ypbind 
 
package ypbind is not installed","Run the following command to remove the ypbind package: 
# dnf remove ypbind 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
2.2.4 Ensure telnet client is not installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","The telnet package contains the telnet client, which allows users to start 
connections to other systems via the telnet protocol.","The telnet protocol is insecure and unencrypted. The use of an unencrypted 
transmission medium could allow an unauthorized user to steal credentials. The ssh 
package provides an encrypted session and stronger security and is included in most 
Linux distributions. 
Impact: 
Many insecure service clients are used as troubleshooting tools and in testing 
environments. Uninstalling them can inhibit capability to test and troubleshoot. If they 
are required it is advisable to remove the clients after use to prevent accidental or 
intentional misuse.","Run the following command to verify that the telnet package is not installed: 
# rpm -q telnet 
 
package telnet is not installed","Run the following command to remove the telnet package: 
# dnf remove telnet 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
2.2.5 Ensure tftp client is not installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","Trivial File Transfer Protocol (TFTP) is a simple protocol for exchanging files between 
two TCP/IP machines. TFTP servers allow connections from a TFTP Client for sending 
and receiving files.","TFTP does not have built-in encryption, access control or authentication. This makes it 
very easy for an attacker to exploit TFTP to gain access to files","Run the following command to verify tftp is not installed: 
# rpm -q tftp 
 
package tftp is not installed","Run the following command to remove tftp: 
# dnf remove tftp 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
2.3.1 Ensure time synchronization is in use (Automated)," Level 1 - Server 
 Level 1 - Workstation","System time should be synchronized between all systems in an environment. This is 
typically done by establishing an authoritative time server or set of servers and having 
all systems synchronize their clocks to them. 
Note: If another method for time synchronization is being used, this section may be 
skipped.","Time synchronization is important to support time sensitive security mechanisms like 
Kerberos and also ensures log files have consistent time records across the enterprise, 
which aids in forensic investigations.","Run the following commands to verify that chrony is installed: 
# rpm -q chrony 
 
chrony-<version>","Run the following command to install chrony: 
# dnf install chrony 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, AU-12 
Additional Information: 
On systems where host based time synchronization is not available, verify that chrony 
is installed. 
On systems where host based time synchronization is available consult your 
documentation and verify that host based synchronization is in use.",,
2.3.2 Ensure chrony is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","chrony is a daemon which implements the Network Time Protocol (NTP) and is 
designed to synchronize system clocks across a variety of systems and use a source 
that is highly accurate. More information on chrony can be found at 
http://chrony.tuxfamily.org/. chrony can be configured to be a client and/or a server.","If chrony is in use on the system proper configuration is vital to ensuring time 
synchronization is working properly.","Run the following command and verify remote server is configured properly: 
# grep -Prs -- '^\h*(server|pool)\h+[^#\n\r]+' /etc/chrony.conf 
/etc/chrony.d/ 
 
server <remote-server> 
Multiple servers may be configured.","Add or edit server or pool lines to /etc/chrony.conf or a file in the /etc/chrony.d 
directory as appropriate: 
Example: 
server <remote-server> 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, AU-12 
Additional Information: 
On systems where host based time synchronization is not available, verify that chrony 
is installed. 
On systems where host based time synchronization is available consult your 
documentation and verify that host based synchronization is in use.",,
2.3.3 Ensure chrony is not run as the root user (Automated)," Level 1 - Server 
 Level 1 - Workstation","The file /etc/sysconfig/chronyd allows configuration of options for chrony to include 
the user chrony is run as. By default, this is set to the user chrony",Services should not be set to run as the root user,"Run the following command to verify that chrony isn't configured to run as the root 
user: 
# grep -Psi -- '^\h*OPTIONS=\""?\h*([^#\n\r]+\h+)?-u\h+root\b' 
/etc/sysconfig/chronyd 
 
Nothing should be returned","Edit the file /etc/sysconfig/chronyd and add or modify the following line to remove 
""-u root"" from any OPTIONS= argument: 
Example: 
OPTIONS=""-F 2"" 
Run the following command to reload the chronyd.service configuration: 
# systemctl reload-or-restart chronyd.service","OPTIONS=""-F 2""",
2.4.1.1 Ensure cron daemon is enabled and active (Automated)," Level 1 - Server 
 Level 1 - Workstation",The cron daemon is used to execute batch jobs on the system.,"While there may not be user jobs that need to be run on the system, the system does 
have maintenance jobs that may include security monitoring that have to run, and cron 
is used to execute them.","- IF - cron is installed on the system: 
Run the following command to verify cron is enabled: 
# systemctl list-unit-files | awk '$1~/^crond?\.service/{print $2}' 
 
enabled 
Run the following command to verify that cron is active: 
# systemctl list-units | awk '$1~/^crond?\.service/{print $3}' 
 
active","- IF - cron is installed on the system: 
Run the following commands to unmask, enable, and start cron: 
# systemctl unmask ""$(systemctl list-unit-files | awk 
'$1~/^crond?\.service/{print $1}')"" 
# systemctl --now enable ""$(systemctl list-unit-files | awk 
'$1~/^crond?\.service/{print $1}')"" 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
"2.4.1.2 Ensure permissions on /etc/crontab are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/crontab file is used by cron to control its own jobs. The commands in this 
item make sure that root is the user and group owner of the file and that only the owner 
can access the file.","This file contains information on what system jobs are run by cron. Write access to 
these files could provide unprivileged users with the ability to elevate their privileges. 
Read access to these files could provide users with the ability to gain insight on system 
jobs that run on the system and could provide them a way to gain unauthorized 
privileged access.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other : 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/crontab 
 
Access: (600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on /etc/crontab: 
# chown root:root /etc/crontab 
# chmod og-rwx /etc/crontab","Access: (644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"2.4.1.3 Ensure permissions on /etc/cron.hourly are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","This directory contains system cron jobs that need to run on an hourly basis. The files 
in this directory cannot be manipulated by the crontab command, but are instead 
edited by system administrators using a text editor. The commands below restrict 
read/write and search access to user and group root, preventing regular users from 
accessing this directory.","Granting write access to this directory for non-privileged users could provide them the 
means for gaining unauthorized elevated privileges. Granting read access to this 
directory could give an unprivileged user insight in how to gain elevated privileges or 
circumvent auditing controls.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other: 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.hourly/ 
 
Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on the 
/etc/cron.hourly directory: 
# chown root:root /etc/cron.hourly/ 
# chmod og-rwx /etc/cron.hourly/","Access: (755/drwxr-xr-x) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2",
"2.4.1.4 Ensure permissions on /etc/cron.daily are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/cron.daily directory contains system cron jobs that need to run on a daily 
basis. The files in this directory cannot be manipulated by the crontab command, but 
are instead edited by system administrators using a text editor. The commands below 
restrict read/write and search access to user and group root, preventing regular users 
from accessing this directory.","Granting write access to this directory for non-privileged users could provide them the 
means for gaining unauthorized elevated privileges. Granting read access to this 
directory could give an unprivileged user insight in how to gain elevated privileges or 
circumvent auditing controls.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other: 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.daily/ 
 
Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on the 
/etc/cron.daily directory: 
# chown root:root /etc/cron.daily/ 
# chmod og-rwx /etc/cron.daily/","Access: (755/drwxr-xr-x) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2",
"2.4.1.5 Ensure permissions on /etc/cron.weekly are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/cron.weekly directory contains system cron jobs that need to run on a 
weekly basis. The files in this directory cannot be manipulated by the crontab 
command but are instead edited by system administrators using a text editor. The 
commands below restrict read/write and search access to user and group root, 
preventing regular users from accessing this directory.","Granting write access to this directory for non-privileged users could provide them the 
means for gaining unauthorized elevated privileges. Granting read access to this 
directory could give an unprivileged user insight in how to gain elevated privileges or 
circumvent auditing controls.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other: 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.weekly/ 
 
Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on the 
/etc/cron.weekly directory: 
# chown root:root /etc/cron.weekly/ 
# chmod og-rwx /etc/cron.weekly/","Access: (755/drwxr-xr-x) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2",
"2.4.1.6 Ensure permissions on /etc/cron.monthly are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/cron.monthly directory contains system cron jobs that need to run on a 
monthly basis. The files in this directory cannot be manipulated by the crontab 
command but are instead edited by system administrators using a text editor. The 
commands below restrict read/write and search access to user and group root, 
preventing regular users from accessing this directory.","Granting write access to this directory for non-privileged users could provide them the 
means for gaining unauthorized elevated privileges. Granting read access to this 
directory could give an unprivileged user insight in how to gain elevated privileges or 
circumvent auditing controls.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other: 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.monthly/ 
 
Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on the 
/etc/cron.monthly directory: 
# chown root:root /etc/cron.monthly/ 
# chmod og-rwx /etc/cron.monthly/","Access: (755/drwxr-xr-x) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2",
"2.4.1.7 Ensure permissions on /etc/cron.d are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/cron.d directory contains system cron jobs that need to run in a similar 
manner to the hourly, daily weekly and monthly jobs from /etc/crontab, but require 
more granular control as to when they run. The files in this directory cannot be 
manipulated by the crontab command but are instead edited by system administrators 
using a text editor. The commands below restrict read/write and search access to user 
and group root, preventing regular users from accessing this directory.","Granting write access to this directory for non-privileged users could provide them the 
means for gaining unauthorized elevated privileges. Granting read access to this 
directory could give an unprivileged user insight in how to gain elevated privileges or 
circumvent auditing controls.","- IF - cron is installed on the system: 
Run the following command and verify Uid and Gid are both 0/root and Access does 
not grant permissions to group or other: 
# stat -Lc 'Access: (%a/%A) Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/cron.d/ 
 
Access: (700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)","- IF - cron is installed on the system: 
Run the following commands to set ownership and permissions on the /etc/cron.d 
directory: 
# chown root:root /etc/cron.d/ 
# chmod og-rwx /etc/cron.d/",Access: (755/drwxr-xr-x) Uid: ( 0/ root) Gid: ( 0/ root),
,,,,,"- IF - cron is installed on the system: 
Run the following script to: 
• 
Create /etc/cron.allow if it doesn't exist 
• 
Change owner to user root 
• 
Change group owner to group root 
• 
Change mode to 640 or more restrictive 
#!/usr/bin/env bash 
 
{ 
   [ ! -e ""/etc/cron.allow"" ] && touch /etc/cron.allow 
   chown root:root /etc/cron.allow 
   chmod u-x,g-wx,o-rwx /etc/cron.allow 
} 
- IF - /etc/cron.deny exists, run the following commands to: 
• 
Change owner to user root 
• 
Change group owner to group root 
• 
Change mode to 640 or more restrictive 
# [ -e ""/etc/cron.deny"" ] && chown root:root /etc/cron.deny 
# [ -e ""/etc/cron.deny"" ] && chmod u-x,g-wx,o-rwx /etc/cron.deny 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"- IF - at is installed on the system: 
Run the following script to: 
• 
/etc/at.allow: 
o Create the file if it doesn't exist 
o Change owner or user root 
o If group daemon exists, change to group daemon, else change group to 
root 
o Change mode to 640 or more restrictive 
• 
- IF - /etc/at.deny exists: 
o Change owner or user root 
o If group daemon exists, change to group daemon, else change group to 
root 
o Change mode to 640 or more restrictive 
#!/usr/bin/env bash 
 
{ 
   grep -Pq -- '^daemon\b' /etc/group && l_group=""daemon"" || l_group=""root"" 
   [ ! -e ""/etc/at.allow"" ] && touch /etc/at.allow 
   chown root:""$l_group"" /etc/at.allow 
   chmod u-x,g-wx,o-rwx /etc/at.allow 
   [ -e ""/etc/at.deny"" ] && chown root:""$l_group"" /etc/at.deny 
   [ -e ""/etc/at.deny"" ] && chmod u-x,g-wx,o-rwx /etc/at.deny 
} 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,"Run the following script to identify if IPv6 is enabled on the system: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" 
   ! grep -Pqs -- '^\h*0\b' /sys/module/ipv6/parameters/disable && 
l_output=""- IPv6 is not enabled"" 
   if sysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- 
""^\h*net\.ipv6\.conf\.all\.disable_ipv6\h*=\h*1\b"" && \ 
      sysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- 
""^\h*net\.ipv6\.conf\.default\.disable_ipv6\h*=\h*1\b""; then 
      l_output=""- IPv6 is not enabled"" 
   fi 
   [ -z ""$l_output"" ] && l_output=""- IPv6 is enabled"" 
   echo -e ""\n$l_output\n"" 
}",Enable or disable IPv6 in accordance with system requirements and local site policy,"IPv6 is enabled 
References: 
1. NIST SP 800-53 Rev. 5: CM-7 
Additional Information: 
Having more addresses has grown in importance with the expansion of smart devices 
and connectivity. IPv6 provides more than enough globally unique IP addresses for 
every networked device currently on the planet, helping ensure providers can keep pace 
with the expected proliferation of IP-based devices.",
,,,,,"Run the following script to disable any wireless interfaces: 
#!/usr/bin/env bash 
 
{ 
   module_fix() 
   { 
      if ! modprobe -n -v ""$l_mname"" | grep -P -- '^\h*install 
\/bin\/(true|false)'; then 
         echo -e "" - setting module: \""$l_mname\"" to be un-loadable"" 
         echo -e ""install $l_mname /bin/false"" >> 
/etc/modprobe.d/""$l_mname"".conf 
      fi 
      if lsmod | grep ""$l_mname"" > /dev/null 2>&1; then 
         echo -e "" - unloading module \""$l_mname\"""" 
         modprobe -r ""$l_mname"" 
      fi 
      if ! grep -Pq -- ""^\h*blacklist\h+$l_mname\b"" /etc/modprobe.d/*; then 
         echo -e "" - deny listing \""$l_mname\"""" 
         echo -e ""blacklist $l_mname"" >> /etc/modprobe.d/""$l_mname"".conf 
      fi 
   } 
   if [ -n ""$(find /sys/class/net/*/ -type d -name wireless)"" ]; then 
      l_dname=$(for driverdir in $(find /sys/class/net/*/ -type d -name 
wireless | xargs -0 dirname); do basename ""$(readlink -f 
""$driverdir""/device/driver/module)"";done | sort -u) 
      for l_mname in $l_dname; do 
         module_fix 
      done 
   fi 
} 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,"Run the following command to verify the bluez package is not installed: 
# rpm -q bluez 
 
package bluez is not installed 
- OR - 
- IF - the bluez package is required as a dependency: 
Run the following command to verify bluetooth.service is not enabled: 
# systemctl is-enabled bluetooth.service 2>/dev/null | grep 'enabled' 
 
Nothing should be returned 
Run the following command to verify bluetooth.service is not active: 
# systemctl is-active bluetooth.service 2>/dev/null | grep '^active' 
 
Nothing should be returned 
Note: If the package is required for a dependency 
• 
Ensure the dependent package is approved by local site policy 
• 
Ensure stopping and masking the service and/or socket meets local site policy","Run the following commands to stop bluetooth.service, and remove the bluez 
package: 
# systemctl stop bluetooth.service 
# dnf remove bluez 
- OR - 
- IF - the bluez package is required as a dependency: 
Run the following commands to stop and mask bluetooth.service: 
# systemctl stop bluetooth.service 
# systemctl mask bluetooth.service 
Note: A reboot may be required 
References: 
1. NIST SP 800-53 Rev. 5: CM-7",,
,,,,,"Run the following script to unload and disable the dccp module: 
- IF - the dccp kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install dccp /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist dccp in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r dccp 2>/dev/null; rmmod dccp 2>/dev/null to remove 
dccp from the kernel 
- IF - the dccp kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the tipc module: 
- IF - the tipc kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install tipc /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist tipc in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r tipc 2>/dev/null; rmmod tipc 2>/dev/null to remove 
tipc from the kernel 
- IF - the tipc kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the rds module: 
- IF - the rds kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install rds /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist rds in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r rds 2>/dev/null; rmmod rds 2>/dev/null to remove 
rds from the kernel 
- IF - the rds kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Run the following script to unload and disable the sctp module: 
- IF - the sctp kernel module is available in ANY installed kernel: 
• 
Create a file ending in .conf with install sctp /bin/false in the 
/etc/modprobe.d/ directory 
• 
Create a file ending in .conf with blacklist sctp in the /etc/modprobe.d/ 
directory 
• 
Run modprobe -r sctp 2>/dev/null; rmmod sctp 2>/dev/null to remove 
sctp from the kernel 
- IF - the sctp kernel module is not available on the system, or pre-compiled into the 
kernel, no remediation is necessary",,
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.ip_forward = 0 
Example: 
# printf '%s\n' ""net.ipv4.ip_forward = 0"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.ip_forward=0 
   sysctl -w net.ipv4.route.flush=1 
} 
- IF - IPv6 is enabled on the system: 
Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv6.conf.all.forwarding = 0 
Example: 
# printf '%s\n' ""net.ipv6.conf.all.forwarding = 0"" >> /etc/sysctl.d/60-
netipv6_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash  
 
{ 
   sysctl -w net.ipv6.conf.all.forwarding=0 
   sysctl -w net.ipv6.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.ip_forward = 0 
net.ipv6.conf.all.forwarding = 0 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.send_redirects = 0 
• 
net.ipv4.conf.default.send_redirects = 0 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.send_redirects = 0"" 
""net.ipv4.conf.default.send_redirects = 0"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.send_redirects=0 
   sysctl -w net.ipv4.conf.default.send_redirects=0 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.conf.all.send_redirects = 1 
net.ipv4.conf.default.send_redirects = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.icmp_ignore_bogus_error_responses = 1 
Example: 
# printf '%s\n' ""net.ipv4.icmp_ignore_bogus_error_responses = 1"" >> 
/etc/sysctl.d/60-netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.icmp_ignore_bogus_error_responses = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.icmp_echo_ignore_broadcasts = 1 
Example: 
# printf '%s\n' ""net.ipv4.icmp_echo_ignore_broadcasts = 1"" >> 
/etc/sysctl.d/60-netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.conf.default.log_martians = 0 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.accept_redirects = 0 
• 
net.ipv4.conf.default.accept_redirects = 0 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.accept_redirects = 0"" 
""net.ipv4.conf.default.accept_redirects = 0"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.accept_redirects=0 
   sysctl -w net.ipv4.conf.default.accept_redirects=0 
   sysctl -w net.ipv4.route.flush=1 
} 
- IF - IPv6 is enabled on the system: 
Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv6.conf.all.accept_redirects = 0 
• 
net.ipv6.conf.default.accept_redirects = 0 
Example: 
# printf '%s\n' ""net.ipv6.conf.all.accept_redirects = 0"" 
""net.ipv6.conf.default.accept_redirects = 0"" >> /etc/sysctl.d/60-
netipv6_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv6.conf.all.accept_redirects=0 
   sysctl -w net.ipv6.conf.default.accept_redirects=0 
   sysctl -w net.ipv6.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten",,
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.secure_redirects = 0 
• 
net.ipv4.conf.default.secure_redirects = 0 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.secure_redirects = 0"" 
""net.ipv4.conf.default.secure_redirects = 0"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.secure_redirects=0 
   sysctl -w net.ipv4.conf.default.secure_redirects=0 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.conf.all.secure_redirects = 1 
net.ipv4.conf.default.secure_redirects = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.rp_filter = 1 
• 
net.ipv4.conf.default.rp_filter = 1 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.rp_filter = 1"" 
""net.ipv4.conf.default.rp_filter = 1"" >> /etc/sysctl.d/60-netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.rp_filter=1 
   sysctl -w net.ipv4.conf.default.rp_filter=1 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.conf.all.rp_filter = 2 
net.ipv4.conf.default.rp_filter = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.accept_source_route = 0 
• 
net.ipv4.conf.default.accept_source_route = 0 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.accept_source_route = 0"" 
""net.ipv4.conf.default.accept_source_route = 0"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.accept_source_route=0 
   sysctl -w net.ipv4.conf.default.accept_source_route=0 
   sysctl -w net.ipv4.route.flush=1 
} 
- IF - IPv6 is enabled on the system: 
Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv6.conf.all.accept_source_route = 0 
• 
net.ipv6.conf.default.accept_source_route = 0 
Example: 
# printf '%s\n' ""net.ipv6.conf.all.accept_source_route = 0"" 
""net.ipv6.conf.default.accept_source_route = 0"" >> /etc/sysctl.d/60-
netipv6_sysctl.conf 
Run the following command to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv6.conf.all.accept_source_route=0 
   sysctl -w net.ipv6.conf.default.accept_source_route=0 
   sysctl -w net.ipv6.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten",,
,,,,,"Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.conf.all.log_martians = 1 
• 
net.ipv4.conf.default.log_martians = 1 
Example: 
# printf '%s\n' ""net.ipv4.conf.all.log_martians = 1"" 
""net.ipv4.conf.default.log_martians = 1"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.conf.all.log_martians=1 
   sysctl -w net.ipv4.conf.default.log_martians=1 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.conf.all.log_martians = 0 
net.ipv4.conf.default.log_martians = 0 
References: 
1. NIST SP 800-53 Rev. 5: AU-3 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"Set the following parameter in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv4.tcp_syncookies = 1 
Example: 
# printf '%s\n' ""net.ipv4.tcp_syncookies = 1"" >> /etc/sysctl.d/60-
netipv4_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv4.tcp_syncookies=1 
   sysctl -w net.ipv4.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv4.tcp_syncookies = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
,,,,,"- IF - IPv6 is enabled on the system: 
Set the following parameters in /etc/sysctl.conf or a file in /etc/sysctl.d/ ending 
in .conf: 
• 
net.ipv6.conf.all.accept_ra = 0 
• 
net.ipv6.conf.default.accept_ra = 0 
Example: 
# printf '%s\n' ""net.ipv6.conf.all.accept_ra = 0"" 
""net.ipv6.conf.default.accept_ra = 0"" >> /etc/sysctl.d/60-netipv6_sysctl.conf 
Run the following script to set the active kernel parameters: 
#!/usr/bin/env bash 
 
{ 
   sysctl -w net.ipv6.conf.all.accept_ra=0 
   sysctl -w net.ipv6.conf.default.accept_ra=0 
   sysctl -w net.ipv6.route.flush=1 
} 
Note: If these settings appear in a canonically later file, or later in the same file, these 
settings will be overwritten","net.ipv6.conf.all.accept_ra = 1 
net.ipv6.conf.default.accept_ra = 1 
References: 
1. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5 
Additional Information: 
On systems with Uncomplicated Firewall, additional settings may be configured in 
/etc/ufw/sysctl.conf 
• 
The settings in /etc/ufw/sysctl.conf will override settings in 
/etc/sysctl.conf  
• 
This behavior can be changed by updating the IPT_SYSCTL parameter in 
/etc/default/ufw",
4.1.1 Ensure nftables is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","nftables provides a new in-kernel packet classification framework that is based on a 
network-specific Virtual Machine (VM) and a new nft userspace command line tool. 
nftables reuses the existing Netfilter subsystems such as the existing hook 
infrastructure, the connection tracking system, NAT, userspace queuing and logging 
subsystem.","nftables is a subsystem of the Linux kernel that can protect against threats originating 
from within a corporate network to include malicious mobile code and poorly configured 
software on a host. 
Impact: 
Changing firewall settings while connected over the network can result in being locked 
out of the system.","Run the following command to verify that nftables is installed: 
# rpm -q nftables 
 
nftables-<version>","Run the following command to install nftables 
# dnf install nftables 
References: 
1. NIST SP 800-53 Rev. 5: CA-9",,
,,,,,Run the following script to ensure that a single firewall utility is in use on the system:,,
,,,,,"If Firewalld is in use on the system: 
Run the following command to remove an unnecessary service: 
# firewall-cmd --remove-service=<service> 
Example: 
# firewall-cmd --remove-service=cockpit 
Run the following command to remove an unnecessary port: 
# firewall-cmd --remove-port=<port-number>/<port-type> 
Example: 
# firewall-cmd --remove-port=25/tcp 
Run the following command to make new settings persistent: 
# firewall-cmd --runtime-to-permanent 
References: 
1. firewalld.service(5) 
2. NIST SP 800-53 Rev. 5: CA-9 
3. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/9/pdf/configuring_firewalls_and_packet_filters/red_h
at_enterprise_linux-9-configuring_firewalls_and_packet_filters-en-us.pdf 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.4 Implement and Manage a Firewall on Servers 
 
Implement and manage a firewall on servers, where supported. Example 
implementations include a virtual firewall, operating system firewall, or a third-
party firewall agent. 
● 
● 
● 
v7 
9.4 Apply Host-based Firewalls or Port Filtering 
 
Apply host-based firewalls or port filtering tools on end systems, with a 
default-deny rule that drops all traffic except those services and ports that are 
explicitly allowed. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.4 Implement and Manage a Firewall on Servers 
 
Implement and manage a firewall on servers where supported. Example 
implementations include a virtual firewall operating system firewall or a third-
party firewall agent. 
 
 
 
v7 
9.4 Apply Host-based Firewalls or Port Filtering 
 
Apply host-based firewalls or port filtering tools on end systems with a 
default-deny rule that drops all traffic except those services and ports that are 
explicitly allowed. 
 
 
 "
,,,,,"Run the following script to implement the loopback rules: 
#!/usr/bin/env bash 
 
{  l_hbfw="""" 
   if systemctl is-enabled firewalld.service | grep -q 'enabled'; then 
      echo -e ""\n - FirewallD is in use on the system"" && l_hbfw=""fwd"" 
   elif systemctl is-enabled nftables.service 2>/dev/null | grep -q 'enabled'; then 
      echo -e ""\n - nftables is in use on the system \n - Recommendation is NA \n - 
Remediation Complete"" && l_hbfw=""nft"" 
   fi 
   if [ ""$l_hbfw"" = ""fwd"" ]; then    
      l_ipsaddr=""$(nft list ruleset | awk 
'/filter_IN_public_deny|hook\s+input\s+/,/\}\s*(#.*)?$/' | grep -P -- 'ip\h+saddr')"" 
      if ! nft list ruleset | awk '/hook\s+input\s+/,/\}\s*(#.*)?$/' | grep -Pq -- 
'\H+\h+""lo""\h+accept'; then 
         echo -e ""\n - Enabling input to accept for loopback address"" 
         firewall-cmd --permanent --zone=trusted --add-interface=lo 
         firewall-cmd --reload 
      else  
         echo -e ""\n - firewalld input correctly set to accept for loopback address""          
         if ! grep -Pq -- 
'ip\h+saddr\h+127\.0\.0\.0\/8\h+(counter\h+packets\h+\d+\h+bytes\h+\d+\h+)?drop' <<< 
""$l_ipsaddr"" && ! grep -Pq -- 
'ip\h+daddr\h+\!\=\h+127\.0\.0\.1\h+ip\h+saddr\h+127\.0\.0\.1\h+drop' <<< 
""$l_ipsaddr""; then 
            echo -e ""\n - Setting IPv4 network traffic from loopback address to drop"" 
            firewall-cmd --permanent --add-rich-rule='rule family=ipv4 source 
address=""127.0.0.1"" destination not address=""127.0.0.1"" drop' 
            firewall-cmd --permanent --zone=trusted --add-rich-rule='rule family=ipv4 
source address=""127.0.0.1"" destination not address=""127.0.0.1"" drop' 
            firewall-cmd --reload 
         else 
            echo -e ""\n - firewalld correctly set IPv4 network traffic from loopback 
address to drop"" 
         fi 
         if grep -Pq -- '^\h*0\h*$' /sys/module/ipv6/parameters/disable; then 
            l_ip6saddr=""$(nft list ruleset | awk '/filter_IN_public_deny|hook 
input/,/}/' | grep 'ip6 saddr')"" 
            if ! grep -Pq 
'ip6\h+saddr\h+::1\h+(counter\h+packets\h+\d+\h+bytes\h+\d+\h+)?drop' <<< 
""$l_ip6saddr"" && ! grep -Pq -- 'ip6\h+daddr\h+\!=\h+::1\h+ip6\h+saddr\h+::1\h+drop' 
<<< ""$l_ip6saddr""; then 
               echo -e ""\n - Setting IPv6 network traffic from loopback address to 
drop"" 
               firewall-cmd --permanent --add-rich-rule='rule family=ipv6 source 
address=""::1"" destination not address=""::1"" drop' 
               firewall-cmd --permanent --zone=trusted --add-rich-rule='rule 
family=ipv6 source address=""::1"" destination not address=""::1"" drop' 
               firewall-cmd --reload 
            else 
               echo -e ""\n - firewalld correctly set IPv6 network traffic from 
loopback address to drop"" 
         fi 
         fi 
      fi 
   fi 
}",,
,,,,"- IF - NFTables utility is in use on your system: 
Run the following command to verify that base chains exist for the INPUT filter hook: 
# nft list ruleset | grep 'hook input' 
Output should include: 
type filter hook input 
Run the following command to verify that base chains exist for the FORWARD filter hook: 
# nft list ruleset | grep 'hook forward' 
Output should include: 
type filter hook forward 
Run the following command to verify that base chains exist for the OUTPUT filter hook: 
# nft list ruleset | grep 'hook output' 
Output should include: 
type filter hook output 
Note: When using FirewallD the base chains are installed by default","- IF - NFTables utility is in use on your system: 
Run the following command to create the base chains: 
# nft create chain inet <table name> <base chain name> { type filter hook 
<(input|forward|output)> priority 0 \; } 
Example: 
# nft create chain inet filter input { type filter hook input priority 0 \; } 
# nft create chain inet filter forward { type filter hook forward priority 0 
\; } 
# nft create chain inet filter output { type filter hook output priority 0 \; 
} 
Note: use the add command if the create command returns an error due to the chain 
already existing. 
References: 
1. NIST SP 800-53 Rev. 5: CA-9 
2. https://www.netfilter.org/projects/nftables/manpage.html 
3. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/9/pdf/configuring_firewalls_and_packet_filters/red_h
at_enterprise_linux-9-configuring_firewalls_and_packet_filters-en-us.pdf",,
,,,,,"- IF - NFTables utility is in use on your system: 
Configure nftables in accordance with site policy. The following commands will 
implement a policy to allow all established connections: 
# systemctl is-enabled nftables.service | grep -q 'enabled' && nft add rule 
inet filter input ip protocol tcp ct state established accept 
# systemctl is-enabled nftables.service | grep -q 'enabled' && nft add rule 
inet filter input ip protocol udp ct state established accept 
# systemctl is-enabled nftables.service | grep -q 'enabled' && nft add rule 
inet filter input ip protocol icmp ct state established accept 
References: 
1. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/9/pdf/configuring_firewalls_and_packet_filters/red_h
at_enterprise_linux-9-configuring_firewalls_and_packet_filters-en-us.pdf 
2. NIST SP 800-53 Rev. 5: CA-9 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.4 Implement and Manage a Firewall on Servers 
 
Implement and manage a firewall on servers, where supported. Example 
implementations include a virtual firewall, operating system firewall, or a third-
party firewall agent. 
● 
● 
● 
v7 
9.4 Apply Host-based Firewalls or Port Filtering 
 
Apply host-based firewalls or port filtering tools on end systems, with a 
default-deny rule that drops all traffic except those services and ports that are 
explicitly allowed. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.4 Implement and Manage a Firewall on Servers 
 
Implement and manage a firewall on servers where supported. Example 
implementations include a virtual firewall operating system firewall or a third-
party firewall agent. 
 
 
 
v7 
9.4 Apply Host-based Firewalls or Port Filtering 
 
Apply host-based firewalls or port filtering tools on end systems with a 
default-deny rule that drops all traffic except those services and ports that are 
explicitly allowed. 
 
 
 "
,,,,,"- IF - NFTables utility is in use on your system: 
Run the following command for the base chains with the input, forward, and output 
hooks to implement a default DROP policy: 
# nft chain <table family> <table name> <chain name> { policy drop \; } 
Example: 
# nft chain inet filter input { policy drop \; } 
# nft chain inet filter forward { policy drop \; }","accept 
References: 
1. Manual Page nft 
2. NIST SP 800-53 Rev. 5: CA-9 
3. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/9/pdf/configuring_firewalls_and_packet_filters/red_h
at_enterprise_linux-9-configuring_firewalls_and_packet_filters-en-us.pdf","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.4 Implement and Manage a Firewall on Servers 
 
Implement and manage a firewall on servers where supported. Example 
implementations include a virtual firewall operating system firewall or a third-
party firewall agent. 
 
 
 
v7 
9.4 Apply Host-based Firewalls or Port Filtering 
 
Apply host-based firewalls or port filtering tools on end systems with a 
default-deny rule that drops all traffic except those services and ports that are 
explicitly allowed. 
 
 
 "
,,,,,"Run the following script to implement the loopback rules: 
#!/usr/bin/env bash 
 
{    l_hbfw="""" 
     if systemctl is-enabled firewalld.service 2>/dev/null | grep -q 
'enabled'; then 
         echo -e ""\n - FirewallD is in use on the system\n - Recommendation 
is NA \n - Remediation Complete"" && l_hbfw=""fwd"" 
    elif systemctl is-enabled nftables.service | grep -q 'enabled'; then 
         l_hbfw=""nft"" 
      fi 
      if [ ""$l_hbfw"" = ""nft"" ]; then  
         l_ipsaddr=""$(nft list ruleset | awk 
'/filter_IN_public_deny|hook\s+input\s+/,/\}\s*(#.*)?$/' | grep -P -- 
'ip\h+saddr')"" 
         if ! nft list ruleset | awk '/hook\s+input\s+/,/\}\s*(#.*)?$/' | 
grep -Pq -- '\H+\h+""lo""\h+accept'; then 
            echo -e ""\n - Enabling input to accept for loopback address"" 
            nft add rule inet filter input iif lo accept 
         else 
            echo -e ""\n -nftables input correctly configured to accept for 
loopback address""   
         fi 
         if ! grep -Pq -- 
'ip\h+saddr\h+127\.0\.0\.0\/8\h+(counter\h+packets\h+\d+\h+bytes\h+\d+\h+)?dr
op' <<< ""$l_ipsaddr"" && ! grep -Pq -- 
'ip\h+daddr\h+\!\=\h+127\.0\.0\.1\h+ip\h+saddr\h+127\.0\.0\.1\h+drop' <<< 
""$l_ipsaddr""; then 
            echo -e ""\n - Setting IPv4 network traffic from loopback address 
to drop"" 
            nft add rule inet filter input ip saddr 127.0.0.0/8 counter drop 
         else 
            echo -e ""\n -nftables correctly configured IPv4 network traffic 
from loopback address to drop"" 
         fi 
         if grep -Pq -- '^\h*0\h*$' /sys/module/ipv6/parameters/disable; then 
            l_ip6saddr=""$(nft list ruleset | awk '/filter_IN_public_deny|hook 
input/,/}/' | grep 'ip6 saddr')"" 
            if ! grep -Pq 
'ip6\h+saddr\h+::1\h+(counter\h+packets\h+\d+\h+bytes\h+\d+\h+)?drop' <<< 
""$l_ip6saddr"" && ! grep -Pq -- 
'ip6\h+daddr\h+\!=\h+::1\h+ip6\h+saddr\h+::1\h+drop' <<< ""$l_ip6saddr""; then 
               echo -e ""\n - Setting IPv6 network traffic from loopback 
address to drop""         
               nft add rule inet filter input ip6 saddr ::1 counter drop 
            else  
               echo -e ""\n - nftables IPv6 network traffic from loopback 
address to drop""    
         fi 
         fi 
      fi 
}",,
,,,,,"Run the following script to set ownership and permissions on /etc/ssh/sshd_config 
and files ending in .conf in the /etc/ssh/sshd_config.d directory: 
#!/usr/bin/env bash 
 
{ 
   chmod u-x,og-rwx /etc/ssh/sshd_config 
   chown root:root /etc/ssh/sshd_config 
   while IFS= read -r -d $'\0' l_file; do 
      if [ -e ""$l_file"" ]; then 
         chmod u-x,og-rwx ""$l_file"" 
         chown root:root ""$l_file"" 
      fi 
   done < <(find /etc/ssh/sshd_config.d -type f -print0 2>/dev/null) 
} 
- IF - other locations are listed in an Include statement, *.conf files in these locations 
access should also be modified. 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1098, T1098.004, T1543, 
T1543.002 
TA0005 
M1022",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1098 T1098.004 T1543 
T1543.002 
TA0005 
M1022"
,,,,,"Run the following script to set mode, ownership, and group on the private SSH host key 
files: 
{ 
   l_output="""" l_output2="""" 
   l_ssh_group_name=""$(awk -F: '($1 ~ /^(ssh_keys|_?ssh)$/) {print $1}' /etc/group)"" 
   f_file_access_fix() 
   { 
      while IFS=: read -r l_file_mode l_file_owner l_file_group; do 
         echo ""File: \""$l_file\"" mode: \""$l_file_mode\"" owner \""$l_file_owner\"" group 
\""$l_file_group\"""" 
         l_out2="""" 
         [ ""$l_file_group"" = ""$l_ssh_group_name"" ] && l_pmask=""0137"" || l_pmask=""0177"" 
         l_maxperm=""$( printf '%o' $(( 0777 & ~$l_pmask )) )"" 
         if [ $(( $l_file_mode & $l_pmask )) -gt 0 ]; then 
            l_out2=""$l_out2\n  - Mode: \""$l_file_mode\"" should be mode: \""$l_maxperm\"" 
or more restrictive\n   - updating to mode: \:$l_maxperm\"""" 
            if [ ""l_file_group"" = ""$l_ssh_group_name"" ]; then 
               chmod u-x,g-wx,o-rwx ""$l_file"" 
            else 
               chmod u-x,go-rwx ""$l_file"" 
            fi 
         fi 
         if [ ""$l_file_owner"" != ""root"" ]; then 
            l_out2=""$l_out2\n  - Owned by: \""$l_file_owner\"" should be owned by 
\""root\""\n   - Changing ownership to \""root\"""" 
            chown root ""$l_file"" 
         fi 
         if [[ ! ""$l_file_group"" =~ ($l_ssh_group_name|root) ]]; then 
            [ -n ""$l_ssh_group_name"" ] && l_new_group=""$l_ssh_group_name"" || 
l_new_group=""root"" 
            l_out2=""$l_out2\n  - Owned by group \""$l_file_group\"" should be group 
owned by: \""$l_ssh_group_name\"" or \""root\""\n   - Changing group ownership to 
\""$l_new_group\"""" 
            chgrp ""$l_new_group"" ""$l_file"" 
         fi 
         if [ -n ""$l_out2"" ]; then 
            l_output2=""$l_output2\n - File: \""$l_file\""$l_out2"" 
         else 
            l_output=""$l_output\n - File: \""$l_file\""\n  - Correct: mode: 
\""$l_file_mode\"", owner: \""$l_file_owner\"", and group owner: \""$l_file_group\"" 
configured"" 
         fi 
      done < <(stat -Lc '%#a:%U:%G' ""$l_file"") 
   } 
   while IFS= read -r -d $'\0' l_file; do  
      if ssh-keygen -lf &>/dev/null ""$l_file""; then  
         file ""$l_file"" | grep -Piq -- '\bopenssh\h+([^#\n\r]+\h+)?private\h+key\b' && 
f_file_access_fix 
      fi 
   done < <(find -L /etc/ssh -xdev -type f -print0 2>/dev/null) 
   if [ -z ""$l_output2"" ]; then 
      echo -e ""\n- No access changes required\n"" 
   else 
      echo -e ""\n- Remediation results:\n$l_output2\n"" 
   fi 
}",,
,,,,,"Run the following script to set mode, ownership, and group on the public SSH host key 
files: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" 
   l_pmask=""0133"" && l_maxperm=""$( printf '%o' $(( 0777 & ~$l_pmask )) )"" 
   FILE_ACCESS_FIX() 
   { 
      while IFS=: read -r l_file_mode l_file_owner l_file_group; do 
         l_out2="""" 
         if [ $(( $l_file_mode & $l_pmask )) -gt 0 ]; then 
            l_out2=""$l_out2\n  - Mode: \""$l_file_mode\"" should be mode: 
\""$l_maxperm\"" or more restrictive\n   - updating to mode: \:$l_maxperm\"""" 
            chmod u-x,go-wx 
         fi 
         if [ ""$l_file_owner"" != ""root"" ]; then 
            l_out2=""$l_out2\n  - Owned by: \""$l_file_owner\"" should be owned 
by \""root\""\n   - Changing ownership to \""root\"""" 
            chown root ""$l_file"" 
         fi 
         if [ ""$l_file_group"" != ""root"" ]; then 
            l_out2=""$l_out2\n  - Owned by group \""$l_file_group\"" should be 
group owned by: \""root\""\n   - Changing group ownership to \""root\"""" 
            chgrp root ""$l_file"" 
         fi 
         if [ -n ""$l_out2"" ]; then 
            l_output2=""$l_output2\n - File: \""$l_file\""$l_out2"" 
         else 
            l_output=""$l_output\n - File: \""$l_file\""\n  - Correct: mode: 
\""$l_file_mode\"", owner: \""$l_file_owner\"", and group owner: 
\""$l_file_group\"" configured"" 
         fi 
      done < <(stat -Lc '%#a:%U:%G' ""$l_file"") 
   } 
   while IFS= read -r -d $'\0' l_file; do  
      if ssh-keygen -lf &>/dev/null ""$l_file""; then  
         file ""$l_file"" | grep -Piq -- 
'\bopenssh\h+([^#\n\r]+\h+)?public\h+key\b' && FILE_ACCESS_FIX 
      fi 
   done < <(find -L /etc/ssh -xdev -type f -print0 2>/dev/null) 
   if [ -z ""$l_output2"" ]; then 
      echo -e ""\n- No access changes required\n"" 
   else 
      echo -e ""\n- Remediation results:\n$l_output2\n"" 
   fi 
}",644 0/root 0/root,
,,,,"Run the following command to verify none of the ""weak"" ciphers are being used: 
# sshd -T | grep -Pi -- 
'^ciphers\h+\""?([^#\n\r]+,)?((3des|blowfish|cast128|aes(128|192|256))-
cbc|arcfour(128|256)?|rijndael-cbc@lysator\.liu\.se|chacha20-
poly1305@openssh\.com)\b' 
- IF - a line is returned, review the list of ciphers. If the line includes chacha20-
poly1305@openssh.com, review CVE-2023-48795 and verify the system has been 
patched. No ciphers in the list below should be returned as they're considered ""weak"": 
3des-cbc 
aes128-cbc 
aes192-cbc 
aes256-cbc","Note: 
• 
First occurrence of an option takes precedence. 
• 
Though ciphers may be configured through the Ciphers option in the 
/etc/ssh/sshd_config file, it is recommended that the ciphers available to 
openSSH server are configured through system-wide-crypto-policy 
• 
If the recommendations in the subsection ""Configure system wide crypto policy"" 
have been followed, this Audit should be in a passing state. Please review that 
section before following this Remediation Procedure 
• 
By default, system-wide-crypto-policy is applied to the openSSH server. If the 
following defaults don't exist due to modifications or upgrade from a earlier 
release, the system-wide-crypto-policy may not be included by the openSSH 
server. It is recommended that these defaults be restored, created, or the line 
Include /etc/crypto-policies/back-ends/opensshserver.config be 
added before any lines containing the Cipher argument. 
• 
Defaults: 
o The file /etc/ssh/sshd_config includes the line: Include 
/etc/ssh/sshd_config.d/*.conf. This line must appear before any 
lines containing the Cipher argument 
o This directory /etc/ssh/sshd_config.d/ includes a file 
/etc/ssh/sshd_config.d/50-redhat.conf 
o The file /etc/ssh/sshd_config.d/50-redhat.conf includes the line 
Include /etc/crypto-policies/back-ends/opensshserver.config 
o The file /etc/crypto-policies/back-ends/opensshserver.config is 
generated by system-wide-crypto-policy",,
,,,,"Run the following command to verify none of the ""weak"" Key Exchange algorithms are 
being used: 
# sshd -T | grep -Pi -- 'kexalgorithms\h+([^#\n\r]+,)?(diffie-hellman-group1-
sha1|diffie-hellman-group14-sha1|diffie-hellman-group-exchange-sha1)\b' 
 
Nothing should be returned 
The following are considered ""weak"" Key Exchange Algorithms, and should not be 
used: 
diffie-hellman-group1-sha1 
diffie-hellman-group14-sha1 
diffie-hellman-group-exchange-sha1","Note: 
• 
First occurrence of an option takes precedence. 
• 
Though key_exchange may be configured through the KexAlgorithms option in 
the /etc/ssh/sshd_config file, it is recommended that the key_exchange 
available to openSSH server are configured through system-wide-crypto-policy 
• 
If the recommendations in the subsection ""Configure system wide crypto policy"" 
have been followed, this Audit should be in a passing state. Please review that 
section before following this Remediation Procedure 
• 
By default, system-wide-crypto-policy is applied to the openSSH server. If the 
following defaults don't exist due to modifications or upgrade from a earlier 
release, the system-wide-crypto-policy may not be included by the openSSH 
server. It is recommended that these defaults be restored, created, or the line 
Include /etc/crypto-policies/back-ends/opensshserver.config be 
added before any lines containing the KexAlgorithms argument. 
• 
Defaults: 
o The file /etc/ssh/sshd_config includes the line: Include 
/etc/ssh/sshd_config.d/*.conf. This line must appear before any 
lines containing the KexAlgorithms argument 
o This directory /etc/ssh/sshd_config.d/ includes a file 
/etc/ssh/sshd_config.d/50-redhat.conf 
o The file /etc/ssh/sshd_config.d/50-redhat.conf includes the line 
Include /etc/crypto-policies/back-ends/opensshserver.config 
o The file /etc/crypto-policies/back-ends/opensshserver.config is 
generated by system-wide-crypto-policy",,
,,,,"Run the following command to verify none of the ""weak"" MACs are being used: 
# sshd -T | grep -Pi -- 'macs\h+([^#\n\r]+,)?(hmac-md5|hmac-md5-96|hmac-
ripemd160|hmac-sha1-96|umac-64@openssh\.com|hmac-md5-etm@openssh\.com|hmac-
md5-96-etm@openssh\.com|hmac-ripemd160-etm@openssh\.com|hmac-sha1-96-
etm@openssh\.com|umac-64-etm@openssh\.com|umac-128-etm@openssh\.com)\b' 
 
Nothing should be returned 
Note: Review CVE-2023-48795 and verify the system has been patched. If the system 
has not been patched, review the use of the Encrypt Then Mac (etm) MACs. 
The following are considered ""weak"" MACs, and should not be used: 
hmac-md5 
hmac-md5-96 
hmac-sha1-96 
umac-64@openssh.com 
hmac-md5-etm@openssh.com 
hmac-md5-96-etm@openssh.com 
hmac-sha1-96-etm@openssh.com 
umac-64-etm@openssh.com 
umac-128-etm@openssh.com","Note: 
• 
First occurrence of an option takes precedence. 
• 
Though MACs may be configured through the MACs option in the 
/etc/ssh/sshd_config file, it is recommended that the MACs available to 
openSSH server are configured through system-wide-crypto-policy 
• 
If the recommendations in the subsection ""Configure system wide crypto policy"" 
have been followed, this Audit should be in a passing state. Please review that 
section before following this Remediation Procedure 
• 
By default, system-wide-crypto-policy is applied to the openSSH server. If the 
following defaults don't exist due to modifications or upgrade from a earlier 
release, the system-wide-crypto-policy may not be included by the openSSH 
server. It is recommended that these defaults be restored, created, or the line 
Include /etc/crypto-policies/back-ends/opensshserver.config be 
added before any lines containing the MACs argument. 
• 
Defaults: 
o The file /etc/ssh/sshd_config includes the line: Include 
/etc/ssh/sshd_config.d/*.conf. This line must appear before any 
lines containing the MACs argument 
o This directory /etc/ssh/sshd_config.d/ includes a file 
/etc/ssh/sshd_config.d/50-redhat.conf 
o The file /etc/ssh/sshd_config.d/50-redhat.conf includes the line 
Include /etc/crypto-policies/back-ends/opensshserver.config 
o The file /etc/crypto-policies/back-ends/opensshserver.config is 
generated by system-wide-crypto-policy",,
,,,,"Run the following command and verify the output: 
# sshd -T | grep -Pi -- '^\h*(allow|deny)(users|groups)\h+\H+' 
Verify that the output matches at least one of the following lines: 
allowusers <userlist> 
-OR- 
allowgroups <grouplist> 
-OR- 
denyusers <userlist> 
-OR- 
denygroups <grouplist> 
Review the list(s) to ensure included users and/or groups follow local site policy 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep -Pi -- 
'^\h*(allow|deny)(users|groups)\h+\H+' 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain).","Edit the /etc/ssh/sshd_config file to set one or more of the parameters above any 
Include and Match set statements as follows: 
AllowUsers <userlist> 
 - AND/OR - 
AllowGroups <grouplist> 
Note: 
• 
First occurrence of a option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a .conf file in a 
Include directory. 
• 
 
Be advised that these options are ""ANDed"" together. If both AllowUsers and 
AllowGroups are set, connections will be limited to the list of users that are also 
a member of an allowed group. It is recommended that only one be set for clarity 
and ease of administration. 
• 
It is easier to manage an allow list than a deny list. In a deny list, you could 
potentially add a user or group and forget to add it to the deny list.",,
,,,,,"Edit the /etc/ssh/sshd_config file to set the Banner parameter above any Include 
and Match entries as follows: 
Banner /etc/issue.net 
Note: First occurrence of a option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location. 
Edit the file being called by the Banner argument with the appropriate contents 
according to your site policy, remove any instances of \m , \r , \s , \v or references to 
the OS platform 
Example: 
# printf '%s\n' ""Authorized users only. All activity may be monitored and 
reported."" > ""$(sshd -T | awk '$1 == ""banner"" {print $2}')"" 
References: 
1. SSHD(8) 
2. SSHD_CONFIG(5) 
3. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
 
TA0001, TA0007 
M1035",,
,,,"In order to prevent resource exhaustion, appropriate values should be set for both 
ClientAliveInterval and ClientAliveCountMax. Specifically, looking at the source 
code, ClientAliveCountMax must be greater than zero in order to utilize the ability of 
SSH to drop idle connections. If connections are allowed to stay open indefinitely, this 
can potentially be used as a DDOS attack or simple resource exhaustion could occur 
over unreliable networks. 
The example set here is a 45 second timeout. Consult your site policy for network 
timeouts and apply as appropriate.","Run the following command and verify ClientAliveInterval and 
ClientAliveCountMax are greater than zero: 
# sshd -T | grep -Pi -- '(clientaliveinterval|clientalivecountmax)' 
Example Output: 
clientaliveinterval 15 
clientalivecountmax 3 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep -Pi -- 
'(clientaliveinterval|clientalivecountmax)' 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain).","Edit the /etc/ssh/sshd_config file to set the ClientAliveInterval and 
ClientAliveCountMax parameters above any Include and Match entries according to 
site policy. 
Example: 
ClientAliveInterval 15 
ClientAliveCountMax 3 
Note: First occurrence of a option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",,
,,,,"Run the following command to verify DisableForwarding is set to yes: 
# sshd -T | grep -i disableforwarding 
 
disableforwarding yes","Edit the /etc/ssh/sshd_config file to set the DisableForwarding parameter to yes 
above any Include entry as follows: 
DisableForwarding yes 
Note: First occurrence of a option takes precedence. If Include locations are enabled, 
used, and order of precedence is understood in your environment, the entry may be 
created in a file in Include location. 
References: 
1. sshd_config(5) 
2. SSHD(8) 
3. NIST SP 800-53 Rev. 5: CM-7 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 "
"5.1.11 Ensure sshd GSSAPIAuthentication is disabled 
(Automated)"," Level 1 - Workstation 
 Level 2 - Server","The GSSAPIAuthentication parameter specifies whether user authentication based on 
GSSAPI is allowed","Allowing GSSAPI authentication through SSH exposes the system's GSSAPI to remote 
hosts, and should be disabled to reduce the attack surface of the system","Run the following command to verify GSSAPIAuthentication is set to no: 
# sshd -T | grep gssapiauthentication 
 
gssapiauthentication no 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep gssapiauthentication 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain)","Edit the /etc/ssh/sshd_config file to set the GSSAPIAuthentication parameter to 
no above any Include and Match entries as follows: 
GSSAPIAuthentication no 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",,
,,,,,"Edit the /etc/ssh/sshd_config file to set the HostbasedAuthentication parameter 
to no above any Include and Match entries as follows: 
HostbasedAuthentication no 
Note: First occurrence of a option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.","HostbasedAuthentication no 
References: 
1. SSHD_CONFIG(5) 
2. SSHD(8) 
3. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1078, T1078.001, 
T1078.003 
TA0001 
M1042",
5.1.13 Ensure sshd IgnoreRhosts is enabled (Automated)," Level 1 - Server 
 Level 1 - Workstation","The IgnoreRhosts parameter specifies that .rhosts and .shosts files will not be used 
in RhostsRSAAuthentication or HostbasedAuthentication.",Setting this parameter forces users to enter a password when authenticating with SSH.,"Run the following command to verify IgnoreRhosts is set to yes: 
# sshd -T | grep ignorerhosts 
 
ignorerhosts yes 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep ignorerhosts 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain)","Edit the /etc/ssh/sshd_config file to set the IgnoreRhosts parameter to yes above 
any Include and Match entries as follows: 
IgnoreRhosts yes 
Note: First occurrence of a option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",IgnoreRhosts yes,
5.1.14 Ensure sshd LoginGraceTime is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The LoginGraceTime parameter specifies the time allowed for successful 
authentication to the SSH server. The longer the Grace period is the more open 
unauthenticated connections can exist. Like other session controls in this session the 
Grace Period should be limited to appropriate organizational limits to ensure the service 
is available for needed access.","Setting the LoginGraceTime parameter to a low number will minimize the risk of 
successful brute force attacks to the SSH server. It will also limit the number of 
concurrent unauthenticated connections While the recommended setting is 60 seconds 
(1 Minute), set the number based on site policy.","Run the following command and verify that output LoginGraceTime is between 1 and 
60 seconds: 
# sshd -T | grep logingracetime 
 
logingracetime 60","Edit the /etc/ssh/sshd_config file to set the LoginGraceTime parameter to 60 
seconds or less above any Include entry as follows: 
LoginGraceTime 60 
Note: First occurrence of a option takes precedence. If Include locations are enabled, 
used, and order of precedence is understood in your environment, the entry may be 
created in a file in Include location.",LoginGraceTime 120,
,,,,,"Edit the /etc/ssh/sshd_config file to set the LogLevel parameter to VERBOSE or 
INFO above any Include and Match entries as follows: 
LogLevel VERBOSE 
   - OR - 
LogLevel INFO 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.","LogLevel INFO 
References: 
1. https://www.ssh.com/ssh/sshd_config/ 
2. NIST SP 800-53 Rev. 5: AU-3, AU-12, SI-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1562 T1562.006 
TA0005"
5.1.16 Ensure sshd MaxAuthTries is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The MaxAuthTries parameter specifies the maximum number of authentication 
attempts permitted per connection. When the login failure count reaches half the 
number, error messages will be written to the syslog file detailing the login failure.","Setting the MaxAuthTries parameter to a low number will minimize the risk of 
successful brute force attacks to the SSH server. While the recommended setting is 4, 
set the number based on site policy.","Run the following command and verify that MaxAuthTries is 4 or less: 
# sshd -T | grep maxauthtries 
 
maxauthtries 4 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep maxauthtries 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain)","Edit the /etc/ssh/sshd_config file to set the MaxAuthTries parameter to 4 or less 
above any Include and Match entries as follows: 
MaxAuthTries 4 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",,
5.1.17 Ensure sshd MaxStartups is configured (Automated)," Level 1 - Server 
 Level 1 - Workstation","The MaxStartups parameter specifies the maximum number of concurrent 
unauthenticated connections to the SSH daemon.","To protect a system from denial of service due to a large number of pending 
authentication connection attempts, use the rate limiting function of MaxStartups to 
protect availability of sshd logins and prevent overwhelming the daemon.","Run the following command to verify MaxStartups is 10:30:60 or more restrictive: 
# sshd -T | awk '$1 ~ /^\s*maxstartups/{split($2, a, "":"");{if(a[1] > 10 || 
a[2] > 30 || a[3] > 60) print $0}}' 
Nothing should be returned","Edit the /etc/ssh/sshd_config file to set the MaxStartups parameter to 10:30:60 or 
more restrictive above any Include entries as follows: 
MaxStartups 10:30:60 
Note: First occurrence of a option takes precedence. If Include locations are enabled, 
used, and order of precedence is understood in your environment, the entry may be 
created in a file in Include location.","MaxStartups 10:30:100 
References: 
1. SSHD_CONFIG(5) 
2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",
,,,,,"Edit the /etc/ssh/sshd_config file to set the MaxSessions parameter to 10 or less 
above any Include and Match entries as follows: 
MaxSessions 10 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.","MaxSessions 10 
References: 
1. SSHD_CONFIG(5) 
2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1499, T1499.002 
TA0040",
"5.1.19 Ensure sshd PermitEmptyPasswords is disabled 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The PermitEmptyPasswords parameter specifies if the SSH server allows login to 
accounts with empty password strings.","Disallowing remote shell access to accounts that have an empty password reduces the 
probability of unauthorized access to the system.","Run the following command to verify PermitEmptyPasswords is set to no: 
# sshd -T | grep permitemptypasswords 
 
permitemptypasswords no 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep permitemptypasswords 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain)","Edit /etc/ssh/sshd_config and set the PermitEmptyPasswords parameter to no 
above any Include and Match entries as follows: 
PermitEmptyPasswords no 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",,
5.1.20 Ensure sshd PermitRootLogin is disabled (Automated)," Level 1 - Server 
 Level 1 - Workstation","The PermitRootLogin parameter specifies if the root user can log in using SSH. The 
default is prohibit-password.","Disallowing root logins over SSH requires system admins to authenticate using their 
own individual account, then escalating to root. This limits opportunity for non-
repudiation and provides a clear audit trail in the event of a security incident.","Run the following command to verify PermitRootLogin is set to no: 
# sshd -T | grep permitrootlogin 
 
permitrootlogin no 
- IF - Match set statements are used in your environment, specify the connection 
parameters to use for the -T extended test mode and run the audit to verify the setting 
is not incorrectly configured in a match block 
Example additional audit needed for a match block for the user sshuser: 
# sshd -T -C user=sshuser | grep permitrootlogin 
Note: If provided, any Match directives in the configuration file that would apply are 
applied before the configuration is written to standard output. The connection 
parameters are supplied as keyword=value pairs and may be supplied in any order, 
either with multiple -C options or as a comma-separated list. The keywords are addr 
(source address), user (user), host (resolved source host name), laddr (local 
address), lport (local port number), and rdomain (routing domain)","Edit the /etc/ssh/sshd_config file to set the PermitRootLogin parameter to no 
above any Include and Match entries as follows: 
PermitRootLogin no 
Note: First occurrence of an option takes precedence, Match set statements 
withstanding. If Include locations are enabled, used, and order of precedence is 
understood in your environment, the entry may be created in a file in Include location.",,
"5.1.21 Ensure sshd PermitUserEnvironment is disabled 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The PermitUserEnvironment option allows users to present environment options to 
the SSH daemon.","Permitting users the ability to set environment variables through the SSH daemon could 
potentially allow users to bypass security controls (e.g. setting an execution path that 
has SSH executing trojan'd programs)","Run the following command to verify PermitUserEnviroment is set to no: 
# sshd -T | grep permituserenvironment 
 
permituserenvironment no","Edit the /etc/ssh/sshd_config file to set the PermitUserEnvironment parameter to 
no above any Include entries as follows: 
PermitUserEnvironment no 
Note: First occurrence of an option takes precedence. If Include locations are enabled, 
used, and order of precedence is understood in your environment, the entry may be 
created in a file in Include location.","PermitUserEnvironment no 
References: 
1. SSHD_CONFIG(5) 
2. NIST SP 800-53 Rev. 5: CM-1,CM-2, CM-6, CM-7, IA-5 
3. SSHD(8)",
5.1.22 Ensure sshd UsePAM is enabled (Automated)," Level 1 - Server 
 Level 1 - Workstation","The UsePAM directive enables the Pluggable Authentication Module (PAM) interface. If 
set to yes this will enable PAM authentication using 
ChallengeResponseAuthentication and PasswordAuthentication directives in 
addition to PAM account and session module processing for all authentication types.","When usePAM is set to yes, PAM runs through account and session types properly. This 
is important if you want to restrict access to services based off of IP, time or other 
factors of the account. Additionally, you can make sure users inherit certain 
environment variables on login or disallow access to the server","Run the following command to verify UsePAM is set to yes: 
# sshd -T | grep -i usepam 
 
usepam yes","Edit the /etc/ssh/sshd_config file to set the UsePAM parameter to yes above any 
Include entries as follows: 
UsePAM yes 
Note: First occurrence of an option takes precedence. If Include locations are enabled, 
used, and order of precedence is understood in your environment, the entry may be 
created in a file in Include location.","UsePAM yes 
References: 
1. SSHD_CONFIG(5) 
2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
3. SSHD(8)",
5.2.1 Ensure sudo is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","sudo allows a permitted user to execute a command as the superuser or another user, 
as specified by the security policy. The invoking user's real (not effective) user ID is 
used to determine the user name with which to query the security policy.","sudo supports a plug-in architecture for security policies and input/output logging. Third 
parties can develop and distribute their own policy and I/O logging plug-ins to work 
seamlessly with the sudo front end. The default security policy is sudoers, which is 
configured via the file /etc/sudoers and any entries in /etc/sudoers.d. 
The security policy determines what privileges, if any, a user has to run sudo. The policy 
may require that users authenticate themselves with a password or another 
authentication mechanism. If authentication is required, sudo will exit if the user's 
password is not entered within a configurable time limit. This limit is policy-specific.","Verify that sudo is installed. 
Run the following command: 
# dnf list sudo 
 
Installed Packages 
sudo.x86_64            <VERSION>        @anaconda 
Available Packages 
sudo.x86_64            <VERSION>        updates","Run the following command to install sudo 
# dnf install sudo 
References: 
1. SUDO(8) 
2. NIST SP 800-53 Rev. 5: AC-6(2), AC-6(5)",,
,,,,,"Edit the file /etc/sudoers with visudo or a file in /etc/sudoers.d/ with visudo -f 
<PATH TO FILE> and add the following line: 
Defaults use_pty 
Edit the file /etc/sudoers with visudo and any files in /etc/sudoers.d/ with visudo 
-f <PATH TO FILE> and remove any occurrence of !use_pty 
Note: 
• 
sudo will read each file in /etc/sudoers.d, skipping file names that end in ~ or 
contain a . character to avoid causing problems with package manager or editor 
temporary/backup files. 
• 
Files are parsed in sorted lexical order. That is, /etc/sudoers.d/01_first will 
be parsed before /etc/sudoers.d/10_second. 
• 
Be aware that because the sorting is lexical, not numeric, 
/etc/sudoers.d/1_whoops would be loaded after 
/etc/sudoers.d/10_second. 
• 
Using a consistent number of leading zeroes in the file names can be used to 
avoid such problems. 
References: 
1. SUDO(8) 
2. VISUDO(8) 
3. sudoers(5) 
4. NIST SP 800-53 Rev. 5: AC-6 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.4 Restrict Administrator Privileges to Dedicated 
Administrator Accounts 
 
Restrict administrator privileges to dedicated administrator accounts on 
enterprise assets. Conduct general computing activities, such as internet 
browsing, email, and productivity suite use, from the user’s primary, non-privileged 
account. 
● 
● 
● 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented, standard security configuration standards for all 
authorized operating systems and software. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.4 Restrict Administrator Privileges to Dedicated 
Administrator Accounts 
 
Restrict administrator privileges to dedicated administrator accounts on 
enterprise assets. Conduct general computing activities such as internet 
browsing email and productivity suite use from the user s primary non-privileged 
account. 
 
 
 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented standard security configuration standards for all 
authorized operating systems and software. 
 
 
 "
,,,,,"Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo -f <PATH TO 
FILE> and add the following line: 
Defaults  logfile=""<PATH TO CUSTOM LOG FILE>"" 
Example 
Defaults logfile=""/var/log/sudo.log"" 
Notes: 
• 
sudo will read each file in /etc/sudoers.d, skipping file names that end in ~ or 
contain a . character to avoid causing problems with package manager or editor 
temporary/backup files. 
• 
Files are parsed in sorted lexical order. That is, /etc/sudoers.d/01_first will 
be parsed before /etc/sudoers.d/10_second. 
• 
Be aware that because the sorting is lexical, not numeric, 
/etc/sudoers.d/1_whoops would be loaded after 
/etc/sudoers.d/10_second. 
• 
Using a consistent number of leading zeroes in the file names can be used to 
avoid such problems. 
References: 
1. SUDO(8) 
2. VISUDO(8) 
3. sudoers(5) 
4. NIST SP 800-53 Rev. 5: AU-3, AU-12 
Additional Information: 
visudo edits the sudoers file in a safe fashion, analogous to vipw(8). visudo locks the 
sudoers file against multiple simultaneous edits, provides basic sanity checks, and 
checks for parse errors. If the sudoers file is currently being edited you will receive a 
message to try again later.",,
"5.2.4 Ensure users must provide password for escalation 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation","The operating system must be configured so that users must provide a password for 
privilege escalation.","Without re-authentication, users may access resources or perform tasks for which they 
do not have authorization. 
When operating systems provide the capability to escalate a functional capability, it is 
critical the user re-authenticate. 
Impact: 
This will prevent automated processes from being able to elevate privileges.","Note: If passwords are not being used for authentication, this is not applicable. 
Verify the operating system requires users to supply a password for privilege escalation. 
Check the configuration of the /etc/sudoers and /etc/sudoers.d/* files with the 
following command: 
# grep -r ""^[^#].*NOPASSWD"" /etc/sudoers* 
If any line is found refer to the remediation procedure below.","Based on the outcome of the audit procedure, use visudo -f <PATH TO FILE> to edit 
the relevant sudoers file. 
Remove any line with occurrences of NOPASSWD tags in the file. 
References: 
1. NIST SP 800-53 Rev. 5: AC-6",,
"5.2.5 Ensure re-authentication for privilege escalation is not 
disabled globally (Automated)"," Level 1 - Server 
 Level 1 - Workstation","The operating system must be configured so that users must re-authenticate for 
privilege escalation.","Without re-authentication, users may access resources or perform tasks for which they 
do not have authorization. 
When operating systems provide the capability to escalate a functional capability, it is 
critical the user re-authenticate.","Verify the operating system requires users to re-authenticate for privilege escalation. 
Check the configuration of the /etc/sudoers and /etc/sudoers.d/* files with the 
following command: 
# grep -r ""^[^#].*\!authenticate"" /etc/sudoers* 
If any line is found with a !authenticate tag, refer to the remediation procedure below.","Configure the operating system to require users to reauthenticate for privilege 
escalation. 
Based on the outcome of the audit procedure, use visudo -f <PATH TO FILE> to edit 
the relevant sudoers file. 
Remove any occurrences of !authenticate tags in the file(s). 
References: 
1. NIST SP 800-53 Rev. 5: AC-6",,
"5.2.6 Ensure sudo authentication timeout is configured correctly 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","sudo caches used credentials for a default of 5 minutes. This is for ease of use when 
there are multiple administrative tasks to perform. The timeout can be modified to suit 
local security policies.","Setting a timeout value reduces the window of opportunity for unauthorized privileged 
access to another user.","Ensure that the caching timeout is no more than 15 minutes. 
Example: 
# grep -roP ""timestamp_timeout=\K[0-9]*"" /etc/sudoers* 
If there is no timestamp_timeout configured in /etc/sudoers* then the default is 5 
minutes. This default can be checked with: 
# sudo -V | grep ""Authentication timestamp timeout:"" 
Note: A value of -1 means that the timeout is disabled. Depending on the configuration 
of the timestamp_type, this could mean for all terminals / processes of that user and 
not just that one single terminal session.","If the currently configured timeout is larger than 15 minutes, edit the file listed in the 
audit section with visudo -f <PATH TO FILE> and modify the entry 
timestamp_timeout= to 15 minutes or less as per your site policy. The value is in 
minutes. This particular entry may appear on its own, or on the same line as 
env_reset. See the following two examples: 
Defaults    env_reset, timestamp_timeout=15 
Defaults    timestamp_timeout=15 
Defaults    env_reset 
References: 
1. https://www.sudo.ws/man/1.9.0/sudoers.man.html",,
,,,,,"Create an empty group that will be specified for use of the su command. The group 
should be named according to site policy. 
Example: 
# groupadd sugroup 
Add the following line to the /etc/pam.d/su file, specifying the empty group: 
auth required pam_wheel.so use_uid group=sugroup 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply 
data access control lists, also known as access permissions, to local and remote 
file systems, databases, and applications. 
● 
● 
● 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented, standard security configuration standards for all 
authorized operating systems and software. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1078 
TA0005 
M1026",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply 
data access control lists also known as access permissions to local and remote 
file systems databases and applications. 
 
 
 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented standard security configuration standards for all 
authorized operating systems and software. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1078 
TA0005 
M1026"
5.3.1.1 Ensure latest version of pam is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation",Updated versions of PAM include additional functionality,"To ensure the system has full functionality and access to the options covered by this 
Benchmark, pam-1.5.1-19 or latter is required","Run the following command to verify the version of PAM on the system: 
# rpm -q pam 
Verify output is version pam-1.5.1-19 or greater: 
Example: 
pam-1.5.1-19.el9.x86_64","- IF - the version of PAM on the system is less that version pam-1.5.1-19: 
Run the following command to update to the latest version of PAM: 
# dnf upgrade pam",,
,,,,"Run the following command to verify the version of authselect on the system: 
# rpm -q authselect 
Verify output is version authselect-1.2.6-2 or greater: 
Example: 
authselect-1.2.6-2.el9.x86_64","Run the following command to install authselect: 
# dnf install authselect 
- IF - the version of authselect on the system is less that version authselect-1.2.6-
2: 
Run the following command to update to the latest version of authselect: 
# dnf upgrade authselect",,
"5.3.1.3 Ensure latest version of libpwquality is installed 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","libpwquality provides common functions for password quality checking and scoring 
them based on their apparent randomness. The library also provides a function for 
generating random passwords with good pronounceability. 
This module can be plugged into the password stack of a given service to provide some 
plug-in strength-checking for passwords. The code was originally based on 
pam_cracklib module and the module is backwards compatible with its options.","Strong passwords reduce the risk of systems being hacked through brute force 
methods.","Run the following command to verify the version of libpwquality on the system: 
# rpm -q libpwquality 
Verify output is version libpwquality-1.4.4-8 or greater: 
Example: 
libpwquality-1.4.4-8.el9.x86_64","Run the following command to install libpwquality: 
# dnf install libpwquality 
- IF - the version of libpwquality on the system is less that version libpwquality-
1.4.4-8: 
Run the following command to update to the latest version of libpwquality: 
# dnf upgrade libpwquality",,
,,,,,"Perform the following to create a custom authselect profile, with the modules covered in 
this Benchmark correctly included in the custom profile template files 
Run the following command to create a custom authselect profile: 
# authselect create-profile <custom-profile name> <options> 
Example: 
# authselect create-profile custom-profile -b sssd 
Run the following command to select a custom authselect profile: 
# authselect select custom/<CUSTOM PROFILE NAME> {with-<OPTIONS>} {--force} 
Example: 
# authselect select custom/custom-profile --backup=PAM_CONFIG_BACKUP --force 
Notes: 
• 
The PAM and authselect packages must be versions pam-1.3.1-25 and 
authselect-1.2.6-1 or newer 
• 
The example is based on a custom profile built (copied) from the the SSSD default 
authselect profile. 
• 
The example does not include the symlink option for the PAM or Metadata files. 
This is due to the fact that by linking the PAM files future updates to authselect 
may overwrite local site customizations to the custom profile 
• 
The --backup=PAM_CONFIG_BACKUP option will create a backup of the current 
config. The backup will be stored at 
/var/lib/authselect/backups/PAM_CONFIG_BACKUP 
• 
The --force option will force the overwrite of the existing files and automatically 
backup system files before writing any change unless the --nobackup option is 
set. 
o On a new system where authselect has not been configured. In this case, 
the --force option will force the selected authselect profile to be active 
and overwrite the existing files with files generated from the selected 
authselect profile's templates 
o On an existing system with a custom configuration. The --force option 
may be used, but ensure that you note the backup location included 
as your custom files will be overwritten. This will allow you to review 
the changes and add any necessary customizations to the template files 
for the authselect profile. After updating the templates, run the command 
authselect apply-changes to add these custom entries to the files in 
/etc/pam.d/ 
- IF - you receive an error ending with a message similar to:",,
,,,,,"Run the following script to verify the pam_faillock.so lines exist in the profile 
templates: 
#!/usr/bin/env bash 
 
{ 
   l_module_name=""faillock"" 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- ""\bpam_$l_module_name\.so\b"" 
""$l_pam_profile_path""/{password,system}-auth 
} 
Example Output with a custom profile named ""custom-profile"": 
/etc/authselect/custom/custom-profile/password-auth:auth   required   
pam_faillock.so preauth silent {include if ""with-faillock""} 
/etc/authselect/custom/custom-profile/password-auth:auth   required   
pam_faillock.so authfail {include if ""with-faillock""} 
/etc/authselect/custom/custom-profile/password-auth:account   required   
pam_faillock.so {include if ""with-faillock""} 
 
/etc/authselect/custom/custom-profile/system-auth:auth   required   
pam_faillock.so preauth silent {include if ""with-faillock""} 
/etc/authselect/custom/custom-profile/system-auth:auth   required   
pam_faillock.so authfail {include if ""with-faillock""} 
/etc/authselect/custom/custom-profile/system-auth:account   required   
pam_faillock.so  {include if ""with-faillock""} 
Note: The lines may not include {include if ""with-faillock""} 
- IF - the lines shown above are not returned, refer to the Recommendation ""Ensure 
active authselect profile includes pam modules"" to update the authselect profile 
template files to include the pam_faillock entries before continuing this remediation. 
- IF - the lines include {include if ""with-faillock""}, run the following command to 
enable the authselect with-faillock feature and update the files in /etc/pam.d to 
include pam_faillock.so: 
# authselect enable-feature with-faillock 
- IF - any of the pam_faillock lines exist without {include if ""with-faillock""}, 
run the following command to update the files in /etc/pam.d to include 
pam_faillock.so: 
# authselect apply-changes",,
,,,,,"Review the authselect profile templates: 
Run the following script to verify the pam_pwquality.so lines exist in the active profile 
templates: 
#!/usr/bin/env bash 
 
{ 
   l_module_name=""pwquality"" 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- ""\bpam_$l_module_name\.so\b"" 
""$l_pam_profile_path""/{password,system}-auth 
} 
Example Output with a custom profile named ""custom-profile"": 
/etc/authselect/custom/custom-profile/password-auth:password   requisite   
pam_pwquality.so local_users_only {include if ""with-pwquality""} 
 
/etc/authselect/custom/custom-profile/system-auth:password   requisite   
pam_pwquality.so local_users_only {include if ""with-pwquality""} 
Note: The lines may not include {include if ""with-pwquality""} 
- IF - the lines shown above are not returned, refer to the Recommendation ""Ensure 
active authselect profile includes pam modules"" to update the authselect profile 
template files to include the pam_pwquality entries before continuing this remediation. 
- IF - any of the pam_pwquality lines include {include if ""with-pwquality""}, run 
the following command to enable the authselect with-pwquality feature and update 
the files in /etc/pam.d to include `pam_pwquality: 
# authselect enable-feature with-pwquality 
- IF - any of the pam_pwquality lines exist without {include if ""with-pwquality""}, 
run the following command to update the files in /etc/pam.d to include 
pam_pwquality.so: 
# authselect apply-changes 
References: 
1. NIST SP 800-53 Rev. 5: IA-5(1)",,
,,,,,"Run the following script to verify the pam_pwhistory.so lines exist in the profile 
templates: 
#!/usr/bin/env bash 
 
{ 
   l_module_name=""pwhistory"" 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- ""\bpam_$l_module_name\.so\b"" 
""$l_pam_profile_path""/{password,system}-auth 
} 
Example Output with a custom profile named ""custom-profile"": 
/etc/authselect/custom/custom-profile/password-auth:password   required   
pam_pwhistory.so use_authtok {include if ""with-pwhistory""} 
 
/etc/authselect/custom/custom-profile/system-auth:password   required   
pam_pwhistory.so use_authtok {include if ""with-pwhistory""} 
Note: The lines may not include {include if ""with-pwhistory""} 
- IF - the lines shown above are not returned, refer to the Recommendation ""Ensure 
active authselect profile includes pam modules"" to update the authselect profile 
template files to include the pam_pwhistory entries before continuing this remediation. 
- IF - the lines include {include if ""with-pwhistory""}, run the following command 
to enable the authselect with-pwhistory feature and update the files in /etc/pam.d to 
include pam_faillock.so: 
# authselect enable-feature with-pwhistory 
- IF - any of the pam_pwhistory lines exist without {include if ""with-pwhistory""}, 
run the following command to update the files in /etc/pam.d to include 
pam_pwhistory.so: 
# authselect apply-changes 
References: 
1. NIST SP 800-53 Rev. 5: IA-5(1)",,
,,,,,"Run the following script to verify the pam_unix.so lines exist in the profile templates: 
#!/usr/bin/env bash 
 
{ 
   l_module_name=""unix"" 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- ""\bpam_$l_module_name\.so\b"" 
""$l_pam_profile_path""/{password,system}-auth 
} 
Example Output with a custom profile named ""custom-profile"": 
/etc/authselect/custom/custom-profile/password-auth:auth   sufficient   
pam_unix.so {if not ""without-nullok"":nullok} 
/etc/authselect/custom/custom-profile/password-auth:account   required   
pam_unix.so 
/etc/authselect/custom/custom-profile/password-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
remember=5 
/etc/authselect/custom/custom-profile/password-auth:session   required   
pam_unix.so 
 
/etc/authselect/custom/custom-profile/system-auth:auth   sufficient   
pam_unix.so {if not ""without-nullok"":nullok} 
/etc/authselect/custom/custom-profile/system-auth:account   required   
pam_unix.so 
/etc/authselect/custom/custom-profile/system-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
/etc/authselect/custom/custom-profile/system-auth:session   required   
pam_unix.so 
- IF - the lines shown above are not returned, refer to the Recommendation ""Ensure 
active authselect profile includes pam modules"" to update the authselect profile 
template files to include the pam_unix entries before continuing this remediation. 
Note: Arguments following pam_unix.so may be different than the example output 
References: 
1. NIST SP 800-53 Rev. 5: IA-5(1)",,
,,,,,"Create or edit the following line in /etc/security/faillock.conf setting the deny 
option to 5 or less: 
deny = 5 
Run the following script to remove the deny argument from the pam_faillock.so 
module in the PAM files: 
#!/usr/bin/env bash 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*auth\s+(requisite|required|sufficient)\s+pam_faillock\.so.*)(\s+deny\
s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","deny = 3 
Additional Information: 
If a user has been locked out because they have reached the maximum consecutive 
failure count defined by deny= in the pam_faillock.so module, the user can be 
unlocked by issuing the command faillock --user <USERNAME> --reset. This 
command sets the failed count to 0, effectively unlocking the user.","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
6.2 Establish an Access Revoking Process 
 
Establish and follow a process preferably automated for revoking access to 
enterprise assets through disabling accounts immediately upon termination rights 
revocation or role change of a user. Disabling accounts instead of deleting 
accounts may be necessary to preserve audit trails. 
 
 
 
v7 
16.7 Establish Process for Revoking Access 
 
Establish and follow an automated process for revoking system access by 
disabling accounts immediately upon termination or change of responsibilities of an 
employee or contractor . Disabling these accounts instead of deleting accounts 
allows preservation of audit trails. 
 
 
 "
,,,,"Run the following command to verify that the time in seconds before the account is 
unlocked is either 0 (never) or 900 (15 minutes) or more and meets local site policy: 
# grep -Pi -- '^\h*unlock_time\h*=\h*(0|9[0-9][0-9]|[1-9][0-9]{3,})\b' 
/etc/security/faillock.conf 
 
unlock_time = 900 
Run the following command to verify that the unlock_time argument has not been set, 
or is either 0 (never) or 900 (15 minutes) or more and meets local site policy: 
# grep -Pi -- 
'^\h*auth\h+(requisite|required|sufficient)\h+pam_faillock\.so\h+([^#\n\r]+\h
+)?unlock_time\h*=\h*([1-9]|[1-9][0-9]|[1-8][0-9][0-9])\b' /etc/pam.d/system-
auth /etc/pam.d/password-auth 
 
Nothing should be returned","Set password unlock time to conform to site policy. unlock_time should be 0 (never), 
or 900 seconds or greater. 
Edit /etc/security/faillock.conf and update or add the following line: 
unlock_time = 900 
Run the following script to remove the unlock_time argument from the 
pam_faillock.so module in the PAM files: 
#!/usr/bin/env bash 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*auth\s+(requisite|required|sufficient)\s+pam_faillock\.so.*)(\s+unloc
k_time\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
} 
``","unlock_time = 600 
Additional Information: 
If a user has been locked out because they have reached the maximum consecutive 
failure count defined by deny= in the pam_faillock.so module, the user can be 
unlocked by issuing the command faillock --user <USERNAME> --reset. This 
command sets the failed count to 0, effectively unlocking the user.",
,,,,,"Edit /etc/security/faillock.conf: 
• 
Remove or update any line containing root_unlock_time, - OR - set it to a 
value of 60 or more 
• 
Update or add the following line: 
even_deny_root 
Run the following script to remove the even_deny_root and root_unlock_time 
arguments from the pam_faillock.so module in the PAM files: 
#!/usr/bin/env bash 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*auth\s+(.*)\s+pam_faillock\.so.*)(\s+even_deny_root)(.*$)/\1\4/' 
""$l_authselect_file"" 
     sed -ri 
's/(^\s*auth\s+(.*)\s+pam_faillock\.so.*)(\s+root_unlock_time\s*=\s*\S+)(.*$)
/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
} 
``","disabled 
Additional Information: 
If a user has been locked out because they have reached the maximum consecutive 
failure count defined by deny= in the pam_faillock.so module, the user can be 
unlocked by issuing the command faillock --user <USERNAME> --reset. This 
command sets the failed count to 0, effectively unlocking the user.",
,,,,,"Create or modify a file ending in .conf in the /etc/security/pwquality.conf.d/ 
directory or the file /etc/security/pwquality.conf and add or modify the following 
line to set difok to 2 or more. Ensure setting conforms to local site policy: 
difok = 2 
Example: 
# sed -ri 's/^\s*difok\s*=/# &/' /etc/security/pwquality.conf 
# printf '\n%s' ""difok = 2"" >> /etc/security/pwquality.conf.d/50-pwdifok.conf 
Run the following script to remove setting difok on the pam_pwquality.so module in 
the PAM files: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
difok\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","difok = 1 
References: 
1. NIST SP 800-53 Rev. 5: IA-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
,,,,,"Create or modify a file ending in .conf in the /etc/security/pwquality.conf.d/ 
directory or the file /etc/security/pwquality.conf and add or modify the following 
line to set password length of 14 or more characters. Ensure that password length 
conforms to local site policy: 
Example: 
# sed -ri 's/^\s*minlen\s*=/# &/' /etc/security/pwquality.conf 
# printf '\n%s' ""minlen = 14"" >> /etc/security/pwquality.conf.d/50-
pwlength.conf 
Run the following script to remove setting minlen on the pam_pwquality.so module in 
the PAM files: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
minlen\s*=\s*[0-9]+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","minlen = 8 
References: 
1. pam_pwquality(8) 
2. NIST SP 800-53 Rev. 5: IA-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
,,,,,"Create or modify a file ending in .conf in the /etc/security/pwquality.conf.d/ 
directory or the file /etc/security/pwquality.conf and add or modify the following 
line to set: 
• 
minclass = 4 
--AND/OR-- 
• 
dcredit = -_N_ 
• 
ucredit = -_N_ 
• 
ocredit = -_N_ 
• 
lcredit = -_N_ 
Example: 
# sed -ri 's/^\s*minclass\s*=/# &/' /etc/security/pwquality.conf 
# printf '\n%s' ""minclass = 4"" >> /etc/security/pwquality.conf.d/50-
pwcomplexity.conf 
--AND/OR-- 
# sed -ri 's/^\s*[dulo]credit\s*=/# &/' /etc/security/pwquality.conf 
# printf '%s\n' ""dcredit = -1"" ""ucredit = -1"" ""ocredit = -1"" ""lcredit = -1"" > 
/etc/security/pwquality.conf.d/50-pwcomplexity.conf 
Run the following script to remove setting minclass, dcredit, ucredit, lcredit, and 
ocredit on the pam_pwquality.so module in the PAM files 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
minclass\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
dcredit\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
ucredit\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
lcredit\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
ocredit\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}",,
,,,,,"Create or modify a file ending in .conf in the /etc/security/pwquality.conf.d/ 
directory or the file /etc/security/pwquality.conf and add or modify the following 
line to set maxrepeat to 3 or less and not 0. Ensure setting conforms to local site policy: 
Example: 
# sed -ri 's/^\s*maxrepeat\s*=/# &/' /etc/security/pwquality.conf 
# printf '\n%s' ""maxrepeat = 3"" >> /etc/security/pwquality.conf.d/50-
pwrepeat.conf 
Run the following script to remove setting maxrepeat on the pam_pwquality.so 
module in the PAM files: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
maxrepeat\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","maxrepeat = 0 
References: 
1. NIST SP 800-53 Rev. 5: IA-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
,,,,,"Create or modify a file ending in .conf in the /etc/security/pwquality.conf.d/ 
directory or the file /etc/security/pwquality.conf and add or modify the following 
line to set maxsequence to 3 or less and not 0. Ensure setting conforms to local site 
policy: 
Example: 
# sed -ri 's/^\s*maxsequence\s*=/# &/' /etc/security/pwquality.conf 
# printf '\n%s' ""maxsequence = 3"" >> /etc/security/pwquality.conf.d/50-
pwmaxsequence.conf 
Run the following script to remove setting maxsequence on the pam_pwquality.so 
module in the PAM files: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
maxsequence\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","maxsequence = 0 
References: 
1. NIST SP 800-53 Rev. 5: IA-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
,,,,,"Edit any file ending in .conf in the /etc/security/pwquality.conf.d/ directory 
and/or the file /etc/security/pwquality.conf and comment out or remove any 
instance of dictcheck = 0: 
Example: 
# sed -ri 's/^\s*dictcheck\s*=/# &/' /etc/security/pwquality.conf 
/etc/security/pwquality.conf.d/*.conf 
Run the following script to remove setting dictcheck on the pam_pwquality.so 
module in the PAM files: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwquality\.so.*)(\s+
dictcheck\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
}","dictcheck = 1 
References: 
1. NIST SP 800-53 Rev. 5: IA-5","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
,,,,"Run the following command to verify that the enforce_for_root option is enabled in a 
pwquality configuration file: 
# grep -Psi -- '^\h*enforce_for_root\b' /etc/security/pwquality.conf 
/etc/security/pwquality.conf.d/*.conf 
Example output: 
/etc/security/pwquality.conf.d/50-pwroot.conf:enforce_for_root 
Notes: 
• 
Settings observe an order of precedence: 
o module arguments override the settings in the 
/etc/security/pwquality.conf configuration file 
o settings in the /etc/security/pwquality.conf configuration file 
override settings in a .conf file in the 
/etc/security/pwquality.conf.d/ directory 
o settings in a .conf file in the /etc/security/pwquality.conf.d/ 
directory are read in canonical order, with last read file containing the 
setting taking precedence 
• 
It is recommended that settings be configured in a .conf file in the 
/etc/security/pwquality.conf.d/ directory for clarity, convenience, and 
durability.","Edit or add the following line in a *.conf file in /etc/security/pwquality.conf.d or 
in /etc/security/pwquality.conf: 
Example: 
printf '\n%s\n' ""enforce_for_root"" >> /etc/security/pwquality.conf.d/50-
pwroot.conf","disabled 
References: 
1. NIST SP 800-53 Rev. 5: IA-5",
,,,,,"Edit or add the following line in /etc/security/pwhistory.conf: 
remember = 24 
Run the following script to remove the remember argument from the pam_pwhistory.so 
module in /etc/pam.d/system-auth and /etc/pam.d/password-auth: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
     l_authselect_file=""/etc/authselect/$(head -1 
/etc/authselect/authselect.conf | grep 'custom/')/$l_pam_file"" 
     sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwhistory\.so.*)(\s+
remember\s*=\s*\S+)(.*$)/\1\4/' ""$l_authselect_file"" 
   done 
   authselect apply-changes 
} 
References: 
1. NIST SP 800-53 Rev. 5: IA-5(1) 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes, at a minimum, an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA.  
● 
● 
● 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported (such as local administrator, 
root, or service accounts), accounts will use passwords that are unique to that 
system. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
"5.3.3.3.2 Ensure password history is enforced for the root user 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","If the pwhistory enforce_for_root option is enabled, the module will enforce 
password history for the root user as well","Requiring users not to reuse their passwords make it less likely that an attacker will be 
able to guess the password or use a compromised password 
Note: These change only apply to accounts configured on the local system.","Run the following command to verify that the enforce_for_root option is enabled in 
/etc/pwhistory.conf: 
# grep -Pi -- '^\h*enforce_for_root\b' /etc/security/pwhistory.conf 
 
enforce_for_root 
Notes: 
• 
Settings observe an order of precedence. 
• 
Module arguments override the settings in the /etc/security/pwhistory.conf 
configuration file 
• 
It is recommended that settings be configured in 
/etc/security/pwhistory.conf for clarity, convenience, and durability.","Edit or add the following line in /etc/security/pwhistory.conf: 
enforce_for_root","disabled 
References: 
1. NIST SP 800-53 Rev. 5: IA-5",
,,,,,"Run the following script to verify the active authselect profile includes use_authtok on 
the password stack's pam_pwhistory.so module lines: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- 
'^\h*password\h+(requisite|required|sufficient)\h+pam_pwhistory\.so\h+([^#\n\
r]+\h+)?use_authtok\b' ""$l_pam_profile_path""/{password,system}-auth 
} 
Example output: 
/etc/authselect/custom/custom-profile/password-auth:password   required   
pam_pwhistory.so use_authtok 
 
/etc/authselect/custom/custom-profile/system-auth:password   required   
pam_pwhistory.so use_authtok 
- IF - the output does not include use_authtok, run the following script: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   for l_authselect_file in ""$l_pam_profile_path""/password-auth 
""$l_pam_profile_path""/system-auth; do 
      if  grep -Pq 
'^\h*password\h+([^#\n\r]+)\h+pam_pwhistory\.so\h+([^#\n\r]+\h+)?use_authtok\
b' ""$l_authselect_file""; then 
         echo ""- \""use_authtok\"" is already set"" 
      else 
         echo ""- \""use_authtok\"" is not set. Updating template"" 
         sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_pwhistory\.so\s+.*)$
/& use_authtok/g' ""$l_authselect_file"" 
      fi 
   done 
} 
Run the following command to update the password-auth and system-auth files in 
/etc/pam.d to include the use_authtok argument on the password stack's 
pam_pwhistory.so lines:",,
,,,,,"Run the following script to verify that the active authselect profile's system-auth and 
password-auth files include {if not ""without-nullok"":nullok} - OR - don't 
include the nullok option on the pam_unix.so module: 
{ 
   l_module_name=""unix"" 
   l_profile_name=""$(head -1 /etc/authselect/authselect.conf)"" 
   if [[ ! ""$l_profile_name"" =~ ^custom\/ ]]; then 
      echo "" - Follow Recommendation \""Ensure custom authselect profile is 
used\"" and then return to this Recommendation"" 
   else 
      grep -P -- ""\bpam_$l_module_name\.so\b"" 
/etc/authselect/$l_profile_name/{password,system}-auth 
   fi 
} 
Example output with a custom profile named ""custom-profile"": 
/etc/authselect/custom/custom-profile/password-auth:auth   sufficient   
pam_unix.so {if not ""without-nullok"":nullok} 
/etc/authselect/custom/custom-profile/password-auth:account   required   
pam_unix.so 
/etc/authselect/custom/custom-profile/password-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
/etc/authselect/custom/custom-profile/password-auth:session   required   
pam_unix.so 
 
/etc/authselect/custom/custom-profile/system-auth:auth   sufficient   
pam_unix.so {if not ""without-nullok"":nullok} 
/etc/authselect/custom/custom-profile/system-auth:account   required   
pam_unix.so 
/etc/authselect/custom/custom-profile/system-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
/etc/authselect/custom/custom-profile/system-auth:session   required   
pam_unix.so 
- IF - any line is returned with nullok that doesn't also include {if not ""without-
nullok"":nullok}, run the following script: 
#!/usr/bin/env bash 
 
{ 
   for l_pam_file in system-auth password-auth; do 
      l_file=""/etc/authselect/$(head -1 /etc/authselect/authselect.conf | 
grep 'custom/')/$l_pam_file"" 
      sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_unix\.so\s+.*)(nullo
k)(\s*.*)$/\1\2\4/g' $l_file 
   done 
} 
- IF - any line is returned with {if not ""without-nullok"":nullok}, run the following 
command to enable the authselect without-nullok feature:",,
,,,,,"Run the following script to verify the active authselect profile doesn't include the 
remember argument on the pam_unix.so module lines: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- '^\h*password\h+([^#\n\r]+\h+)pam_unix\.so\b' 
""$l_pam_profile_path""/{password,system}-auth 
} 
Output should be similar to: 
/etc/authselect/custom/custom-profile/password-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
 
/etc/authselect/custom/custom-profile/system-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
- IF - any line includes remember=, run the following script to remove the remember= 
from the pam_unix.so lines in the active authselect profile password-auth and system-
auth` templates: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   for l_authselect_file in ""$l_pam_profile_path""/password-auth 
""$l_pam_profile_path""/system-auth; do 
      sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_unix\.so\s+.*)(remem
ber=[1-9][0-9]*)(\s*.*)$/\1\4/g' ""$l_authselect_file"" 
   done 
} 
Run the following command to update the password-auth and system-authfiles 
in/etc/pam.d to include pam_unix.so without the remember argument:",,
,,,,,"Note: 
• 
It is highly recommended that the chosen hashing algorithm is consistent across 
/etc/libuser.conf, /etc/login.defs, /etc/pam.d/password-auth, and 
/etc/pam.d/system-auth. 
• 
This only effects local users and passwords created after updating the files to 
use sha512 or yescrypt. If it is determined that the password algorithm being 
used is not sha512 or yescrypt, once it is changed, it is recommended that all 
user ID's be immediately expired and forced to change their passwords on next 
login. 
Run the following script to verify the active authselect profile includes a strong password 
hashing algorithm on the password stack's pam_unix.so module lines: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- 
'^\h*password\h+(requisite|required|sufficient)\h+pam_unix\.so\h+([^#\n\r]+\h
+)?(sha512|yescrypt)\b' ""$l_pam_profile_path""/{password,system}-auth 
} 
Example output: 
/etc/authselect/custom/custom-profile/password-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
 
/etc/authselect/custom/custom-profile/system-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
- IF - the output does not include either sha512 - OR - yescrypt, or includes a different 
hashing algorithm, run the following script:",,
,,,,,"Run the following script to verify the active authselect profile includes use_authtok on 
the password stack's pam_unix.so module lines: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   grep -P -- 
'^\h*password\h+(requisite|required|sufficient)\h+pam_unix\.so\h+([^#\n\r]+\h
+)?use_authtok\b' ""$l_pam_profile_path""/{password,system}-auth 
} 
Example output: 
/etc/authselect/custom/custom-profile/password-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
 
/etc/authselect/custom/custom-profile/system-auth:password   sufficient   
pam_unix.so sha512 shadow {if not ""without-nullok"":nullok} use_authtok 
- IF - the output does not include use_authtok, run the following script: 
#!/usr/bin/env bash 
 
{ 
   l_pam_profile=""$(head -1 /etc/authselect/authselect.conf)"" 
   if grep -Pq -- '^custom\/' <<< ""$l_pam_profile""; then 
      l_pam_profile_path=""/etc/authselect/$l_pam_profile"" 
   else 
      l_pam_profile_path=""/usr/share/authselect/default/$l_pam_profile"" 
   fi 
   for l_authselect_file in ""$l_pam_profile_path""/password-auth 
""$l_pam_profile_path""/system-auth; do 
      if  grep -Pq 
'^\h*password\h+([^#\n\r]+)\h+pam_unix\.so\h+([^#\n\r]+\h+)?use_authtok\b' 
""$l_authselect_file""; then 
         echo ""- \""use_authtok\"" is already set"" 
      else 
         echo ""- \""use_authtok\"" is not set. Updating template"" 
         sed -ri 
's/(^\s*password\s+(requisite|required|sufficient)\s+pam_unix\.so\s+.*)$/& 
use_authtok/g' ""$l_authselect_file"" 
      fi 
   done 
} 
Run the following command to update the password-auth and system-auth files in 
/etc/pam.d to include the use_authtok argument on the password stack's 
pam_unix.so lines:",,
,,,,,"Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs : 
PASS_MAX_DAYS 365 
Modify user parameters for all users with a password set to match: 
# chage --maxdays 365 <user> 
Edit /etc/login.defs and set PASS_MAX_DAYS to a value greater than 0 that follows 
local site policy: 
Example: 
PASS_MAX_DAYS 365 
Run the following command to modify user parameters for all users with a password set 
to a maximum age no greater than 365 or less than 1 that follows local site policy: 
# chage --maxdays <N> <user> 
Example: 
# awk -F: '($2~/^\$.+\$/) {if($5 > 365 || $5 < 1)system (""chage --maxdays 365 
"" $1)}' /etc/shadow 
Warning: If a password has been set at system install or kickstart, the last change 
date field is not set, In this case, setting PASS_MAX_DAYS will immediately expire the 
password. One possible solution is to populate the last change date field through a 
command like: chage -d ""$(date +%Y-%m-%d)"" root","PASS_MAX_DAYS 99999 
References: 
1. CIS Password Policy Guide 
2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
Additional Information: 
A value of -1 will disable password expiration.",
,,,,"Run the following command to verify that PASS_MIN_DAYS is set to a value greater than 
0and follows local site policy: 
# grep -Pi -- '^\h*PASS_MIN_DAYS\h+\d+\b' /etc/login.defs 
Example output: 
PASS_MIN_DAYS   1 
Run the following command to verify all passwords have a PASS_MIN_DAYS greater than 
0: 
# awk -F: '($2~/^\$.+\$/) {if($4 < 1)print ""User: "" $1 "" PASS_MIN_DAYS: "" 
$4}' /etc/shadow 
Nothing should be returned","Edit /etc/login.defs and set PASS_MIN_DAYS to a value greater than 0 that follows 
local site policy: 
Example: 
PASS_MIN_DAYS 1 
Run the following command to modify user parameters for all users with a password set 
to a minimum days greater than zero that follows local site policy: 
# chage --mindays <N> <user> 
Example: 
# awk -F: '($2~/^\$.+\$/) {if($4 < 1)system (""chage --mindays 1 "" $1)}' 
/etc/shadow","PASS_MIN_DAYS 0 
References: 
1. CIS Password Policy Guide",
,,,,,"Edit /etc/login.defs and set PASS_WARN_AGE to a value of 7 or more that follows 
local site policy: 
Example: 
PASS_WARN_AGE 7 
Run the following command to modify user parameters for all users with a password set 
to a minimum warning to 7 or more days that follows local site policy: 
# chage --warndays <N> <user> 
Example: 
# awk -F: '($2~/^\$.+\$/) {if($6 < 7)system (""chage --warndays 7 "" $1)}' 
/etc/shadow",PASS_WARN_AGE 7,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.1 Establish and Maintain a Secure Configuration Process 
 
Establish and maintain a secure configuration process for enterprise assets 
 end-user devices including portable and mobile non-computing IoT devices and 
servers and software operating systems and applications . Review and update 
documentation annually or when significant enterprise changes occur that could 
impact this Safeguard. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1078 
TA0006 
M1027"
,,,,"Run the following command to verify the hashing algorithm is sha512 or yescrypt in 
/etc/login.defs: 
# grep -Pi -- '^\h*ENCRYPT_METHOD\h+(SHA512|yescrypt)\b' /etc/login.defs 
Example output: 
ENCRYPT_METHOD SHA512 
 - OR - 
ENCRYPT_METHOD  YESCRYPT","Edit /etc/login.defs and set the ENCRYPT_METHOD to SHA512 or YESCRYPT: 
ENCRYPT_METHOD <HASHING_ALGORITHM> 
Example: 
ENCRYPT_METHOD YESCRYPT 
Note: 
• 
This only effects local groups' passwords created after updating the file to use 
sha512 or yescrypt. 
• 
If it is determined that the password algorithm being used is not sha512 or 
yescrypt, once it is changed, it is recommended that all group passwords be 
updated to use the stronger hashing algorithm. 
• 
It is recommended that the chosen hashing algorithm is consistent across 
/etc/login.defs and the PAM configuration","ENCRYPT_METHOD SHA512 
References: 
1. NIST SP 800-53 Rev. 5: IA-5",
,,,,,"Run the following command to set the default password inactivity period to 45 days or 
less that meets local site policy: 
# useradd -D -f <N> 
Example: 
# useradd -D -f 45 
Run the following command to modify user parameters for all users with a password set 
to a inactive age of 45 days or less that follows local site policy: 
# chage --inactive <N> <user> 
Example: 
# awk -F: '($2~/^\$.+\$/) {if($7 > 45 || $7 < 0)system (""chage --inactive 45 
"" $1)}' /etc/shadow","INACTIVE=-1 
References: 
1. CIS Password Policy Guide 
Additional Information: 
A value of -1 would disable this setting.","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
5.2 Use Unique Passwords 
 
Use unique passwords for all enterprise assets. Best practice implementation 
includes at a minimum an 8-character password for accounts using MFA and a 
14-character password for accounts not using MFA. 
 
 
 
v7 
4.4 Use Unique Passwords 
 
Where multi-factor authentication is not supported such as local administrator 
root or service accounts accounts will use passwords that are unique to that 
system. 
 
 
 "
"5.4.1.6 Ensure all users last password change date is in the past 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",All users should have a password change date in the past.,"If a user's recorded password change date is in the future, then they could bypass any 
set password expiration.","Run the following script and verify nothing is returned: 
#!/usr/bin/env bash 
 
{ 
   while IFS= read -r l_user; do 
      l_change=$(date -d ""$(chage --list $l_user | grep '^Last password 
change' | cut -d: -f2 | grep -v 'never$')"" +%s) 
      if [[ ""$l_change"" -gt ""$(date +%s)"" ]]; then 
         echo ""User: \""$l_user\"" last password change was \""$(chage --list 
$l_user | grep '^Last password change' | cut -d: -f2)\"""" 
      fi 
   done < <(awk -F: '$2~/^\$.+\$/{print $1}' /etc/shadow) 
}","Investigate any users with a password change date in the future and correct them. 
Locking the account, expiring the password, or resetting the password manually may be 
appropriate.",,
5.4.2.1 Ensure root is the only UID 0 account (Automated)," Level 1 - Server 
 Level 1 - Workstation",Any account with UID 0 has superuser privileges on the system.,"This access must be limited to only the default root account and only from the system 
console. Administrative access must be through an unprivileged account using an 
approved mechanism as noted in the Recommendation ""Ensure access to the su 
command is restricted"".","Run the following command and verify that only ""root"" is returned: 
# awk -F: '($3 == 0) { print $1 }' /etc/passwd 
 
root","Run the following command to change the root account UID to 0: 
# usermod -u 0 root 
Modify any users other than root with UID 0 and assign them a new UID. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1548, T1548.000 
TA0001 
M1026",,
5.4.2.2 Ensure root is the only GID 0 account (Automated)," Level 1 - Server 
 Level 1 - Workstation","The usermod command can be used to specify which group the root account belongs 
to. This affects permissions of files that are created by the root account.","Using GID 0 for the root account helps prevent root -owned files from accidentally 
becoming accessible to non-privileged users.","Run the following command to verify the root user's primary GID is 0, and no other 
user's have GID 0 as their primary GID: 
# awk -F: '($1 !~ /^(sync|shutdown|halt|operator)/ && $4==""0"") {print 
$1"":""$4}' /etc/passwd 
 
root:0 
Note: User's: sync, shutdown, halt, and operator are excluded from the check for other 
user's with GID 0","Run the following command to set the root user's GID to 0: 
# usermod -g 0 root 
Run the following command to set the root group's GID to 0: 
# groupmod -g 0 root 
Remove any users other than the root user with GID 0 or assign them a new GID if 
appropriate. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
5.4.2.3 Ensure group root is the only GID 0 group (Automated)," Level 1 - Server 
 Level 1 - Workstation","The groupmod command can be used to specify which group the root group belongs 
to. This affects permissions of files that are group owned by the root group.","Using GID 0 for the root group helps prevent root group owned files from accidentally 
becoming accessible to non-privileged users.","Run the following command to verify no group other than root is assigned GID 0: 
# awk -F: '$3==""0""{print $1"":""$3}' /etc/group 
 
root:0","Run the following command to set the root group's GID to 0: 
# groupmod -g 0 root 
Remove any groups other than the root group with GID 0 or assign them a new GID if 
appropriate. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
,,,,,"Run the following command to set a password for the root user: 
# passwd root 
- OR - 
Run the following command to lock the root user account: 
# usermod -L root 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1078 
TA0005 
M1026",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1078 
TA0005 
M1026"
,,,,,"Correct or justify any: 
• 
Locations that are not directories 
• 
Empty directories (::) 
• 
Trailing (:) 
• 
Current working directory (.) 
• 
Non root owned directories 
• 
Directories that less restrictive than mode 0755 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1204, T1204.002 
TA0006 
M1022",,
,,,"Setting a secure value for umask ensures that users make a conscious choice about 
their file permissions. A permissive umask value could result in directories or files with 
excessive permissions that can be read and/or written to by unauthorized users.","Run the following to verify the root user umask is set to enforce a newly created 
directories' permissions to be 750 (drwxr-x---), and a newly created file's 
permissions be 640 (rw-r-----), or more restrictive: 
grep -Psi -- '^\h*umask\h+(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-7][0-
6]\b)|([0-7][01][0-7]\b|[0-7][0-7][0-
6]\b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?\b)(,o=[rwx]{1,3})?)|((g=[wrx
]{1,3},)?o=[wrx]{1,3}\b)))' /root/.bash_profile /root/.bashrc 
 
Nothing should be returned","Edit /root/.bash_profile and /root/.bashrc and remove, comment out, or update 
any line with umask to be 0027 or more restrictive.","System default umask 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"Run the following command to set the shell for any service accounts returned by the 
audit to nologin: 
# usermod -s $(command -v nologin) <user> 
Example script: 
#!/usr/bin/env bash 
 
{ 
   l_valid_shells=""^($( awk -F\/ '$NF != ""nologin"" {print}' /etc/shells | sed 
-rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d '|' - ))$"" 
   awk -v pat=""$l_valid_shells"" -F: 
'($1!~/^(root|halt|sync|shutdown|nfsnobody)$/ && ($3<'""$(awk 
'/^\s*UID_MIN/{print $2}' /etc/login.defs)""' || $3 == 65534) && $(NF) ~ pat) 
{system (""usermod -s '""$(command -v nologin)""' "" $1)}' /etc/passwd 
} 
References: 
1. NIST SP 800-53 Rev. 5: AC-2(5), AC-3, AC-11, MP-2 
Additional Information: 
The root, sync, shutdown, and halt users are exempted from requiring a non-login 
shell. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
,,,,,"Run the following command to lock any non-root accounts without a valid login shell 
returned by the audit: 
# usermod -L <user> 
Example script:: 
#!/usr/bin/env bash 
 
{ 
   l_valid_shells=""^($(awk -F\/ '$NF != ""nologin"" {print}' /etc/shells | sed 
-rn '/^\//{s,/,\\\\/,g;p}' | paste -s -d '|' - ))$"" 
   while IFS= read -r l_user; do 
      passwd -S ""$l_user"" | awk '$2 !~ /^L/ {system (""usermod -L "" $1)}' 
   done < <(awk -v pat=""$l_valid_shells"" -F: '($1 != ""root"" && $(NF) !~ pat) 
{print $1}' /etc/passwd) 
} 
References: 
1. NIST SP 800-53 Rev. 5: AC-2(5), AC-3, AC-11, MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1078, T1078.001, 
T1078.003 
TA0005 
M1026",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1078 T1078.001 
T1078.003 
TA0005 
M1026"
5.4.3.1 Ensure nologin is not listed in /etc/shells (Automated)," Level 2 - Server 
 Level 2 - Workstation","/etc/shells is a text file which contains the full pathnames of valid login shells. This 
file is consulted by chsh and available to be queried by other programs. 
Be aware that there are programs which consult this file to find out if a user is a normal 
user; for example, FTP daemons traditionally disallow access to users with shells not 
included in this file.","A user can use chsh to change their configured shell. 
If a user has a shell configured that isn't in in /etc/shells, then the system assumes 
that they're somehow restricted. In the case of chsh it means that the user cannot 
change that value. 
Other programs might query that list and apply similar restrictions. 
By putting nologin in /etc/shells, any user that has nologin as its shell is 
considered a full, unrestricted user. This is not the expected behavior for nologin.","Run the following command to verify that nologin is not listed in the /etc/shells file: 
# grep -Ps '^\h*([^#\n\r]+)?\/nologin\b' /etc/shells 
Nothing should be returned","Edit /etc/shells and remove any lines that include nologin 
References: 
1. shells(5) 
2. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
,,,,,"Review /etc/bashrc, /etc/profile, and all files ending in *.sh in the 
/etc/profile.d/ directory and remove or edit all TMOUT=_n_ entries to follow local site 
policy. TMOUT should not exceed 900 or be equal to 0. 
Configure TMOUT in one of the following files: 
• 
A file in the /etc/profile.d/ directory ending in .sh 
• 
/etc/profile 
• 
/etc/bashrc 
Example command to set TMOUT to 900 seconds in a file in /etc/profile.d/: 
# printf '%s\n' ""# Set TMOUT to 900 seconds"" ""typeset -xr TMOUT=900"" > 
/etc/profile.d/50-tmout.sh 
TMOUT configuration examples: 
typeset -xr TMOUT=900 
Deprecated methods: 
• 
As multiple lines: 
TMOUT=900 
readonly TMOUT 
export TMOUT 
• 
As a single line: 
readonly TMOUT=900 ; export TMOUT 
Additional Information: 
The audit and remediation in this recommendation apply to bash and shell. If other 
shells are supported on the system, it is recommended that their configuration files also 
are checked. Other methods of setting a timeout exist for other shells not covered here. 
Ensure that the timeout conforms to your local policy. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.3 Configure Automatic Session Locking on Enterprise 
Assets 
 
Configure automatic session locking on enterprise assets after a defined period 
of inactivity. For general purpose operating systems, the period must not exceed 
15 minutes. For mobile end-user devices, the period must not exceed 2 minutes. 
● 
● 
● 
v7 
16.11 Lock Workstation Sessions After Inactivity 
 
Automatically lock workstation sessions after a standard period of inactivity. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.3 Configure Automatic Session Locking on Enterprise 
Assets 
 
Configure automatic session locking on enterprise assets after a defined period 
of inactivity. For general purpose operating systems the period must not exceed 
15 minutes. For mobile end-user devices the period must not exceed 2 minutes. 
 
 
 
v7 
16.11 Lock Workstation Sessions After Inactivity 
 
Automatically lock workstation sessions after a standard period of inactivity. 
 
 
 "
,,,,,"Run the following script and perform the instructions in the output to set the default 
umask to 027 or more restrictive: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" l_out="""" 
   file_umask_chk() 
   { 
      if grep -Psiq -- '^\h*umask\h+(0?[0-7][2-
7]7|u(=[rwx]{0,3}),g=([rx]{0,2}),o=)(\h*#.*)?$' ""$l_file""; then 
         l_out=""$l_out\n - umask is set correctly in \""$l_file\"""" 
      elif grep -Psiq -- '^\h*umask\h+(([0-7][0-7][01][0-7]\b|[0-7][0-7][0-
7][0-6]\b)|([0-7][01][0-7]\b|[0-7][0-7][0-
6]\b)|(u=[rwx]{1,3},)?(((g=[rx]?[rx]?w[rx]?[rx]?\b)(,o=[rwx]{1,3})?)|((g=[wrx
]{1,3},)?o=[wrx]{1,3}\b)))' ""$l_file""; then 
         l_output2=""$l_output2\n   - \""$l_file\"""" 
      fi 
   } 
   while IFS= read -r -d $'\0' l_file; do 
      file_umask_chk 
   done < <(find /etc/profile.d/ -type f -name '*.sh' -print0) 
   [ -n ""$l_out"" ] && l_output=""$l_out"" 
   l_file=""/etc/profile"" && file_umask_chk 
   l_file=""/etc/bashrc"" && file_umask_chk 
   l_file=""/etc/bash.bashrc"" && file_umask_chk 
   l_file=""/etc/pam.d/postlogin"" 
   if grep -Psiq 
'^\h*session\h+[^#\n\r]+\h+pam_umask\.so\h+([^#\n\r]+\h+)?umask=(([0-7][0-
7][01][0-7]\b|[0-7][0-7][0-7][0-6]\b)|([0-7][01][0-7]\b))' ""$l_file""; then 
      l_output2=""$l_output2\n   - \""$l_file\"""" 
   fi 
   l_file=""/etc/login.defs"" && file_umask_chk 
   l_file=""/etc/default/login"" && file_umask_chk 
   if [ -z ""$l_output2"" ]; then 
      echo -e "" - No files contain a UMASK that is not restrictive enough\n   
No UMASK updates required to existing files"" 
   else 
      echo -e ""\n - UMASK is not restrictive enough in the following 
file(s):$l_output2\n\n- Remediation Procedure:\n - Update these files and 
comment out the UMASK line\n   or update umask to be \""0027\"" or more 
restrictive"" 
   fi 
   if [ -n ""$l_output"" ]; then 
      echo -e ""$l_output"" 
   else 
      echo -e "" - Configure UMASK in a file in the \""/etc/profile.d/\"" 
directory ending in \"".sh\""\n\n   Example Command (Hash to represent being 
run at a root prompt):\n\n# printf '%s\\\n' \""umask 027\"" > 
/etc/profile.d/50-systemwide_umask.sh\n"" 
   fi 
}",,
6.1.1 Ensure AIDE is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","Advanced Intrusion Detection Environment (AIDE) is a intrusion detection tool that uses 
predefined rules to check the integrity of files and directories in the Linux operating 
system. AIDE has its own database to check the integrity of files and directories. 
aide takes a snapshot of files and directories including modification times, permissions, 
and file hashes which can then be used to compare against the current state of the 
filesystem to detect modifications to the system.","By monitoring the filesystem state compromised files can be detected to prevent or limit 
the exposure of accidental or malicious misconfigurations or modified binaries.","Run the following command and verify aide is installed: 
# rpm -q aide 
 
aide-<version>","Run the following command to install aide: 
# dnf install aide 
Configure aide as appropriate for your environment. Consult the aide documentation 
for options. 
Initialize aide: 
Run the following commands: 
# aide --init 
# mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz 
References: 
1. AIDE stable manual: http://aide.sourceforge.net/stable/manual.html 
2. NIST SP 800-53 Rev. 5: AU-2",,
,,,,,"- IF - cron will be used to schedule and run aide check 
Run the following command: 
# crontab -u root -e 
Add the following line to the crontab: 
0 5 * * * /usr/sbin/aide --check 
- OR - 
- IF - aidecheck.service and aidecheck.timer will be used to schedule and run aide 
check: 
Create or edit the file /etc/systemd/system/aidecheck.service and add the 
following lines: 
[Unit] 
Description=Aide Check 
 
[Service] 
Type=simple 
ExecStart=/usr/sbin/aide --check 
 
[Install] 
WantedBy=multi-user.target 
Create or edit the file /etc/systemd/system/aidecheck.timer and add the following 
lines: 
[Unit] 
Description=Aide check every day at 5AM 
 
[Timer] 
OnCalendar=*-*-* 05:00:00 
Unit=aidecheck.service 
 
[Install] 
WantedBy=multi-user.target 
Run the following commands: 
# chown root:root /etc/systemd/system/aidecheck.* 
# chmod 0644 /etc/systemd/system/aidecheck.* 
 
# systemctl daemon-reload 
 
# systemctl enable aidecheck.service 
# systemctl --now enable aidecheck.timer 
References: 
1. https://github.com/konstruktoid/hardening/blob/master/config/aidecheck.service 
2. https://github.com/konstruktoid/hardening/blob/master/config/aidecheck.timer 
3. NIST SP 800-53 Rev. 5: AU-2",,
,,,,,"Run the following command to determine the absolute path to the non-symlinked 
version on the audit tools: 
# readlink -f /sbin 
The output will be either /usr/sbin - OR - /sbin. Ensure the correct path is used. 
Edit /etc/aide.conf and add or update the following selection lines replacing <PATH> 
with the correct path returned in the command above: 
# Audit Tools  
<PATH>/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512  
<PATH>/auditd p+i+n+u+g+s+b+acl+xattrs+sha512  
<PATH>/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512  
<PATH>/aureport p+i+n+u+g+s+b+acl+xattrs+sha512  
<PATH>/autrace p+i+n+u+g+s+b+acl+xattrs+sha512  
<PATH>/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512 
Example 
# printf '\n%s' ""# Audit Tools"" ""$(readlink -f /sbin/auditctl) 
p+i+n+u+g+s+b+acl+xattrs+sha512"" \ 
""$(readlink -f /sbin/auditd) p+i+n+u+g+s+b+acl+xattrs+sha512"" \ 
""$(readlink -f /sbin/ausearch) p+i+n+u+g+s+b+acl+xattrs+sha512"" \ 
""$(readlink -f /sbin/aureport) p+i+n+u+g+s+b+acl+xattrs+sha512"" \ 
""$(readlink -f /sbin/autrace) p+i+n+u+g+s+b+acl+xattrs+sha512"" \ 
""$(readlink -f /sbin/augenrules) p+i+n+u+g+s+b+acl+xattrs+sha512"" >> 
/etc/aide.conf 
Note: - IF - /etc/aide.conf includes a @@x_include statement: 
Example: 
@@x_include /etc/aide.conf.d ^[a-zA-Z0-9_-]+$ 
• 
@@x_include FILE 
• 
@@x_include DIRECTORY REGEX 
o @x_include is identical to @@include, except that if a config file is 
executable it is run and the output is used as config. 
o If the executable file exits with status greater than zero or writes to stderr 
aide stops with an error. 
o For security reasons DIRECTORY and each executable config file must 
be owned by the current user and must not be group or world-writable. 
References: 
1. AIDE.CONF(5)",,
6.2.1.1 Ensure journald service is enabled and active (Automated)," Level 1 - Server 
 Level 1 - Workstation","Ensure that the systemd-journald service is enabled to allow capturing of logging 
events.","If the systemd-journald service is not enabled to start on boot, the system will not 
capture logging events.","Run the following command to verify systemd-journald is enabled: 
# systemctl is-enabled systemd-journald.service 
 
static 
Note: By default the systemd-journald service does not have an [Install] section 
and thus cannot be enabled / disabled. It is meant to be referenced as Requires or 
Wants by other unit files. As such, if the status of systemd-journald is not static, 
investigate why 
Run the following command to verify systemd-journald is active: 
# systemctl is-active systemd-journald.service 
 
active","Run the following commands to unmask and start systemd-journald.service 
# systemctl unmask systemd-journald.service 
# systemctl start systemd-journald.service 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12",,
,,,,,"If the default configuration is not appropriate for the site specific requirements, copy 
/usr/lib/tmpfiles.d/systemd.conf to /etc/tmpfiles.d/systemd.conf and 
modify as required. Requirements is either 0640 or site policy if that is less restrictive. 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, AU-2, AU-12, MP-2, SI-5 
Additional Information: 
See man 5 tmpfiles.d for detailed information on the permission sets for the relevant 
log files. Further information with examples can be found at 
https://www.freedesktop.org/software/systemd/man/tmpfiles.d.html 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1083, 
T1083.000 
TA0007 
M1022",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1083 
T1083.000 
TA0007 
M1022"
,,,,,"Edit /etc/systemd/journald.conf or a file ending in .conf the 
/etc/systemd/journald.conf.d/ directory. Set the following parameters in the 
[Journal] section to ensure logs are rotated according to site policy. The settings 
should be carefully understood as there are specific edge cases and prioritization of 
parameters. 
Example Configuration 
[Journal] 
SystemMaxUse=1G 
SystemKeepFree=500M 
RuntimeMaxUse=200M 
RuntimeKeepFree=50M 
MaxFileSec=1month 
Note: If these settings appear in a canonically later file, or later in the same file, the 
setting will be overwritten 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-7, AU-12 
2. https://man7.org/linux/man-pages/man5/journald.conf.5.html 
Additional Information: 
See man 5 journald.conf for detailed information regarding the parameters in use. 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
● 
● 
● 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source, date, user, timestamp, source addresses, destination addresses, and 
other useful elements. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 "
,,,,"Run the following script to ensure only one logging system is in use: 
#!/usr/bin/env bash 
 
{ 
    l_output="""" l_output2="""" # Check the status of rsyslog and journald 
    if systemctl is-active --quiet rsyslog; then 
        l_output=""$l_output\n - rsyslog is in use\n- follow the 
recommendations in Configure rsyslog subsection only"" 
    elif systemctl is-active --quiet systemd-journald; then 
        l_output=""$l_output\n - journald is in use\n- follow the 
recommendations in Configure journald subsection only"" 
    else 
        echo -e “unable to determine system logging” 
        l_output2=""$l_output2\n - unable to determine system logging\n- 
Configure only ONE system logging: rsyslog OR journald"" 
    fi 
    if [ -z ""$l_output2"" ]; then  # Provide audit results 
        echo -e ""\n- Audit Result:\n  ** PASS **\n$l_output\n"" 
    else 
        echo -e ""\n- Audit Result:\n  ** FAIL **\n - Reason(s) for audit 
failure:\n$l_output2"" 
    fi 
}","1. Determine whether to use journald - OR - rsyslog depending on site needs 
2. Configure systemd-jounald.service 
3. Configure only ONE either journald - OR - rsyslog and complete the 
recommendations in that subsection 
4. Return to this recommendation to ensure only one logging system is in use",,
6.2.2.1.1 Ensure systemd-journal-remote is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","Journald systemd-journal-remote supports the ability to send log events it gathers to 
a remote log host or to receive messages from remote hosts, thus enabling centralized 
log management.","Storing log data on a remote host protects log integrity from local attacks. If an attacker 
gains root access on the local system, they could tamper with or remove log data that is 
stored on the local system. 
Note: This recommendation only applies if journald is the chosen method for 
client side logging. Do not apply this recommendation if rsyslog is used.","- IF - journald will be used for logging on the system: 
Run the following command to verify systemd-journal-remote is installed. 
# rpm -q systemd-journal-remote 
Verify the output matches: 
systemd-journal-remote-<version>","Run the following command to install systemd-journal-remote: 
# dnf install systemd-journal-remote 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12",,
,,,,,"Edit the /etc/systemd/journal-upload.conf file or a file in 
/etc/systemd/journal-upload.conf.d ending in .conf and ensure the following 
lines are set in the [Upload] section per your environment: 
[Upload] 
URL=192.168.50.42 
ServerKeyFile=/etc/ssl/private/journal-upload.pem 
ServerCertificateFile=/etc/ssl/certs/journal-upload.pem 
TrustedCertificateFile=/etc/ssl/ca/trusted.pem 
Restart the service: 
# systemctl restart systemd-journal-upload 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
● 
● 
● 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source, date, user, timestamp, source addresses, destination addresses, and 
other useful elements. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1562, 
T1562.006 
TA0040 
M1029",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1562 
T1562.006 
TA0040 
M1029"
"6.2.2.1.3 Ensure systemd-journal-upload is enabled and active 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","Journald systemd-journal-upload supports the ability to send log events it gathers to 
a remote log host.","Storing log data on a remote host protects log integrity from local attacks. If an attacker 
gains root access on the local system, they could tamper with or remove log data that is 
stored on the local system. 
Note: This recommendation only applies if journald is the chosen method for 
client side logging. Do not apply this recommendation if rsyslog is used.","Run the following command to verify systemd-journal-upload is enabled. 
# systemctl is-enabled systemd-journal-upload.service 
 
enabled 
Run the following command to verify systemd-journal-upload is active: 
# systemctl is-active systemd-journal-upload.service 
 
active","Run the following commands to unmask, enable and start systemd-journal-upload: 
# systemctl unmask systemd-journal-upload.service 
# systemctl --now enable systemd-journal-upload.service 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12",,
,,,,,"Run the following commands to stop and mask systemd-journal-remote.socket and 
systemd-journal-remote.service: 
# systemctl stop systemd-journal-remote.socket systemd-journal-remote.service 
# systemctl mask systemd-journal-remote.socket systemd-journal-remote.service 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-7 AU-12 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1562, 
T1562.006 
TA0040 
M1029",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1562 
T1562.006 
TA0040 
M1029"
,,,,,"- IF - rsyslog is the preferred method for capturing logs, this section and 
Recommendation should be skipped and the ""Configure rsyslog"" section followed. 
- IF - journald is the preferred method for capturing logs: 
Set the following parameter in the [Journal] section in 
/etc/systemd/journald.conf or a file in /etc/systemd/journald.conf.d/ ending in 
.conf: 
ForwardToSyslog=no 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir 
/etc/systemd/journald.conf.d/ 
   if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-
journald.conf; then 
      printf '%s\n' ""ForwardToSyslog=no"" >> /etc/systemd/journald.conf.d/60-
journald.conf 
   else 
      printf '%s\n' ""[Journal]"" ""ForwardToSyslog=no"" >> 
/etc/systemd/journald.conf.d/60-journald.conf 
   fi 
} 
Note: If this setting appears in a canonically later file, or later in the same file, the 
setting will be overwritten 
Run to following command to update the parameters in the service: 
# systemctl reload-or-restart systemd-journald","ForwardToSyslog=no 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-6, AU-7, AU-12",
,,,,,"Set the following parameter in the [Journal] section in 
/etc/systemd/journald.conf or a file in /etc/systemd/journald.conf.d/ ending 
in .conf: 
Compress=yes 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir 
/etc/systemd/journald.conf.d/ 
   if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-
journald.conf; then 
      printf '%s\n' ""Compress=yes"" >> /etc/systemd/journald.conf.d/60-
journald.conf 
   else 
      printf '%s\n' ""[Journal]"" ""Compress=yes"" >> 
/etc/systemd/journald.conf.d/60-journald.conf 
   fi 
} 
Note: If this setting appears in a canonically later file, or later in the same file, the 
setting will be overwritten 
Run to following command to update the parameters in the service: 
# systemctl reload-or-restart systemd-journald 
References: 
1. NIST SP 800-53 Rev. 5: AU-4",,
,,,,,"Set the following parameter in the [Journal] section in 
/etc/systemd/journald.conf or a file in /etc/systemd/journald.conf.d/ ending 
in .conf: 
Storage=persistent 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir 
/etc/systemd/journald.conf.d/ 
   if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-
journald.conf; then 
      printf '%s\n' ""Storage=persistent"" >> /etc/systemd/journald.conf.d/60-
journald.conf 
   else 
      printf '%s\n' ""[Journal]"" ""Storage=persistent"" >> 
/etc/systemd/journald.conf.d/60-journald.conf 
   fi 
} 
Note: If this setting appears in a canonically later file, or later in the same file, the 
setting will be overwritten 
Run to following command to update the parameters in the service: 
# systemctl reload-or-restart systemd-journald 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, AU-12 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
● 
● 
● 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source, date, user, timestamp, source addresses, destination addresses, and 
other useful elements. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 "
6.2.3.1 Ensure rsyslog is installed (Automated)," Level 1 - Server 
 Level 1 - Workstation","The rsyslog software is recommended in environments where journald does not 
meet operation requirements.","The security enhancements of rsyslog such as connection-oriented (i.e. TCP) 
transmission of logs, the option to log to database formats, and the encryption of log 
data en route to a central logging server) justify installing and configuring the package. 
Note: This recommendation only applies if rsyslog is the chosen method for client side 
logging. Do not apply this recommendation if journald is used.","- IF - rsyslog is being used for logging on the system: 
Run the following command to verify rsyslog is installed: 
# rpm -q rsyslog 
Verify the output matches: 
rsyslog-<version>","Run the following command to install rsyslog: 
# dnf install rsyslog","Installed 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12",
6.2.3.2 Ensure rsyslog service is enabled and active (Automated)," Level 1 - Server 
 Level 1 - Workstation","Once the rsyslog package is installed, ensure that the service is enabled.","If the rsyslog service is not enabled to start on boot, the system will not capture 
logging events. 
Note: This recommendation only applies if rsyslog is the chosen method for client side 
logging. Do not apply this recommendation if journald is used.","- IF - rsyslog is being used for logging on the system: 
Run the following command to verify rsyslog.service is enabled: 
# systemctl is-enabled rsyslog 
 
enabled 
Run the following command to verify rsyslog.service is active: 
# systemctl is-active rsyslog.service 
 
active","- IF - rsyslog is being used for logging on the system: 
Run the following commands to unmask, enable, and start rsyslog.service: 
# systemctl unmask rsyslog.service 
# systemctl enable rsyslog.service 
# systemctl start rsyslog.service 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-12",,
,,,,,"- IF - rsyslog is the preferred method for capturing logs: 
Set the following parameter in the [Journal] section in 
/etc/systemd/journald.conf or a file in /etc/systemd/journald.conf.d/ ending 
in .conf: 
ForwardToSyslog=yes 
Example: 
#!/usr/bin/env bash 
 
{ 
   [ ! -d /etc/systemd/journald.conf.d/ ] && mkdir 
/etc/systemd/journald.conf.d/ 
   if grep -Psq -- '^\h*\[Journal\]' /etc/systemd/journald.conf.d/60-
journald.conf; then 
      printf '%s\n' ""ForwardToSyslog=yes"" >> /etc/systemd/journald.conf.d/60-
journald.conf 
   else 
      printf '%s\n' ""[Journal]"" ""ForwardToSyslog=yes"" >> 
/etc/systemd/journald.conf.d/60-journald.conf 
   fi 
} 
Note: If this setting appears in a canonically later file, or later in the same file, the 
setting will be overwritten 
Run to following command to update the parameters in the service: 
Restart systemd-journald.service: 
# systemctl reload-or-restart systemd-journald.service 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, AU-2, AU-4, AU-12, MP-2 
2. SYSTEMD-JOURNALD.SERVICE(8) 
3. JOURNALD.CONF(5) 
Additional Information: 
As noted in the systemd-journald man pages, systemd-journald logs may be 
exported to rsyslog either through the process mentioned here, or through a facility 
like systemd-journald.service. There are trade-offs involved in each 
implementation, where ForwardToSyslog will immediately capture all events (and 
forward to an external log server, if properly configured), but may not capture all boot-up 
activities. Mechanisms such as systemd-journald.service, on the other hand, will 
record bootup events, but may delay sending the information to rsyslog, leading to the 
potential for log manipulation prior to export. Be aware of the limitations of all tools 
employed to secure a system.",,
,,,,,"Edit either /etc/rsyslog.conf or a dedicated .conf file in /etc/rsyslog.d/ and set 
$FileCreateMode to 0640 or more restrictive: 
$FileCreateMode 0640 
Restart the service: 
# systemctl restart rsyslog 
References: 
1. RSYSLOG.CONF(5) 
2. NIST SP 800-53 Rev. 5: AC-3, AC-6, MP-2 
3. https://www.rsyslog.com/doc/ 
4. https://www.rsyslog.com/doc/configuration/action/rsconf1_filecreatemode.html#fil
ecreatemode 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply 
data access control lists, also known as access permissions, to local and remote 
file systems, databases, and applications. 
● 
● 
● 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented, standard security configuration standards for all 
authorized operating systems and software. 
● 
● 
● 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
● 
● 
● 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source, date, user, timestamp, source addresses, destination addresses, and 
other useful elements. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply 
data access control lists also known as access permissions to local and remote 
file systems databases and applications. 
 
 
 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
5.1 Establish Secure Configurations 
 
Maintain documented standard security configuration standards for all 
authorized operating systems and software. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 "
,,,,,"Edit the following lines in the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files 
as appropriate for your environment. 
Note: The below configuration is shown for example purposes only. Due care should be 
given to how the organization wishes to store log data. 
*.emerg                                  :omusrmsg:* 
auth,authpriv.*                          /var/log/secure 
mail.*                                  -/var/log/mail 
mail.info                               -/var/log/mail.info 
mail.warning                            -/var/log/mail.warn 
mail.err                                 /var/log/mail.err 
cron.*                                   /var/log/cron 
*.=warning;*.=err                       -/var/log/warn 
*.crit                                   /var/log/warn 
*.*;mail.none;news.none                 -/var/log/messages 
local0,local1.*                         -/var/log/localmessages 
local2,local3.*                         -/var/log/localmessages 
local4,local5.*                         -/var/log/localmessages 
local6,local7.*                         -/var/log/localmessages 
Run the following command to reload the rsyslogd configuration: 
# systemctl restart rsyslog 
References: 
1. See the rsyslog.conf(5) man page for more information. 
2. NIST SP 800-53 Rev. 5: AU-2, AU-7, AU-12 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
● 
● 
● 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source, date, user, timestamp, source addresses, destination addresses, and 
other useful elements. 
 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v7 
6.2 Activate audit logging 
 
Ensure that local logging has been enabled on all systems and networking 
devices. 
 
 
 
v7 
6.3 Enable Detailed Logging 
 
Enable system logging to include detailed information such as an event 
source date user timestamp source addresses destination addresses and 
other useful elements. 
 
 
 "
,,,,"Review the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and verify that 
logs are sent to a central host: 
Note: The basic format is intended for users that configured their file use 
@loghost.example.com The advanced format is a more modern format that will audit 
formatting similar to that found in the remediation. 
basic format 
# grep ""^*.*[^I][^I]*@"" /etc/rsyslog.conf /etc/rsyslog.d/*.conf 
Output should include @@<FQDN or IP of remote loghost>: 
Example: 
*.* @@loghost.example.com 
advanced format 
# grep -Psi -- '^\s*([^#]+\s+)?action\(([^#]+\s+)?\btarget=\""?[^#""]+\""?\b' 
/etc/rsyslog.conf /etc/rsyslog.d/*.conf 
Output should include target=<FQDN or IP of remote loghost>: 
Example: 
*.* action(type=""omfwd"" target=""loghost.example.com"" port=""514"" 
protocol=""tcp""","Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and add the following 
line (where loghost.example.com is the name of your central log host). The target 
directive may either be a fully qualified domain name or an IP address. 
Example: 
*.* action(type=""omfwd"" target=""loghost.example.com"" port=""514"" 
protocol=""tcp"" 
           action.resumeRetryCount=""100"" 
           queue.type=""LinkedList"" queue.size=""1000"") 
Run the following command to reload rsyslog.service: 
# systemctl reload-or-restart rsyslog.service 
References: 
1. See the rsyslog.conf(5) man page for more information. 
2. NIST SP 800-53 Rev. 5: AU-6 
3. https://www.rsyslog.com/doc/ 
Additional Information: 
In addition, see the rsyslog documentation for implementation details of TLS.",,
,,,,,"Should there be any active log server configuration found in the auditing section, modify 
those files and remove the specific lines highlighted by the audit. Verify none of the 
following entries are present in any of /etc/rsyslog.conf or 
/etc/rsyslog.d/*.conf. 
advanced format 
module(load=""imtcp"") 
input(type=""imtcp"" port=""514"") 
deprecated legacy format 
$ModLoad imtcp 
$InputTCPServerRun 
Restart the service: 
# systemctl restart rsyslog 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-7, AU-12, CM-6 
2. https://www.rsyslog.com/doc/index.html 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software, 
such as an unused file sharing service, web application module, or service 
function. 
 
● 
● 
v7 
9.2 Ensure Only Approved Ports, Protocols and Services 
Are Running 
 
Ensure that only network ports, protocols, and services listening on a system 
with validated business needs, are running on each system. 
 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1562, 
T1562.006 
TA0005, TA0040 
M1029",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
4.8 Uninstall or Disable Unnecessary Services on 
Enterprise Assets and Software 
 
Uninstall or disable unnecessary services on enterprise assets and software 
such as an unused file sharing service web application module or service 
function. 
 
 
 
v7 
9.2 Ensure Only Approved Ports Protocols and Services 
Are Running 
 
Ensure that only network ports protocols and services listening on a system 
with validated business needs are running on each system. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1562 
T1562.006 
TA0005 TA0040 
M1029"
,,,,"Review /etc/logrotate.conf and /etc/logrotate.d/* and verify logs are rotated 
according to site policy. 
#!/usr/bin/env bash 
 
{    
    l_output="""" l_rotate_conf="""" #check for logrotate.conf file 
    if [ -f /etc/logrotate.conf ]; then 
        l_rotate_conf=""/etc/logrotate.conf"" 
    elif compgen -G ""/etc/logrotate.d/*.conf"" 2>/dev/null; then 
        for file in /etc/logrotate.d/*.conf; do 
            l_rotate_conf=""$file""  
        done 
    elif systemctl is-active --quiet systemd-journal-upload.service; then 
        echo -e ""- journald is in use on system\n - recommendation is NA"" 
    else   
        echo -e ""- logrotate is not configured"" 
        l_output=""$l_output\n- rsyslog is in use and logrotate is not 
configured"" 
    fi 
    if [ -z ""$l_output"" ]; then # Provide output from checks 
      echo -e ""\n- Audit Result:\n  ** REVIEW **\n - $l_rotate_conf and 
verify logs are rotated according to site policy."" 
   else 
      echo -e ""\n- Audit Result:\n  ** FAIL **\n - Reason(s) for audit 
failure:\n$l_output"" 
   fi 
}","Edit /etc/logrotate.conf and /etc/logrotate.d/* to ensure logs are rotated 
according to site policy. 
Example logrotate configuration that specifies log files be rotated weekly, keep 4 
backlogs, compress old log files, ignores missing and empty log files, postrotate to 
reload rsyslog service after logs are rotated 
/var/log/rsyslog/*.log { 
    weekly 
    rotate 4 
    compress 
    missingok 
    notifempty 
    postrotate 
            /usr/bin/systemctl reload rsyslog.service >/dev/null || true 
    endscript  
} 
References: 
1. NIST SP 800-53 Rev. 5: AU-8 
2. https://www.rsyslog.com/doc/tutorials/log_rotation_fix_size.html",,
,,,,,"Run the following script to update permissions and ownership on files in /var/log. 
Although the script is not destructive, ensure that the output is captured in the event that 
the remediation causes issues.",,
6.3.1.1 Ensure auditd packages are installed (Automated)," Level 2 - Server 
 Level 2 - Workstation","auditd is the userspace component to the Linux Auditing System. It's responsible for 
writing audit records to the disk.","The capturing of system events provides system administrators with information to allow 
them to determine if unauthorized access to their system is occurring.","Run the following command and verify audit and audit-libs packages are installed: 
# rpm -q audit audit-libs 
 
audit-<version> 
audit-libs-<version>","Run the following command to install audit and audit-libs: 
# dnf install audit audit-libs 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-3, AU-3(1), AU-12, SI-5",,
,,,,,"Run the following command to update the grub2 configuration with audit=1: 
# grubby --update-kernel ALL --args 'audit=1' 
Edit /etc/default/grub and add audit=1 to the GRUB_CMDLINE_LINUX= line between 
the opening and closing double quotes: 
Example: 
GRUB_CMDLINE_LINUX=""quiet audit=1"" 
Note: Other parameters may also be listed 
Additional Information: 
This recommendation is designed around the grub 2 bootloader, if another bootloader is 
in use in your environment enact equivalent settings. 
grubby is a command line tool used to configure bootloader menu entries across 
multiple architectures. It is used for updating and displaying information about the 
configuration files for various architecture specific bootloaders. 
It is primarily designed to be used from scripts which install new kernels and need to 
find information about the current boot environment. 
The grubby executable has full support for the grub2 bootloader on x86_64 systems 
using legacy BIOS or modern UEFI firmware and ppc64 and ppc64le hardware using 
OPAL or SLOF as firmware. 
Legacy s390 and the current s390x architectures and their zipl bootloader are fully 
supported. 
Support for yaboot has been deprecated as all ppc architecture hardware since the 
Power8 uses grub2 or petitboot which both use the grub2 configuration file format. 
Legacy bootloaders LILO, SILO, and ELILO are deprecated and no longer receiving 
active support in favor of previously mentioned bootloaders. 
The default bootloader target is primarily determined by the architecture for which 
grubby has been built. Each architecture has a preferred bootloader, and each 
bootloader has its own configuration file. If no bootloader is selected on the command 
line, grubby will use these default settings to search for an existing configuration. If no 
bootloader configuration file is found, grubby will use the default value for that 
architecture.",,
,,,,,"Run the following command to add audit_backlog_limit=<BACKLOG SIZE> to 
GRUB_CMDLINE_LINUX: 
# grubby --update-kernel ALL --args 'audit_backlog_limit=<BACKLOG SIZE>' 
Example: 
# grubby --update-kernel ALL --args 'audit_backlog_limit=8192' 
Edit /etc/default/grub and add audit_backlog_limit=<BACKLOG SIZE> to the 
GRUB_CMDLINE_LINUX= line between the opening and closing double quotes: 
Example: 
GRUB_CMDLINE_LINUX=""quiet audit_backlog_limit=8192"" 
Note: Other parameters may also be listed 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5",,
6.3.1.4 Ensure auditd service is enabled and active (Automated)," Level 2 - Server 
 Level 2 - Workstation",Turn on the auditd daemon to record system events.,"The capturing of system events provides system administrators with information to allow 
them to determine if unauthorized access to their system is occurring.","Run the following command to verify auditd is enabled: 
# systemctl is-enabled auditd | grep '^enabled' 
 
enabled 
Verify result is ""enabled"". 
Run the following command to verify auditd is active: 
# systemctl is-active auditd | grep '^active' 
 
active 
Verify result is active","Run the following commands to unmask, enable and start auditd: 
# systemctl unmask auditd 
# systemctl enable auditd 
# systemctl start auditd 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5 
Additional Information: 
Additional methods of enabling a service exist. Consult your distribution documentation 
for appropriate methods.",,
6.3.2.1 Ensure audit log storage size is configured (Automated)," Level 2 - Server 
 Level 2 - Workstation","Configure the maximum size of the audit log file. Once the log reaches the maximum 
size, it will be rotated and a new log file will be started.","It is important that an appropriate size is determined for log files so that they do not 
impact the system and audit data is not lost.","Run the following command and ensure output is in compliance with site policy: 
# grep -Po -- '^\h*max_log_file\h*=\h*\d+\b' /etc/audit/auditd.conf 
 
max_log_file = <MB>","Set the following parameter in /etc/audit/auditd.conf in accordance with site 
policy: 
max_log_file = <MB>","max_log_file = 8 
References: 
1. NIST SP 800-53 Rev. 5: AU-8 
Additional Information: 
The max_log_file parameter is measured in megabytes. 
Other methods of log rotation may be appropriate based on site policy. One example is 
time-based rotation strategies which don't have native support in auditd configurations. 
Manual audit of custom configurations should be evaluated for effectiveness and 
completeness.",
"6.3.2.2 Ensure audit logs are not automatically deleted 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation","The max_log_file_action setting determines how to handle the audit log file reaching 
the max file size. A value of keep_logs will rotate the logs but never delete old logs.","In high security contexts, the benefits of maintaining a long audit history exceed the cost 
of storing the audit history.","Run the following command and verify output matches: 
# grep max_log_file_action /etc/audit/auditd.conf 
 
max_log_file_action = keep_logs","Set the following parameter in /etc/audit/auditd.conf: 
max_log_file_action = keep_logs","max_log_file_action = ROTATE 
References: 
1. NIST SP 800-53 Rev. 5: AU-8",
,,,,,"Set one of the following parameters in /etc/audit/auditd.conf depending on your 
local security policies. 
disk_full_action = <halt|single> 
disk_error_action = <syslog|single|halt> 
Example: 
disk_full_action = halt 
disk_error_action = halt 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-8, AU-12, SI-5 
2. AUDITD.CONF(5) 
3. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/8/html/security_hardening/auditing-the-
system_security-hardening#configuring-auditd-for-a-secure-
environment_auditing-the-system 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging, per the enterprise’s audit log 
management process, has been enabled across enterprise assets. 
● 
● 
● 
v8 
8.3 Ensure Adequate Audit Log Storage 
 
Ensure that logging destinations maintain adequate storage to comply with 
the enterprise’s audit log management process. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1562, T1562.006 
TA0005",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
8.2 Collect Audit Logs 
 
Collect audit logs. Ensure that logging per the enterprise s audit log 
management process has been enabled across enterprise assets. 
 
 
 
v8 
8.3 Ensure Adequate Audit Log Storage 
 
Ensure that logging destinations maintain adequate storage to comply with 
the enterprise s audit log management process. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1562 T1562.006 
TA0005"
,,,"In high security contexts, the risk of detecting unauthorized access or nonrepudiation 
exceeds the benefit of the system's availability. 
Impact: 
If the admin_space_left_action is set to single the audit daemon will put the 
computer system in single user mode.","Run the following command and verify the space_left_action is set to email, exec, 
single, or halt: 
grep -P -- '^\h*space_left_action\h*=\h*(email|exec|single|halt)\b' 
/etc/audit/auditd.conf 
Verify the output is email, exec, single, or halt 
Example output 
space_left_action = email 
Run the following command and verify the admin_space_left_action is set to single 
- OR - halt: 
grep -P -- '^\h*admin_space_left_action\h*=\h*(single|halt)\b' 
/etc/audit/auditd.conf 
Verify the output is single or halt 
Example output: 
admin_space_left_action = single 
Note: A Mail Transfer Agent (MTA) must be installed and configured properly to set 
space_left_action = email","Set the space_left_action parameter in /etc/audit/auditd.conf to email, exec, 
single, or halt: 
Example: 
space_left_action = email 
Set the admin_space_left_action parameter in /etc/audit/auditd.conf to 
single or halt: 
Example: 
admin_space_left_action = single 
Note: A Mail Transfer Agent (MTA) must be installed and configured properly to set 
space_left_action = email",,
,,,,"On disk configuration 
Run the following command to check the on disk rules: 
# awk '/^ *-w/ \ 
&&/\/etc\/sudoers/ \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules 
Verify the output matches: 
-w /etc/sudoers -p wa -k scope 
-w /etc/sudoers.d -p wa -k scope 
Running configuration 
Run the following command to check loaded rules: 
# auditctl -l | awk '/^ *-w/ \ 
&&/\/etc\/sudoers/ \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' 
Verify the output matches: 
-w /etc/sudoers -p wa -k scope 
-w /etc/sudoers.d -p wa -k scope","Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor scope changes for system administrators. 
Example: 
# printf '%s\n' ""-w /etc/sudoers -p wa -k scope"" ""-w /etc/sudoers.d -p wa -k 
scope"" >> /etc/audit/rules.d/50-scope.rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor elevated privileges. 
Example: 
# printf "" 
-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k 
user_emulation  
-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k 
user_emulation 
"" >> /etc/audit/rules.d/50-user_emulation.rules 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Note: This recommendation requires that the sudo logfile is configured. See guidance 
provided in the recommendation ""Ensure sudo log file exists"" 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor events that modify the sudo log file. 
Example: 
# { 
SUDO_LOG_FILE=$(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,? 
.*//' -e 's/""//g') 
[ -n ""${SUDO_LOG_FILE}"" ] && printf "" 
-w ${SUDO_LOG_FILE} -p wa -k sudo_log_file 
"" >> /etc/audit/rules.d/50-sudo.rules || printf ""ERROR: Variable 
'SUDO_LOG_FILE' is unset.\n"" 
} 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor events that modify date and time information. 
Example: 
# printf "" 
-a always,exit -F arch=b64 -S adjtimex,settimeofday -k time-change 
-a always,exit -F arch=b32 -S adjtimex,settimeofday -k time-change 
-a always,exit -F arch=b64 -S clock_settime -F a0=0x0 -k time-change 
-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -k time-change 
-w /etc/localtime -p wa -k time-change 
"" >> /etc/audit/rules.d/50-time-change.rules 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, CM-6 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor events that modify the system's network environment. 
Example: 
# printf "" 
-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale 
-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale 
-w /etc/issue -p wa -k system-locale 
-w /etc/issue.net -p wa -k system-locale 
-w /etc/hosts -p wa -k system-locale 
-w /etc/hostname -p wa -k system-locale 
-w /etc/sysconfig/network -p wa -k system-locale 
-w /etc/sysconfig/network-scripts/ -p wa -k system-locale 
-w /etc/NetworkManager -p wa -k system-locale 
"" >> /etc/audit/rules.d/50-system_locale.rules 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required.",,
,,,,,"Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor the use of privileged commands. 
Example script: 
#!/usr/bin/env bash 
 
{ 
  UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
  AUDIT_RULE_FILE=""/etc/audit/rules.d/50-privileged.rules"" 
  NEW_DATA=() 
  for PARTITION in $(findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' 
/proc/filesystems | paste -sd,) | grep -Pv ""noexec|nosuid"" | awk '{print 
$1}'); do 
    readarray -t DATA < <(find ""${PARTITION}"" -xdev -perm /6000 -type f | awk 
-v UID_MIN=${UID_MIN} '{print ""-a always,exit -F path="" $1 "" -F perm=x -F 
auid>=""UID_MIN"" -F auid!=unset -k privileged"" }') 
      for ENTRY in ""${DATA[@]}""; do 
        NEW_DATA+=(""${ENTRY}"") 
      done 
  done 
  readarray &> /dev/null -t OLD_DATA < ""${AUDIT_RULE_FILE}"" 
  COMBINED_DATA=( ""${OLD_DATA[@]}"" ""${NEW_DATA[@]}"" ) 
  printf '%s\n' ""${COMBINED_DATA[@]}"" | sort -u > ""${AUDIT_RULE_FILE}"" 
} 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
Special mount points 
If there are any special mount points that are not visible by default from just scanning /, 
change the PARTITION variable to the appropriate partition and re-run the remediation. 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, AU-3(1)",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor unsuccessful file access attempts. 
Example: 
# { 
UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
[ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-
EACCES -F auid>=${UID_MIN} -F auid!=unset -k access 
-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-
EPERM -F auid>=${UID_MIN} -F auid!=unset -k access 
-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-
EACCES -F auid>=${UID_MIN} -F auid!=unset -k access 
-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-
EPERM -F auid>=${UID_MIN} -F auid!=unset -k access 
"" >> /etc/audit/rules.d/50-access.rules || printf ""ERROR: Variable 'UID_MIN' 
is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
,,,,,"Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor events that modify user/group information. 
Example: 
# printf "" 
-w /etc/group -p wa -k identity 
-w /etc/passwd -p wa -k identity 
-w /etc/gshadow -p wa -k identity 
-w /etc/shadow -p wa -k identity 
-w /etc/security/opasswd -p wa -k identity 
-w /etc/nsswitch.conf -p wa -k identity 
-w /etc/pam.conf -p wa -k identity 
-w /etc/pam.d -p wa -k identity 
"" >> /etc/audit/rules.d/50-identity.rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3 
2. https://manpages.debian.org/bookworm/manpages/nsswitch.conf.5.en.html 
3. https://access.redhat.com/documentation/en-
us/red_hat_enterprise_linux/6/html/managing_smart_cards/pam_configuration_fil
es",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor discretionary access control permission modification 
events. 
Example: 
# { 
UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
[ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=${UID_MIN} -F 
auid!=unset -F key=perm_mod 
-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F 
auid>=${UID_MIN} -F auid!=unset -F key=perm_mod 
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=${UID_MIN} -F 
auid!=unset -F key=perm_mod 
-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F 
auid>=${UID_MIN} -F auid!=unset -F key=perm_mod 
-a always,exit -F arch=b64 -S 
setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F 
auid>=${UID_MIN} -F auid!=unset -F key=perm_mod 
-a always,exit -F arch=b32 -S 
setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F 
auid>=${UID_MIN} -F auid!=unset -F key=perm_mod 
"" >> /etc/audit/rules.d/50-perm_mod.rules || printf ""ERROR: Variable 
'UID_MIN' is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, CM-6",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor successful file system mounts. 
Example: 
# { 
UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
[ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F arch=b32 -S mount -F auid>=$UID_MIN -F auid!=unset -k 
mounts 
-a always,exit -F arch=b64 -S mount -F auid>=$UID_MIN -F auid!=unset -k 
mounts 
"" >> /etc/audit/rules.d/50-mounts.rules || printf ""ERROR: Variable 'UID_MIN' 
is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: CM-6 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor session initiation information. 
Example: 
# printf "" 
-w /var/run/utmp -p wa -k session 
-w /var/log/wtmp -p wa -k session 
-w /var/log/btmp -p wa -k session 
"" >> /etc/audit/rules.d/50-session.rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, AU-3 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,"On disk configuration 
Run the following command to check the on disk rules: 
# awk '/^ *-w/ \ 
&&(/\/var\/log\/lastlog/ \ 
  ||/\/var\/run\/faillock/) \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules 
Verify the output matches: 
-w /var/log/lastlog -p wa -k logins 
-w /var/run/faillock -p wa -k logins 
Running configuration 
Run the following command to check loaded rules: 
# auditctl -l | awk '/^ *-w/ \ 
&&(/\/var\/log\/lastlog/ \ 
  ||/\/var\/run\/faillock/) \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' 
Verify the output matches: 
-w /var/log/lastlog -p wa -k logins 
-w /var/run/faillock -p wa -k logins","Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor login and logout events. 
Example: 
# printf "" 
-w /var/log/lastlog -p wa -k logins 
-w /var/run/faillock -p wa -k logins 
"" >> /etc/audit/rules.d/50-login.rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor file deletion events by users. 
Example: 
# { 
UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
[ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F 
auid>=${UID_MIN} -F auid!=unset -F key=delete 
-a always,exit -F arch=b32 -S rename,unlink,unlinkat,renameat -F 
auid>=${UID_MIN} -F auid!=unset -F key=delete 
"" >> /etc/audit/rules.d/50-delete.rules || printf ""ERROR: Variable 'UID_MIN' 
is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-12, SC-7 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,"On disk configuration 
Run the following command to check the on disk rules: 
# awk '/^ *-w/ \ 
&&(/\/etc\/selinux/ \ 
  ||/\/usr\/share\/selinux/) \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules 
Verify the output matches: 
-w /etc/selinux -p wa -k MAC-policy 
-w /usr/share/selinux -p wa -k MAC-policy 
Running configuration 
Run the following command to check loaded rules: 
# auditctl -l | awk '/^ *-w/ \ 
&&(/\/etc\/selinux/ \ 
  ||/\/usr\/share\/selinux/) \ 
&&/ +-p *wa/ \ 
&&(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' 
Verify the output matches: 
-w /etc/selinux -p wa -k MAC-policy 
-w /usr/share/selinux -p wa -k MAC-policy","Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor events that modify the system's Mandatory Access 
Controls. 
Example: 
# printf "" 
-w /etc/selinux -p wa -k MAC-policy 
-w /usr/share/selinux -p wa -k MAC-policy 
"" >> /etc/audit/rules.d/50-MAC-policy.rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, CM-6",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor successful and unsuccessful attempts to use the 
chcon command. 
Example: 
# { 
 UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
 [ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid>=${UID_MIN} -F 
auid!=unset -k perm_chng 
"" >> /etc/audit/rules.d/50-perm_chng.rules || printf ""ERROR: Variable 
'UID_MIN' is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor successful and unsuccessful attempts to use the 
setfacl command. 
Example: 
# { 
 UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
 [ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid>=${UID_MIN} -F 
auid!=unset -k perm_chng 
"" >> /etc/audit/rules.d/50-perm_chng.rules || printf ""ERROR: Variable 
'UID_MIN' is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor successful and unsuccessful attempts to use the 
chacl command. 
Example: 
# { 
 UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
 [ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid>=${UID_MIN} -F 
auid!=unset -k perm_chng 
"" >> /etc/audit/rules.d/50-perm_chng.rules || printf ""ERROR: Variable 
'UID_MIN' is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor successful and unsuccessful attempts to use the 
usermod command. 
Example: 
# { 
 UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
 [ -n ""${UID_MIN}"" ] && printf "" 
-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid>=${UID_MIN} -F 
auid!=unset -k usermod 
"" >> /etc/audit/rules.d/50-usermod.rules || printf ""ERROR: Variable 'UID_MIN' 
is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-2, AU-12, SI-5 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
,,,,,"Create audit rules 
Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, 
with the relevant rules to monitor kernel module modification. 
Example: 
#!/usr/bin/env bash 
 
{ 
  UID_MIN=$(awk '/^\s*UID_MIN/{print $2}' /etc/login.defs) 
  [ -n ""${UID_MIN}"" ] && printf "" 
  -a always,exit -F arch=b64 -S 
init_module,finit_module,delete_module,create_module,query_module -F 
auid>=${UID_MIN} -F auid!=unset -k kernel_modules 
  -a always,exit -F path=/usr/bin/kmod -F perm=x -F auid>=${UID_MIN} -F 
auid!=unset -k kernel_modules 
  "" >> /etc/audit/rules.d/50-kernel_modules.rules || printf ""ERROR: Variable 
'UID_MIN' is unset.\n"" 
} 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3, CM-6 
Additional Information: 
Potential reboot required 
If the auditing configuration is locked (-e 2), then augenrules will not warn in any way 
that rules could not be loaded into the running configuration. A system reboot will be 
required to load the rules into the running configuration. 
System call structure 
For performance (man 7 audit.rules) reasons it is preferable to have all the system 
calls on one line. However, your configuration may have them on one line each or some 
other combination. This is important to understand for both the auditing and remediation 
sections as the examples given are optimized for performance as per the man page.",,
6.3.3.20 Ensure the audit configuration is immutable (Automated)," Level 2 - Server 
 Level 2 - Workstation","Set system audit so that audit rules cannot be modified with auditctl . Setting the flag 
""-e 2"" forces audit to be put in immutable mode. Audit changes can only be made on 
system reboot. 
Note: This setting will require the system to be rebooted to update the active auditd 
configuration settings.","In immutable mode, unauthorized users cannot execute changes to the audit system to 
potentially hide malicious activity and then put the audit rules back. Users would most 
likely notice a system reboot and that could alert administrators of an attempt to make 
unauthorized audit changes.","Run the following command and verify output matches: 
# grep -Ph -- '^\h*-e\h+2\b' /etc/audit/rules.d/*.rules | tail -1 
 
-e 2","Edit or create the file /etc/audit/rules.d/99-finalize.rules and add the line -e 
2 at the end of the file: 
Example: 
# printf '\n%s' ""-e 2"" >> /etc/audit/rules.d/99-finalize.rules 
Load audit rules 
Merge and load the rules into active configuration: 
# augenrules --load 
Check if reboot is required. 
# if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then printf ""Reboot 
required to load rules\n""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, AU-3, AU-3(1), MP-2",,
"6.3.3.21 Ensure the running and on disk configuration is the same 
(Manual)"," Level 2 - Server 
 Level 2 - Workstation","The Audit system have both on disk and running configuration. It is possible for these 
configuration settings to differ. 
Note: Due to the limitations of augenrules and auditctl, it is not absolutely 
guaranteed that loading the rule sets via augenrules --load will result in all rules 
being loaded or even that the user will be informed if there was a problem loading the 
rules.","Configuration differences between what is currently running and what is on disk could 
cause unexpected problems or may give a false impression of compliance 
requirements.","Merged rule sets 
Ensure that all rules in /etc/audit/rules.d have been merged into 
/etc/audit/audit.rules: 
# augenrules --check 
 
/usr/sbin/augenrules: No change 
Should there be any drift, run augenrules --load to merge and load all rules.","If the rules are not aligned across all three () areas, run the following command to 
merge and load all rules: 
# augenrules --load 
Check if reboot is required. 
if [[ $(auditctl -s | grep ""enabled"") =~ ""2"" ]]; then echo ""Reboot required 
to load rules""; fi 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
,,,,"Run the following script to verify the audit log directory is mode 0750 or more restrictive: 
#!/usr/bin/env bash 
 
{ 
   l_perm_mask=""0027"" 
   if [ -e ""/etc/audit/auditd.conf"" ]; then 
      l_audit_log_directory=""$(dirname ""$(awk -F= '/^\s*log_file\s*/{print 
$2}' /etc/audit/auditd.conf | xargs)"")"" 
      if [ -d ""$l_audit_log_directory"" ]; then 
         l_maxperm=""$(printf '%o' $(( 0777 & ~$l_perm_mask )) )"" 
         l_directory_mode=""$(stat -Lc '%#a' ""$l_audit_log_directory"")"" 
         if [ $(( $l_directory_mode & $l_perm_mask )) -gt 0 ]; then 
            echo -e ""\n- Audit Result:\n  ** FAIL **\n  - Directory: 
\""$l_audit_log_directory\"" is mode: \""$l_directory_mode\""\n     (should be 
mode: \""$l_maxperm\"" or more restrictive)\n"" 
         else 
            echo -e ""\n- Audit Result:\n  ** PASS **\n  - Directory: 
\""$l_audit_log_directory\"" is mode: \""$l_directory_mode\""\n     (should be 
mode: \""$l_maxperm\"" or more restrictive)\n"" 
         fi         
      else 
         echo -e ""\n- Audit Result:\n  ** FAIL **\n  - Log file directory not 
set in \""/etc/audit/auditd.conf\"" please set log file directory"" 
      fi 
   else 
      echo -e ""\n- Audit Result:\n  ** FAIL **\n  - File: 
\""/etc/audit/auditd.conf\"" not found\n  - ** Verify auditd is installed **"" 
   fi 
}","Run the following command to configure the audit log directory to have a mode of 
""0750"" or less permissive: 
# chmod g-w,o-rwx ""$(dirname ""$(awk -F= '/^\s*log_file\s*/{print $2}' 
/etc/audit/auditd.conf | xargs)"")""","750 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",
,,,,,"Run the following command to remove more permissive mode than 0640 from audit log 
files: 
# [ -f /etc/audit/auditd.conf ] && find ""$(dirname $(awk -F ""="" 
'/^\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))"" -type f -perm 
/0137 -exec chmod u-x,g-wx,o-rwx {} + 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1083, 
T1083.000 
TA0007",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1083 
T1083.000 
TA0007"
,,,,"Run the following script to verify audit log files are owned by the root user: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" 
   l_perm_mask=""0177"" 
   if [ -e ""/etc/audit/auditd.conf"" ]; then 
      l_audit_log_directory=""$(dirname ""$(awk -F= '/^\s*log_file\s*/{print 
$2}' /etc/audit/auditd.conf | xargs)"")"" 
      if [ -d ""$l_audit_log_directory"" ]; then 
         l_maxperm=""$(printf '%o' $(( 0777 & ~$l_perm_mask )) )"" 
         while IFS= read -r -d $'\0' l_file; do 
            l_output2=""$l_output2\n  - File: \""$l_file\"" is mode: \""$(stat -
Lc '%#a' ""$l_file"")\""\n     (should be mode: \""$l_maxperm\"" or more 
restrictive)\n"" 
         done < <(find ""$l_audit_log_directory"" -maxdepth 1 -type f -perm 
/""$l_perm_mask"" -print0) 
      else 
         l_output2=""$l_output2\n  - Log file directory not set in 
\""/etc/audit/auditd.conf\"" please set log file directory"" 
      fi 
   else 
      l_output2=""$l_output2\n  - File: \""/etc/audit/auditd.conf\"" not 
found.\n  - ** Verify auditd is installed **"" 
   fi 
   if [ -z ""$l_output2"" ]; then 
      l_output=""$l_output\n  - All files in \""$l_audit_log_directory\"" are 
mode: \""$l_maxperm\"" or more restrictive"" 
      echo -e ""\n- Audit Result:\n  ** PASS **\n - * Correctly configured * 
:$l_output"" 
   else 
      echo -e ""\n- Audit Result:\n  ** FAIL **\n - * Reasons for audit 
failure * :$l_output2\n"" 
   fi 
}","Run the following command to configure the audit log files to be owned by the root 
user: 
# [ -f /etc/audit/auditd.conf ] && find ""$(dirname $(awk -F ""="" 
'/^\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))"" -type f ! -user 
root -exec chown root {} + 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
,,,,,"Run the following command to configure the audit log files to be owned by adm group: 
# find $(dirname $(awk -F""="" '/^\s*log_file\s*=\s*/ {print $2}' 
/etc/audit/auditd.conf | xargs)) -type f \( ! -group adm -a ! -group root \) 
-exec chgrp adm {} + 
Run the following command to configure the audit log files to be owned by the adm 
group: 
# chgrp adm /var/log/audit/ 
Run the following command to set the log_group parameter in the audit configuration 
file to log_group = adm: 
# sed -ri 's/^\s*#?\s*log_group\s*=\s*\S+(\s*#.*)?.*$/log_group = adm\1/' 
/etc/audit/auditd.conf 
Run the following command to restart the audit daemon to reload the configuration file: 
# systemctl restart auditd 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1083, 
T1083.000 
TA0007",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1083 
T1083.000 
TA0007"
,,,,,"Run the following command to remove more permissive mode than 0640 from the audit 
configuration files: 
# find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) -exec 
chmod u-x,g-wx,o-rwx {} + 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1070, T1070.002, T1083, 
T1083.000 
TA0007",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1070 T1070.002 T1083 
T1083.000 
TA0007"
"6.3.4.6 Ensure audit configuration files owner is configured 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation",Audit configuration files control auditd and what events are audited.,"Access to the audit configuration files could allow unauthorized personnel to prevent the 
auditing of critical events. 
Misconfigured audit configuration files may prevent the auditing of critical events or 
impact the system's performance by overwhelming the audit log. Misconfiguration of the 
audit configuration files may also make it more difficult to establish and investigate 
events relating to an incident.","Run the following command to verify that the audit configuration files have mode 640 or 
more restrictive and are owned by the root user and root group: 
# find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -user 
root 
Nothing should be returned","Run the following command to change ownership to root user: 
# find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -user 
root -exec chown root {} +",,
"6.3.4.7 Ensure audit configuration files group owner is configured 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation",Audit configuration files control auditd and what events are audited.,"Access to the audit configuration files could allow unauthorized personnel to prevent the 
auditing of critical events. 
Misconfigured audit configuration files may prevent the auditing of critical events or 
impact the system's performance by overwhelming the audit log. Misconfiguration of the 
audit configuration files may also make it more difficult to establish and investigate 
events relating to an incident.","Run the following command to verify that the audit configuration files are owned by the 
group root: 
# find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -group 
root 
Nothing should be returned","Run the following command to change group to root: 
# find /etc/audit/ -type f \( -name '*.conf' -o -name '*.rules' \) ! -group 
root -exec chgrp root {} +",,
,,,,"Run the following script to verify the audit tools are mode 0755 or more restrictive: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" l_perm_mask=""0022"" 
   l_maxperm=""$( printf '%o' $(( 0777 & ~$l_perm_mask )) )"" 
   a_audit_tools=(""/sbin/auditctl"" ""/sbin/aureport"" ""/sbin/ausearch"" 
""/sbin/autrace"" ""/sbin/auditd"" ""/sbin/augenrules"") 
   for l_audit_tool in ""${a_audit_tools[@]}""; do 
      l_mode=""$(stat -Lc '%#a' ""$l_audit_tool"")"" 
      if [ $(( ""$l_mode"" & ""$l_perm_mask"" )) -gt 0 ]; then 
         l_output2=""$l_output2\n - Audit tool \""$l_audit_tool\"" is mode: 
\""$l_mode\"" and should be mode: \""$l_maxperm\"" or more restrictive"" 
      else 
         l_output=""$l_output\n - Audit tool \""$l_audit_tool\"" is correctly 
configured to mode: \""$l_mode\"""" 
      fi 
   done 
   if [ -z ""$l_output2"" ]; then 
      echo -e ""\n- Audit Result:\n  ** PASS **\n - * Correctly configured * 
:$l_output"" 
   else 
      echo -e ""\n- Audit Result:\n  ** FAIL **\n - * Reasons for audit 
failure * :$l_output2\n"" 
      [ -n ""$l_output"" ] && echo -e ""\n - * Correctly configured * 
:\n$l_output\n"" 
   fi 
   unset a_audit_tools 
}","Run the following command to remove more permissive mode from the audit tools: 
# chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace 
/sbin/auditd /sbin/augenrules 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
6.3.4.9 Ensure audit tools owner is configured (Automated)," Level 2 - Server 
 Level 2 - Workstation","Audit tools include, but are not limited to, vendor-provided and open source audit tools 
needed to successfully view and manipulate audit information system activity and 
records. Audit tools include custom queries and report generators.","Protecting audit information includes identifying and protecting the tools used to view 
and manipulate log data. Protecting audit tools is necessary to prevent unauthorized 
operation on audit information.","Run the following command to verify the audit tools are owned by the root user: 
# stat -Lc ""%n %U"" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace 
/sbin/auditd /sbin/augenrules | awk '$2 != ""root"" {print}' 
Nothing should be returned","Run the following command to change the owner of the audit tools to the root user: 
# chown root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace 
/sbin/auditd /sbin/augenrules 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
●",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 "
"6.3.4.10 Ensure audit tools group owner is configured 
(Automated)"," Level 2 - Server 
 Level 2 - Workstation","Audit tools include, but are not limited to, vendor-provided and open source audit tools 
needed to successfully view and manipulate audit information system activity and 
records. Audit tools include custom queries and report generators.","Protecting audit information includes identifying and protecting the tools used to view 
and manipulate log data. Protecting audit tools is necessary to prevent unauthorized 
operation on audit information.","Run the following command to verify the audit tools are owned by the group root 
# stat -Lc ""%n %G"" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace 
/sbin/auditd /sbin/augenrules | awk '$2 != ""root"" {print}' 
Nothing should be returned","Run the following command to change group ownership to the groop root: 
# chgrp root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace 
/sbin/auditd /sbin/augenrules 
References: 
1. NIST SP 800-53 Rev. 5: AU-3",,
"7.1.1 Ensure permissions on /etc/passwd are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/passwd file contains user account information that is used by many system 
utilities and therefore must be readable for these utilities to operate.","It is critical to ensure that the /etc/passwd file is protected from unauthorized write 
access. Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/passwd is mode 644 or more restrictive, Uid 
is 0/root and Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/passwd 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to remove excess permissions, set owner, and set group 
on /etc/passwd: 
# chmod u-x,go-wx /etc/passwd 
# chown root:root /etc/passwd","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.2 Ensure permissions on /etc/passwd- are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation",The /etc/passwd- file contains backup user account information.,"It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. 
Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/passwd- is mode 644 or more restrictive, 
Uid is 0/root and Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: { %g/ %G)' /etc/passwd- 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: { 0/ root)","Run the following commands to remove excess permissions, set owner, and set group 
on /etc/passwd-: 
# chmod u-x,go-wx /etc/passwd- 
# chown root:root /etc/passwd-","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: { 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.3 Ensure permissions on /etc/group are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/group file contains a list of all the valid groups defined in the system. The 
command below allows read/write access for root and read access for everyone else.","The /etc/group file needs to be protected from unauthorized changes by non-
privileged users, but needs to be readable as this information is used with many non-
privileged programs.","Run the following command to verify /etc/group is mode 644 or more restrictive, Uid 
is 0/root and Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/group 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to remove excess permissions, set owner, and set group 
on /etc/group: 
# chmod u-x,go-wx /etc/group 
# chown root:root /etc/group","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.4 Ensure permissions on /etc/group- are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/group- file contains a backup list of all the valid groups defined in the 
system.","It is critical to ensure that the /etc/group- file is protected from unauthorized access. 
Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/group- is mode 644 or more restrictive, Uid 
is 0/root and Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/group- 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to remove excess permissions, set owner, and set group 
on /etc/group-: 
# chmod u-x,go-wx /etc/group- 
# chown root:root /etc/group-","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.5 Ensure permissions on /etc/shadow are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/shadow file is used to store the information about user accounts that is critical 
to the security of those accounts, such as the hashed password and other security 
information.","If attackers can gain read access to the /etc/shadow file, they can easily run a 
password cracking program against the hashed password to break it. Other security 
information that is stored in the /etc/shadow file (such as expiration) could also be 
useful to subvert the user accounts.","Run the following command to verify /etc/shadow is mode 000, Uid is 0/root and Gid 
is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow 
 
Access: (0/----------)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to set mode, owner, and group on /etc/shadow: 
# chown root:root /etc/shadow 
# chmod 0000 /etc/shadow","Access: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.6 Ensure permissions on /etc/shadow- are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/shadow- file is used to store backup information about user accounts that is 
critical to the security of those accounts, such as the hashed password and other 
security information.","It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. 
Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/shadow- is mode 000, Uid is 0/root and 
Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/shadow- 
 
Access: (0/----------)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to set mode, owner, and group on /etc/shadow-: 
# chown root:root /etc/shadow- 
# chmod 0000 /etc/shadow-","Access: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.7 Ensure permissions on /etc/gshadow are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/gshadow file is used to store the information about groups that is critical to 
the security of those accounts, such as the hashed password and other security 
information.","If attackers can gain read access to the /etc/gshadow file, they can easily run a 
password cracking program against the hashed password to break it. Other security 
information that is stored in the /etc/gshadow file (such as group administrators) could 
also be useful to subvert the group.","Run the following command to verify /etc/gshadow is mode 000, Uid is 0/root and 
Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow 
 
Access: (0/----------)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to set mode, owner, and group on /etc/gshadow: 
# chown root:root /etc/gshadow 
# chmod 0000 /etc/gshadow","Access: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.8 Ensure permissions on /etc/gshadow- are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","The /etc/gshadow- file is used to store backup information about groups that is critical 
to the security of those accounts, such as the hashed password and other security 
information.","It is critical to ensure that the /etc/gshadow- file is protected from unauthorized 
access. Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/gshadow- is mode 000, Uid is 0/root and 
Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)'  /etc/gshadow- 
 
Access: (0/----------)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to set mode, owner, and group on /etc/gshadow-: 
# chown root:root /etc/gshadow- 
# chmod 0000 /etc/gshadow-","Access: (0/----------) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
"7.1.9 Ensure permissions on /etc/shells are configured 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","/etc/shells is a text file which contains the full pathnames of valid login shells. This 
file is consulted by chsh and available to be queried by other programs.","It is critical to ensure that the /etc/shells file is protected from unauthorized access. 
Although it is protected by default, the file permissions could be changed either 
inadvertently or through malicious actions.","Run the following command to verify /etc/shells is mode 644 or more restrictive, Uid 
is 0/root and Gid is 0/root: 
# stat -Lc 'Access: (%#a/%A)  Uid: ( %u/ %U) Gid: ( %g/ %G)' /etc/shells 
 
Access: (0644/-rw-r--r--)  Uid: ( 0/ root) Gid: ( 0/ root)","Run the following commands to remove excess permissions, set owner, and set group 
on /etc/shells: 
# chmod u-x,go-wx /etc/shells 
# chown root:root /etc/shells","Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2",
,,,,,"Run the following commands to remove excess permissions, set owner, and set group 
on /etc/security/opasswd and /etc/security/opasswd.old is they exist: 
# [ -e ""/etc/security/opasswd"" ] && chmod u-x,go-rwx /etc/security/opasswd 
# [ -e ""/etc/security/opasswd"" ] && chown root:root /etc/security/opasswd 
# [ -e ""/etc/security/opasswd.old"" ] && chmod u-x,go-rwx 
/etc/security/opasswd.old 
# [ -e ""/etc/security/opasswd.old"" ] && chown root:root 
/etc/security/opasswd.old","/etc/security/opasswd Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root) 
References: 
1. NIST SP 800-53 Rev. 5: AC-3, MP-2","Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1003 T1003.008 T1222 
T1222.002 
TA0005 
M1022"
,,,,,"• 
World Writable Files: 
o It is recommended that write access is removed from other with the 
command ( chmod o-w <filename> ), but always consult relevant vendor 
documentation to avoid breaking any application dependencies on a given 
file. 
• 
World Writable Directories: 
o Set the sticky bit on all world writable directories with the command ( 
chmod a+t <directory_name> ) 
Run the following script to: 
• 
Remove other write permission from any world writable files 
• 
Add the sticky bit to all world writable directories 
#!/usr/bin/env bash 
 
{ 
   l_smask='01000' 
   a_file=(); a_dir=() # Initialize arrays 
   a_path=(! -path ""/run/user/*"" -a ! -path ""/proc/*"" -a ! -path 
""*/containerd/*"" -a ! -path ""*/kubelet/pods/*"" -a ! -path 
""*/kubelet/plugins/*"" -a ! -path ""/sys/*"" -a ! -path ""/snap/*"") 
   while IFS= read -r l_mount; do 
      while IFS= read -r -d $'\0' l_file; do 
         if [ -e ""$l_file"" ]; then 
            l_mode=""$(stat -Lc '%#a' ""$l_file"")"" 
            if [ -f ""$l_file"" ]; then # Remove excess permissions from WW 
files 
               echo -e "" - File: \""$l_file\"" is mode: \""$l_mode\""\n  - 
removing write permission on \""$l_file\"" from \""other\"""" 
               chmod o-w ""$l_file"" 
            fi 
            if [ -d ""$l_file"" ]; then # Add sticky bit 
               if [ ! $(( $l_mode & $l_smask )) -gt 0 ]; then 
                  echo -e "" - Directory: \""$l_file\"" is mode: \""$l_mode\"" and 
doesn't have the sticky bit set\n  - Adding the sticky bit"" 
                  chmod a+t ""$l_file"" 
               fi 
            fi 
         fi 
      done < <(find ""$l_mount"" -xdev \( ""${a_path[@]}"" \) \( -type f -o -type 
d \) -perm -0002 -print0 2> /dev/null) 
   done < <(findmnt -Dkerno fstype,target | awk '($1 !~ 
/^\s*(nfs|proc|smb|vfat|iso9660|efivarfs|selinuxfs)/ && $2 !~ 
/^(\/run\/user\/|\/tmp|\/var\/tmp)/){print $2}')  
} 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2",,
,,,,,"Remove or set ownership and group ownership of these files and/or directories to an 
active user on the system as appropriate. 
References: 
1. NIST SP 800-53 Rev. 5: AC-3. MP-2 
CIS Controls: 
Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user’s need to know. Apply data 
access control lists, also known as access permissions, to local and remote file 
systems, databases, and applications. 
● 
● 
● 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system, network share, 
claims, application, or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
● 
● 
● 
 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1222, T1222.002 
TA0007 
M1022",,"Controls 
Version 
Control 
IG 1 IG 2 IG 3 
v8 
3.3 Configure Data Access Control Lists 
 
Configure data access control lists based on a user s need to know. Apply data 
access control lists also known as access permissions to local and remote file 
systems databases and applications. 
 
 
 
v7 
14.6 Protect Information through Access Control Lists 
 
Protect all information stored on systems with file system network share 
claims application or database specific access control lists. These controls will 
enforce the principle that only authorized individuals should have access to the 
information based on their need to access the information as a part of their 
responsibilities. 
 
 
 
 
MITRE ATT CK Mappings 
Techniques Sub-
techniques 
Tactics 
Mitigations 
T1222 T1222.002 
TA0007 
M1022"
,,,,"Run the following script to generate a list of SUID and SGID files: 
#!/usr/bin/env bash 
 
{ 
   l_output="""" l_output2="""" 
   a_suid=(); a_sgid=() # initialize arrays 
   while IFS= read -r l_mount; do 
      while  IFS= read -r -d $'\0' l_file; do 
         if [ -e ""$l_file"" ]; then 
            l_mode=""$(stat -Lc '%#a' ""$l_file"")"" 
            [ $(( $l_mode & 04000 )) -gt 0 ] && a_suid+=(""$l_file"") 
            [ $(( $l_mode & 02000 )) -gt 0 ] && a_sgid+=(""$l_file"") 
         fi 
      done < <(find ""$l_mount"" -xdev -type f \( -perm -2000 -o -perm -4000 \) 
-print0 2>/dev/null) 
   done < <(findmnt -Dkerno fstype,target,options | awk '($1 !~ 
/^\s*(nfs|proc|smb|vfat|iso9660|efivarfs|selinuxfs)/ && $2 !~ 
/^\/run\/user\// && $3 !~/noexec/ && $3 !~/nosuid/) {print $2}') 
   if ! (( ${#a_suid[@]} > 0 )); then 
      l_output=""$l_output\n - No executable SUID files exist on the system"" 
   else 
      l_output2=""$l_output2\n - List of \""$(printf '%s' ""${#a_suid[@]}"")\"" 
SUID executable files:\n$(printf '%s\n' ""${a_suid[@]}"")\n - end of list -\n"" 
   fi 
   if ! (( ${#a_sgid[@]} > 0 )); then 
      l_output=""$l_output\n - No SGID files exist on the system"" 
   else 
      l_output2=""$l_output2\n - List of \""$(printf '%s' ""${#a_sgid[@]}"")\"" 
SGID executable files:\n$(printf '%s\n' ""${a_sgid[@]}"")\n - end of list -\n"" 
   fi 
   [ -n ""$l_output2"" ] && l_output2=""$l_output2\n- Review the preceding 
list(s) of SUID and/or SGID files to\n- ensure that no rogue programs have 
been introduced onto the system.\n""  
   unset a_arr; unset a_suid; unset a_sgid # Remove arrays 
   # If l_output2 is empty, Nothing to report 
   if [ -z ""$l_output2"" ]; then 
      echo -e ""\n- Audit Result:\n$l_output\n"" 
   else 
      echo -e ""\n- Audit Result:\n$l_output2\n"" 
      [ -n ""$l_output"" ] && echo -e ""$l_output\n"" 
   fi 
} 
Note: on systems with a large number of files, this may be a long running process","Ensure that no rogue SUID or SGID programs have been introduced into the system. 
Review the files returned by the action in the Audit section and confirm the integrity of 
these binaries.",,
"7.2.1 Ensure accounts in /etc/passwd use shadowed passwords 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","Local accounts can uses shadowed passwords. With shadowed passwords, The 
passwords are saved in shadow password file, /etc/shadow, encrypted by a salted 
one-way hash. Accounts with a shadowed password have an x in the second field in 
/etc/passwd.","The /etc/passwd file also contains information like user ID's and group ID's that are 
used by many system programs. Therefore, the /etc/passwd file must remain world 
readable. In spite of encoding the password with a randomly-generated one-way hash 
function, an attacker could still break the system if they got access to the /etc/passwd 
file. This can be mitigated by using shadowed passwords, thus moving the passwords in 
the /etc/passwd file to /etc/shadow. The /etc/shadow file is set so only root will be 
able to read and write. This helps mitigate the risk of an attacker gaining access to the 
encoded passwords with which to perform a dictionary attack. 
Note: 
• 
All accounts must have passwords or be locked to prevent the account from 
being used by an unauthorized user. 
• 
A user account with an empty second field in /etc/passwd allows the account to 
be logged into by providing only the username.","Run the following command and verify that no output is returned: 
# awk -F: '($2 != ""x"" ) { print ""User: \"""" $1 ""\"" is not set to shadowed 
passwords ""}' /etc/passwd","Run the following command to set accounts to use shadowed passwords and migrate 
passwords in /etc/passwd to /etc/shadow: 
# pwconv 
Investigate to determine if the account is logged in and what it is being used for, to 
determine if it needs to be forced off.",,
"7.2.2 Ensure /etc/shadow password fields are not empty 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","An account with an empty password field means that anybody may log in as that user 
without providing a password.","All accounts must have passwords or be locked to prevent the account from being used 
by an unauthorized user.","Run the following command and verify that no output is returned: 
# awk -F: '($2 == """" ) { print $1 "" does not have a password ""}' /etc/shadow","If any accounts in the /etc/shadow file do not have a password, run the following 
command to lock the account until it can be determined why it does not have a 
password: 
# passwd -l <username> 
Also, check to see if the account is logged in and investigate what it is being used for to 
determine if it needs to be forced off. 
References: 
1. NIST SP 800-53 Rev. 5: IA-5",,
"7.2.3 Ensure all groups in /etc/passwd exist in /etc/group 
(Automated)"," Level 1 - Server 
 Level 1 - Workstation","Over time, system administration errors and changes can lead to groups being defined 
in /etc/passwd but not in /etc/group .","Groups defined in the /etc/passwd file but not in the /etc/group file pose a threat to 
system security since group permissions are not properly managed.","Run the following script to verify all GIDs in /etc/passwd exist in /etc/group: 
#!/usr/bin/env bash 
 
{ 
   a_passwd_group_gid=(""$(awk -F: '{print $4}' /etc/passwd | sort -u)"") 
   a_group_gid=(""$(awk -F: '{print $3}' /etc/group | sort -u)"") 
   a_passwd_group_diff=(""$(printf '%s\n' ""${a_group_gid[@]}"" 
""${a_passwd_group_gid[@]}"" | sort | uniq -u)"") 
   while IFS= read -r l_gid; do 
      awk -F: '($4 == '""$l_gid""') {print ""  - User: \"""" $1 ""\"" has GID: \"""" 
$4 ""\"" which does not exist in /etc/group"" }' /etc/passwd 
   done < <(printf '%s\n' ""${a_passwd_group_gid[@]}"" 
""${a_passwd_group_diff[@]}"" | sort | uniq -D | uniq) 
   unset a_passwd_group_gid; unset a_group_gid; unset a_passwd_group_diff 
} 
Nothing should be returned","Analyze the output of the Audit step above and perform the appropriate action to correct 
any discrepancies found. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
7.2.4 Ensure no duplicate UIDs exist (Automated)," Level 1 - Server 
 Level 1 - Workstation","Although the useradd program will not let you create a duplicate User ID (UID), it is 
possible for an administrator to manually edit the /etc/passwd file and change the UID 
field.","Users must be assigned unique UIDs for accountability and to ensure appropriate 
access protections.","Run the following script and verify no results are returned: 
#!/usr/bin/env bash 
 
{ 
  while read -r l_count l_uid; do 
    if [ ""$l_count"" -gt 1 ]; then 
      echo -e ""Duplicate UID: \""$l_uid\"" Users: \""$(awk -F: '($3 == n) { 
print $1 }' n=$l_uid /etc/passwd | xargs)\"""" 
    fi 
  done < <(cut -f3 -d"":"" /etc/passwd | sort -n | uniq -c) 
}","Based on the results of the audit script, establish unique UIDs and review all files owned 
by the shared UIDs to determine which UID they are supposed to belong to. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
MITRE ATT&CK Mappings: 
Techniques / Sub-
techniques 
Tactics 
Mitigations 
T1078, T1078.001, 
T1078.003 
TA0005 
M1027",,
7.2.5 Ensure no duplicate GIDs exist (Automated)," Level 1 - Server 
 Level 1 - Workstation","Although the groupadd program will not let you create a duplicate Group ID (GID), it is 
possible for an administrator to manually edit the /etc/group file and change the GID 
field.","User groups must be assigned unique GIDs for accountability and to ensure appropriate 
access protections.","Run the following script and verify no results are returned: 
#!/usr/bin/env bash 
 
{ 
   while read -r l_count l_gid; do 
      if [ ""$l_count"" -gt 1 ]; then 
      echo -e ""Duplicate GID: \""$l_gid\"" Groups: \""$(awk -F: '($3 == n) { 
print $1 }' n=$l_gid /etc/group | xargs)\"""" 
    fi 
  done < <(cut -f3 -d"":"" /etc/group | sort -n | uniq -c) 
}","Based on the results of the audit script, establish unique GIDs and review all files 
owned by the shared GID to determine which group they are supposed to belong to. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5 
Additional Information: 
You can also use the grpck command to check for other inconsistencies in the 
/etc/group file.",,
7.2.6 Ensure no duplicate user names exist (Automated)," Level 1 - Server 
 Level 1 - Workstation","Although the useradd program will not let you create a duplicate user name, it is 
possible for an administrator to manually edit the /etc/passwd file and change the user 
name.","If a user is assigned a duplicate user name, it will create and have access to files with 
the first UID for that username in /etc/passwd . For example, if ""test4"" has a UID of 
1000 and a subsequent ""test4"" entry has a UID of 2000, logging in as ""test4"" will use 
UID 1000. Effectively, the UID is shared, which is a security problem.","Run the following script and verify no results are returned: 
#!/usr/bin/env bash 
 
{ 
   while read -r l_count l_user; do 
      if [ ""$l_count"" -gt 1 ]; then 
         echo -e ""Duplicate User: \""$l_user\"" Users: \""$(awk -F: '($1 == n) { 
print $1 }' n=$l_user /etc/passwd | xargs)\"""" 
      fi 
   done < <(cut -f1 -d"":"" /etc/group | sort -n | uniq -c) 
}","Based on the results of the audit script, establish unique user names for the users. File 
ownerships will automatically reflect the change as long as the users have unique UIDs. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
7.2.7 Ensure no duplicate group names exist (Automated)," Level 1 - Server 
 Level 1 - Workstation","Although the groupadd program will not let you create a duplicate group name, it is 
possible for an administrator to manually edit the /etc/group file and change the group 
name.","If a group is assigned a duplicate group name, it will create and have access to files 
with the first GID for that group in /etc/group . Effectively, the GID is shared, which is 
a security problem.","Run the following script and verify no results are returned: 
#!/usr/bin/env bash 
 
{ 
   while read -r l_count l_group; do 
      if [ ""$l_count"" -gt 1 ]; then 
         echo -e ""Duplicate Group: \""$l_group\"" Groups: \""$(awk -F: '($1 == 
n) { print $1 }' n=$l_group /etc/group | xargs)\"""" 
      fi 
   done < <(cut -f1 -d"":"" /etc/group | sort -n | uniq -c) 
}","Based on the results of the audit script, establish unique names for the user groups. File 
group ownerships will automatically reflect the change as long as the groups have 
unique GIDs. 
References: 
1. NIST SP 800-53 Rev. 5: CM-1, CM-2, CM-6, CM-7, IA-5",,
,,,,,"If a local interactive users' home directory is undefined and/or doesn't exist, follow local 
site policy and perform one of the following: 
• 
Lock the user account 
• 
Remove the user from the system 
• 
create a directory for the user. If undefined, edit /etc/passwd and add the 
absolute path to the directory to the last field of the user. 
Run the following script to: 
• 
Remove excessive permissions from local interactive users home directories 
• 
Update the home directory's owner",,
,,,,,"Making global modifications to users' files without alerting the user community can result 
in unexpected outages and unhappy users. Therefore, it is recommended that a 
monitoring policy be established to report user dot file permissions and determine the 
action to be taken in accordance with site policy. 
The following script will: 
• 
remove excessive permissions on dot files within interactive users' home 
directories 
• 
change ownership of dot files within interactive users' home directories to the 
user 
• 
change group ownership of dot files within interactive users' home directories to 
the user's primary group 
• 
list .forward and .rhost files to be investigated and manually deleted",,
